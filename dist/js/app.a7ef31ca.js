(function(){var e={20986:function(e,t,a){"use strict";a.d(t,{A:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"Navbar"},[t("div",{staticClass:"navlink"},e._l(e.barList,(function(i){return t("div",{key:i.index,attrs:{data:e.barList}},["/"!=e.activeIndex?t("router-link",{attrs:{to:{path:i.url}}},[t("div",{class:e.activeIndex.indexOf(i.url)>=0&&"/"!=i.url?"active":"nomal",on:{click:function(t){return e.handleLink(i.url)}}},[e._v(" "+e._s(i.title)+" "),e.activeIndex.indexOf(i.url)>=0&&"/"!=i.url?t("img",{staticClass:"bottomline",attrs:{src:a(31248)}}):e._e()])]):t("router-link",{attrs:{to:{path:i.url,params:{id:i}}}},[t("div",{class:e.activeIndex.indexOf(i.url)>=0?"active":"nomal",on:{click:function(t){return e.handleLink(i.url,i.title)}}},[e._v(" "+e._s(i.title)+" "),e.activeIndex.indexOf(i.url)>=0?t("img",{staticClass:"bottomline",attrs:{src:a(31248)}}):e._e()])])],1)})),0)])])},s=[],o=(a(44114),{name:"Navbar",data(){return{barList:[{title:"首页",url:"/index"},{title:"基础信息",url:"/basicinfo"},{title:"感知数据",url:"/datashow"},{title:"视频监控",url:"/videomonit"}]}},methods:{handleLink(e,t){this.$route.path!==e&&this.$router.push({path:e,query:{title:t}})}},computed:{activeIndex(){return this.$route.path}},watch:{activeIndex(){}},mounted(){}}),l=o,r=a(81656),n=(0,r.A)(l,i,s,!1,null,null,null),c=n.exports},41325:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return C}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"introdunction"},[t("div",{staticClass:"base_list highlight",staticStyle:{padding:"10px"}},[t("el-radio-group",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-radio-button",{attrs:{label:"实时"}}),t("el-radio-button",{attrs:{label:"回放"}})],1),"实时"==e.activeName?t("div",[t("el-row",e._l(e.cameras,(function(e,a){return t("el-col",{key:a,staticStyle:{height:"300px",width:"500px"},attrs:{span:6}},[t("VideoBox",{ref:"'videoBox'",refInFor:!0,staticClass:"video-player",staticStyle:{height:"300px",width:"500px"},attrs:{muted:!0,mode:e.mode,newId:e.id,data:e}})],1)})),1)],1):e._e(),"回放"==e.activeName?t("div",[t("el-row",e._l(e.cameras,(function(e,a){return t("el-col",{key:a,staticStyle:{height:"300px",width:"500px"},attrs:{span:6}},[t("Backvideo",{ref:"video2",refInFor:!0,staticClass:"video-player",staticStyle:{height:"300px",width:"500px"},attrs:{muted:!0,newId:e.id,data:e}})],1)})),1)],1):e._e(),t("div",{staticStyle:{width:"50%","text-align":"center",position:"fixed",bottom:"0.1rem"}},[t("Navbar")],1)],1)])},s=[],o=(a(44114),function(){var e=this,t=e._self._c;return t("div",["hkvideo"==e.protocol?t("hkVideo",{ref:"video1",attrs:{data:e.hkData,newId:e.divId,visible:e.videoVisible,loading_time:e.loading_time}}):e._e()],1)}),l=[],r=a(98145),n={name:"VideoBox",props:{data:{type:Object||Array,require:!0},muted:{type:Boolean,require:!1},newId:{type:String,require:!0}},components:{hkVideo:r.A},data(){return{divId:"divABC",protocol:"hkvideo",hkData:{},rtspData:{},videoVisible:!0,loading_time:""}},watch:{data:{deep:!0,immediate:!0,handler(e,t){e&&(this.protocol=e.protocol,this.loading_time=e.loadingtime,e.hkData?this.hkData=e.hkData:this.hkData=void 0,e.rtspData?this.rtspData=e.rtspData:this.rtspData=void 0)}},newId:{deep:!0,immediate:!0,handler(e,t){this.divId="divABC"+e}}},mounted(){},created(){},destroyed(){this.closeVideo()},methods:{closeVideo(){var e=this;e.$nextTick((()=>{e.$refs&&(console.log("refs:",e.$refs),e.$refs.video1&&e.$refs.video1.closeVideo())}))},fitVideo(){var e=this;this.$nextTick((()=>{e.$refs&&(console.log("refs:",e.$refs),e.$refs.video1&&e.$refs.video1.fitVideo())}))},showVideo(e){var t=this;t.videoVisible=e},closedSound(){this.$nextTick((()=>{this.$refs.video1.volume=0,this.$refs.video2.volume=0}))}}},c=n,d=a(81656),h=(0,d.A)(c,o,l,!1,null,null,null),p=h.exports,g=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"mb8"},[t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"plugin",staticStyle:{width:"500px",height:"300px"},attrs:{id:e.myNewId}}),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clickStopPlayback}},[e._v("停止回放")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clickPause}},[e._v("暂停")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clickResume}},[e._v("继续")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clickPlayFast}},[e._v("加速")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clickPlaySlow}},[e._v("减速")]),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:e.clickFullScreen}},[e._v("全屏")]),t("el-row",{staticStyle:{"margin-top":"10px"}},[t("div",{staticStyle:{float:"left"}},[t("el-date-picker",{staticStyle:{"margin-left":"3px",width:"6rem"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","append-to-body":!1},on:{change:e.getTimeRange},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.clickRecordSearch()}}},[e._v("搜索")])],1),t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableloading,expression:"tableloading"}],staticStyle:{width:"100%",background:"transparent",minheight:"4rem"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.searchList,height:"4rem"},on:{"selection-change":e.handleSelectionChange}},[t("el-table-column",{key:"index",attrs:{label:"搜索序号",align:"left",prop:"index","show-overflow-tooltip":!0}}),t("el-table-column",{attrs:{label:"开始时间",align:"left","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.startTime)+" ")]}}])}),t("el-table-column",{attrs:{label:"结束时间",align:"left","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.endTime)+" ")]}}])}),t("el-table-column",{attrs:{label:"文件名",align:"left","show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.fileName)+" ")]}}])}),t("el-table-column",{attrs:{label:"播放",align:"center","class-name":"small-padding fixed-width"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view"},on:{click:function(t){return e.handlePlayBack(a.row)}}},[e._v("播放...")])]}}])})],1)],1)],1)])},u=[],m={name:"BackVideo",inheritAttrs:!1,props:{data:{type:Object||Array,require:!0},mode_info:{type:String,require:!0},newId:{type:String,require:!0,default:"divABC02"}},watch:{newId:{deep:!0,immediate:!0,handler(e,t){e&&(this.myNewId="divPlayBack"+e)}},data:{deep:!0,immediate:!0,handler(e,t){if(console.log("backvideo:oldVal",t),console.log("backvideo:newVal",e),e&&e.hkData){var a=e.hkData;if(this.ip=a.nvrAddress,this.myNewId="divPlayBack"+e.id,this.userName=a.userName,this.passWord=a.passWord,a.rtspPort?this.rtspPort=a.rtspPort:this.rtspPort=554,a.transStream?this.transStream=!0:this.transStream=!1,a.port?this.port=a.port:this.port=80,this.iChannelID=a.channelID?a.channelID:1,a.title?this.title=a.title:this.title="监控摄像头",a.streamType?this.streamType=a.streamType:this.streamType=1,this.ip){var i=this.loadingTime/1e3;setTimeout((()=>{this.initS()}),i)}}}}},data(){return{tableloading:!1,mode:this.mode_info,imgdialog:!1,myNewId:"divBackVideo",visible:!0,showSearch:!0,advanceMode:!0,queryParams:{},ip:void 0,transStream:!0,rtspPort:554,userName:"",passWord:"",port:80,iChannelID:1,windowCount:1,loadingTime:2e3,timeOut:2e3,videoWidth:500,videoHeight:300,fullSize:!1,title:"camera01",startTime:"",endTime:"",g_iWndIndex:0,timeRange:[],streamType:1,bZeroChannel:!1,streamTypeList:[{id:1,label:"主码流"},{id:2,label:"子码流"},{id:3,label:"第三码流"},{id:4,label:"转码码流"}],startTime:"",endTime:"",g_iSearchTimes:0,currentRow:{},searchList:[],currentRow:{},plugInInitialized:!1,loading:!0}},mounted(){console.log("插件下载地址：webSDKPlugin/HCWebSDKPlugin.exe"),this.timeRange=[this.getStartDate(),this.getEndDate()],this.getTimeRange(),this.ip&&this.initS()},methods:{closeModal(){this.imgdialog=!1,this.breakDom()},handleSelectionChange(e){this.currentRow=e,console.log("currentRow",this.currentRow)},handlePlayBack(e){this.imgdialog=!0,this.currentRow=e;const t=`${this.ip}_${this.port}`,a=e.playbackURI,i=e.startTime0,s=e.endTime0,o=this.g_iWndIndex||0,l=this.rtspPort,r=this.streamType||1,n=this.bZeroChannel;this.transStream;if(n)return console.warn("当前为零通道，无法播放回放！"),void this.$message.warning("零通道不支持回放！");const c=()=>{const e={iWndIndex:o,szUrl:a,szStartTime:i,szEndTime:s,iPort:l,iStreamType:r,success:()=>{console.log(`${t} 开始回放成功！`)},error:e=>{console.error(`${t} 开始回放失败！`,e.errorCode,e.errorMsg),this.$message.error(`回放失败：${e.errorMsg||"未知错误"}`)}};console.log("播放参数：",e),WebVideoCtrl.I_StartPlay(t,e)},d=WebVideoCtrl.I_GetWindowStatus(o);d?WebVideoCtrl.I_Stop({iWndIndex:o,success:()=>{console.log("停止当前播放，准备开始新回放..."),c()},error:e=>{console.error("停止播放失败：",e.errorCode,e.errorMsg),this.$message.error("停止当前播放失败，请重试！")}}):(console.log("窗口空闲，直接开始播放..."),c())},getTimeRange(){this.timeRange.length?(this.queryParams.startTime=this.timeRange[0],this.queryParams.endTime=this.timeRange[1]):(this.queryParams.startTime=this.getStartDate(),this.queryParams.endTime=this.getEndDate())},loadXML(e){if(null==e||""==e)return null;var t=null;if(window.DOMParser){var a=new DOMParser;t=a.parseFromString(e,"text/xml")}else t=new ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.loadXML(e);return t},toXMLStr(e){var t="";try{var a=new XMLSerializer;t=a.serializeToString(e)}catch(i){try{t=e.xml}catch(i){return""}}return-1==t.indexOf("<?xml")&&(t="<?xml version='1.0' encoding='utf-8'?>"+t),t},encodeString(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):""},handleXXX(){var e=this.ip;this.$emit("desPlug",e)},async initS(){let e=this;console.log("回放组件！",this),this.loading=!0,this.plugInInitialized||(console.log("初始化"),await WebVideoCtrl.I_InitPlugin({bWndFull:!0,iWndowType:1,cbSelWnd:function(e){this.g_iWndIndex=parseInt($(e).find("SelectWnd").eq(0).text(),10);var t="当前选择的窗口编号："+this.g_iWndIndex;console.log(t)},cbDoubleClickWnd:function(e,t){this.iWndIndex=e;var a="当前放大的窗口编号："+e;t||(a="当前还原的窗口编号："+e),console.log(a)},cbEvent:function(e,t,a){console.log("收到事件消息, eventType="+e+",param1="+t+",p2="+a),2==e?console.log("窗口"+t+"回放结束！"):-1==e?console.log("设备"+t+"网络错误！"):3001==e&&this.clickStopRealPlay()},cbInitPluginComplete:function(){e.plugInInitialized=!0,console.log("pluginitialized:",e.plugInInitialized),WebVideoCtrl.I_InsertOBJECTPlugin(e.myNewId).then((()=>{console.log("init ok."),WebVideoCtrl.I_CheckPluginVersion().then((t=>{if(t){let t="检测到新的插件版本，双击开发包目录里的HCWebSDKPlugin.exe升级！";e.$message.error(t),console.log(t)}}))}),(t=>{console.log("err",t);let a="插件初始化失败，请确认是否已安装插件；如果未安装，请双击开发包目录里的HCWebSDKPlugin.exe安装！";e.$message.error(a),console.log(a)})),this.loading=!1}})),setTimeout((()=>{this.setVideoWindowResize(this.myNewId,"500","300"),this.clickLogin()}),500)},setVideoWindowResize(e,t,a){if(e){var i=document.getElementById(e);i&&(i.style.width=t+"px",i.style.height=a+"px")}},clickLogin(){let e=this;e.g_iSearchTimes=0,e.searchList=[];let t=!1;var a=this.ip+"_"+this.port;const i=WebVideoCtrl.I_Login(this.ip,this.windowCount,this.port,this.userName,this.passWord,{timeout:this.timeOut,success:function(t){console.log(a+" 已登录！"),setTimeout((function(){setTimeout((function(){}),1e3),e.getDevicePort()}),10)},error:function(i){console.log("登录-err===>",i),2001==i.errorCode?(t=!0,console.log(a+" 已登录过！"),console.log("do start realplay..."),e.getDevicePort()):e.$message.error("设备登录失败，请检查登陆密码/访问地址的配置是否正确！")}});-1===i&&console.log(a+" 已登录过！")},getDevicePort(){null!=this.ip&&WebVideoCtrl.I_GetDevicePort(this.ip).then((e=>{console.log("152获取端口",e),this.getChannelInfo()}))},async getChannelInfo(){let e=this;var t=this.ip+"_"+this.port;null!=t&&(console.log("szDeviceIdentify==============>",t),WebVideoCtrl.I_GetAnalogChannelInfo(t,{success:function(t){e.autoStartPlayback(),console.log(t)},error:function(e){console.log(t+"模拟通道",e.errorCode,e.errorMsg)}}),WebVideoCtrl.I_GetDigitalChannelInfo(t,{success:function(t){console.log(t),e.autoStartPlayback()},error:function(e){console.log(t+" 数字通道",e.errorCode,e.errorMsg)}}))},clickStartRealPlay(e){let t=this;var a=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex)||null;if(this.ip&&this.port){var i=this.ip+"_"+this.port;if(this.streamType="undefined"===e?1:e,null!=i){var s=function(){WebVideoCtrl.I_StartRealPlay(i,{iStreamType:t.streamType,iChannelID:t.iChannelID,bZeroChannel:t.bZeroChannel,success:function(){WebVideoCtrl.I_Logout(i),console.log("开始预览成功！")},error:function(e){t.$message.error(i+"开始预览失败！"),console.log(i+"开始预览失败！"),console.log("oError",e)}})};null!=a?WebVideoCtrl.I_Stop({success:function(){s()}}):s()}}},clickStopRealPlay(){WebVideoCtrl.I_Stop({success:function(){console.log("停止预览成功！")},error:function(e){console.log(" 停止预览失败！")}})},async clickCapturePic(e){var t=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),a="";if(null!=t){var i=await WebVideoCtrl.I_GetLocalCfg(),s="0";i&&(s=i.captureFileFormat);var o=e,l=t.szDeviceIdentify+"_"+o+"_"+(new Date).getTime();"playback"===mode&&(l="playback_"+t.szDeviceIdentify+"_"+o+"_"+(new Date).getTime()),l+="0"===s?".jpg":".bmp",WebVideoCtrl.I_CapturePic(l,{bDateDir:!0}).then((function(){a="抓图成功！",console.log(t.szDeviceIdentify+" "+a)}),(function(e){a=" 抓图失败！",console.log(t.szDeviceIdentify+a,e.errorCode,e.errorMsg)}))}},clickCapturePicData(){var e=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),t="";null!=e&&WebVideoCtrl.I_CapturePicData().then((function(a){console.log(a),t="抓图上传成功！",console.log(e.szDeviceIdentify+" "+t)})).catch((()=>{t="抓图失败！",console.log(e.szDeviceIdentify+" "+t)}))},clickRecordSearch(e){this.queryParams.startTime?this.startTime=this.queryParams.startTime:this.startTime=this.getStartDate(),this.queryParams.endTime?this.endTime=this.queryParams.endTime:this.endTime=this.getEndDate();var t=this;console.log("starttime",this.startTime),console.log("endTime",this.endTime);var a=this.ip+"_"+this.port,i=this.iChannelID,s=this.streamType?this.streamType:1,o=this.startTime,l=this.endTime;Date.parse(l.replace(/-/g,"/"))-Date.parse(o.replace(/-/g,"/"))<0||null!=a&&(this.bZeroChannel||(e||(t.g_iSearchTimes=0,t.searchList=[],t.currentRow={}),console.log("g_iSearchTimes",t.g_iSearchTimes),console.log("recordcount",t.searchList.length),t.loading=!0,t.tableloading=!0,WebVideoCtrl.I_RecordSearch(a,i,o,l,{iStreamType:s,iSearchPos:t.g_iSearchTimes,success:function(e){if(console.log("xmlDoc",e),console.log("responseStatusStrg",$(e).find("responseStatusStrg")),"MORE"===$(e).find("responseStatusStrg").eq(0).text()){for(var i=0,s=$(e).find("searchMatchItem").length;i<s;i++){var o=$(e).find("playbackURI").eq(i).text(),l=$(e).find("startTime").eq(i).text(),r=$(e).find("endTime").eq(i).text(),n=o.substring(o.indexOf("name=")+5,o.indexOf("&size=")),c={index:t.g_iSearchTimes+1,startTime0:l,endTime0:r,startTime:l.replace("T"," ").replace("Z",""),endTime:r.replace("T"," ").replace("Z",""),fileName:n,playbackURI:o};t.searchList.push(c),t.g_iSearchTimes++}t.clickRecordSearch(1)}else if("OK"===$(e).find("responseStatusStrg").eq(0).text()){var d=$(e).find("searchMatchItem").length;console.log("iLength",d);for(i=0;i<d;i++){o=$(e).find("playbackURI").eq(i).text(),l=$(e).find("startTime").eq(i).text(),r=$(e).find("endTime").eq(i).text(),n=o.substring(o.indexOf("name=")+5,o.indexOf("&size=")),c={index:t.g_iSearchTimes+1,startTime:l.replace("T"," ").replace("Z",""),endTime:r.replace("T"," ").replace("Z",""),startTime0:l,endTime0:r,fileName:n,playbackURI:o};t.searchList.push(c),t.g_iSearchTimes++}console.log(a+" 搜索录像文件成功！")}else"NO MATCHES"===$(e).find("responseStatusStrg").eq(0).text()&&setTimeout((function(){console.log(a+" 没有录像文件！")}),50);t.tableloading=!1},error:function(e){console.log(a+" 搜索录像文件失败！",e.errorCode,e.errorMsg),t.tableloading=!1}})))},getDateString(e){const t=new Date(e),a=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),s=("0"+t.getDate()).slice(-2);return`${a}-${i}-${s} 00:00:00`},getStartDate(){const e=new Date,t=new Date(e),a=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),s=("0"+t.getDate()).slice(-2);return`${a}-${i}-${s} 00:00:00`},getStartDateZ(){const e=new Date,t=new Date(e),a=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),s=("0"+t.getDate()).slice(-2);return`${a}${i}${s}T000000Z`},getEndDate(){const e=new Date,t=new Date(e),a=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),s=("0"+t.getDate()).slice(-2);return`${a}-${i}-${s} 23:59:59`},getEndDateZ(){const e=new Date,t=new Date(e),a=t.getFullYear(),i=("0"+(t.getMonth()+1)).slice(-2),s=("0"+t.getDate()).slice(-2);return`${a}${i}${s}T235959Z`},autoStartPlayback(){var e=0;this.g_iWndIndex&&(e=this.g_iWndIndex);var t,a,i=WebVideoCtrl.I_GetWindowStatus(e),s=this.ip+"_"+this.port,o=(this.rtspPort,this.streamType?this.streamType:1),l=this.bZeroChannel,r="";this.transStream;if(null!=s)if(l)console.warn("zero channel, can not play back.");else{t=this.getStartDate(),a=this.getEndDate();var n=this,c=function(){if(n.transStream){var i={TransFrameRate:"14",TransResolution:"1",TransBitrate:"19"},l={iWndIndex:e,iStreamType:o,iChannelID:n.iChannelID,szStartTime:t,szEndTime:a,oTransCodeParam:i,success:function(){r="开始回放成功！",console.log(s+" "+r)},error:function(e){r="开始回放失败！",console.log(s+r,e.errorCode,e.errorMsg)}};console.log("playback options:",l),WebVideoCtrl.I_StartPlayback(s,l)}else{l={iWndIndex:e,iStreamType:o,iChannelID:n.iChannelID,szStartTime:t,szEndTime:a,success:function(){r="开始回放成功！",console.log(s+" "+r)},error:function(e){r="开始回放失败！",console.log(s+r,e.errorCode,e.errorMsg)}};console.log("playback options:",l),WebVideoCtrl.I_StartPlayback(s,l)}};null!=i?WebVideoCtrl.I_Stop({success:function(){console.log("start play back..."),c()}}):(console.log("start play back..."),c())}},clickStartPlayback(e){var t=0;this.g_iWndIndex&&(t=this.g_iWndIndex);var a,i,s=WebVideoCtrl.I_GetWindowStatus(t),o=this.ip+"_"+this.port,l=(this.rtspPort,this.streamType?this.streamType:1),r=this.bZeroChannel,n="";this.transStream;if(null!=o)if(r)console.warn("zero channel, can not play back.");else{a=e.startTime,i=e.endTime;var c=this,d=function(){if(c.transStream){var e={TransFrameRate:"14",TransResolution:"1",TransBitrate:"19"},s={iWndIndex:t,iStreamType:l,iChannelID:c.iChannelID,szStartTime:a,szEndTime:i,iStreamType:l,oTransCodeParam:e,success:function(){n="开始回放成功！",console.log(o+" "+n)},error:function(e){n="开始回放失败！",console.log(o+n,e.errorCode,e.errorMsg)}};console.log("playback options:",s),WebVideoCtrl.I_StartPlayback(o,s)}else{s={iWndIndex:t,iStreamType:l,iChannelID:c.iChannelID,szStartTime:a,szEndTime:i,success:function(){n="开始回放成功！",console.log(o+" "+n)},error:function(e){n="开始回放失败！",console.log(o+n,e.errorCode,e.errorMsg)}};console.log("playback options:",s),WebVideoCtrl.I_StartPlayback(o,s)}};null!=s?WebVideoCtrl.I_Stop({success:function(){consoleg("start play back..."),d()}}):(console.log("start play back..."),d())}},clickStopPlayback(){var e=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),t="",a=this;null!=e&&WebVideoCtrl.I_Stop({success:function(){t="停止回放成功！",console.log(e.szDeviceIdentify+" "+t)},error:function(e){t="停止回放失败！",console.log(szDeviceIdentify+t,e.errorCode,e.errorMsg),3001==e.errorCode&&a.clickStopRealPlay()}})},clickReversePlayback(){var e=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),t=this.ip+"_"+this.port,a=this.rtspPort,i=currentRow.startTime,s=currentRow.endTime,o="";if(null!=t&&!this.bZeroChannel){var l=this,r=function(){WebVideoCtrl.I_ReversePlayback(t,{iPort:a,iStreamType:l.streamType,iChannelID:l.iChannelID,szStartTime:i,szEndTime:s}).then((()=>{o="开始倒放成功！",console.log(t+" "+o)}),(e=>{o="开始倒放失败！",console.log(e),console.log(t+o,e.errorCode,e.errorMsg)}))};null!=e?WebVideoCtrl.I_Stop({success:function(){r()}}):r()}},clickFullScreen(){WebVideoCtrl.I_FullScreen(!0).then((()=>{console.log("全屏成功")}),(e=>{console.log("全屏失败！",e.errorCode,e.errorMsg)}))},clickFrame(){var e=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),t="";null!=e&&WebVideoCtrl.I_Frame({success:function(){t="单帧播放成功！",console.log(e.szDeviceIdentify+" "+t)},error:function(e){t="单帧播放失败！",console.log(szDeviceIdentify+t,e.errorCode,e.errorMsg)}})},clickPause(){var e=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),t="";null!=e&&WebVideoCtrl.I_Pause({success:function(){t="暂停成功！",console.log(e.szDeviceIdentify+" "+t)},error:function(a){t="暂停失败！",console.log(e.szDeviceIdentify+t,a.errorCode,a.errorMsg)}})},clickResume(){var e=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),t="";null!=e&&WebVideoCtrl.I_Resume({success:function(){t="恢复成功！",console.log(e.szDeviceIdentify+" "+t)},error:function(a){t="恢复失败！",console.log(e.szDeviceIdentify+t,a.errorCode,a.errorMsg)}})},clickPlaySlow(){var e=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),t="";null!=e&&WebVideoCtrl.I_PlaySlow({success:function(){t="慢放成功！",console.log(e.szDeviceIdentify+" "+t)},error:function(a){t="慢放失败！",console.log(e.szDeviceIdentify+t,a.errorCode,a.errorMsg)}})},clickPlayFast(){var e=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),t="";null!=e&&WebVideoCtrl.I_PlayFast({success:function(){t="快放成功！",console.log(e.szDeviceIdentify+" "+t)},error:function(a){t="快放失败！",console.log(e.szDeviceIdentify+t,a.errorCode,a.errorMsg)}})},closeVideo(){if(console.log("plugInInitialized",this.plugInInitialized),this.plugInInitialized){try{WebVideoCtrl.I_StopAllPlay();var e=this.ip+"_"+this.port;WebVideoCtrl.I_Logout(e),WebVideoCtrl.I_DestroyPlugin(e)}catch(t){console.log(t)}this.plugInInitialized=!1}},showVideo(e){this.visible=e},loginOut(){WebVideoCtrl.I_Logout(this.ip+"_"+this.port)},stopAllPlay(){WebVideoCtrl.I_StopAllPlay()},breakDom(){WebVideoCtrl.I_DestroyPlugin(),this.plugInInitialized=!1},viewReload(){window.location.reload()}},showVideo(e){},beforeDestroy(){console.log("回放before destroy..."),this.closeVideo(),setTimeout((()=>{}),100)},destroyed(){}},f=m,w=(0,d.A)(f,g,u,!1,null,null,null),b=w.exports,v=a(34829),y=(a(95152),a(20986)),_=a(25882);let S=[];for(let $=0;$<20;$++)S.push({title:"转化1-工作服检测转化预警"+$,date:"2024-09-30 13:54"});var D={components:{VideoBox:p,Backvideo:b,Navbar:y.A},data(){return{activeName:"实时",array:S,videoSite:1,cameras:[{id:"01",ip:"200.150.100.252",userName:"admin",passWord:"ZG20241019",rtspPort:554,transStream:!1,port:80,channelID:1,loadingTime:"3000",streamType:1,analogMode:!1,videoHeight:100,title:"camera 01",mode:"preview",videoWidth:500,videoHeight:300}]}},methods:{updateVideoDvices(e){var t=e;this.cameras=[];for(var a=0;a<t.length;a++){var i=t[a].name,s=t[a].parameterString,o=t[a].protocol;this.cameras=[];var l={id:t[a].id+"",siteId:t[a].siteId};this.cameras.push(l);try{var r=JSON.parse(s);if(console.log("parameter",r),r)if(l.protocol=o,"hkvideo"==o){var n=(0,_.I)(r);l.hkData=n}else if("rtsp"==o){var c=(0,_.O)(r);l.rtspData=c}console.log("read camera:",l)}catch(d){console.warn("parse video device "+i+" 参数字符串出错:"+d.message)}}}},mounted(){if(console.log(this.$route.fullPath.split("/")),this.$route.fullPath.split("/").length){let e=this.$route.fullPath.split("/")[this.$route.fullPath.split("/").length-1];(0,v.AX)({pageNum1:1,pageSize:1e4,siteId:e}).then((e=>{console.log("res.rows",e.rows),200!=e.code?(this.$message({type:"warning",message:"认证失败,重新登录",showClose:!0}),setTimeout((()=>{this.$router.push("/")}),2e3)):this.updateVideoDvices(e.rows)}))}},watch:{activeIndex(e,t){if(e.split("/").length){let t=e.split("/")[e.split("/").length-1];(0,v.AX)({pageNum1:1,pageSize:1e4,siteId:t}).then((e=>{console.log(e.rows),200!=e.code?(this.$message({type:"warning",message:"认证失败,重新登录",showClose:!0}),setTimeout((()=>{this.$router.push("/")}),2e3)):this.updateVideoDvices(e.rows)}))}}},computed:{activeIndex(){return this.$route.path}}},R=D,k=(0,d.A)(R,i,s,!1,null,null,null),C=k.exports},98145:function(e,t,a){"use strict";a.d(t,{A:function(){return c}});var i=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{width:"100%",height:"100%"}},[e.loading?t("div",{staticClass:"loadgif",staticStyle:{top:"-10%"}},[t("img",{attrs:{src:a(18788),id:"show_loading"}}),t("span",{staticStyle:{color:"white"}},[e._v("摄像头数据获取中")])]):e._e(),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"plugin",staticStyle:{height:"100%",width:"100%"},attrs:{id:e.myNewId}}),t("el-form",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],ref:"queryForm",attrs:{model:e.queryParams,size:"small",inline:!0,"label-width":"68px"}},[t("div",{staticClass:"mb8"},[t("el-row",[t("el-col",[t("el-form-item",[t("el-button",{attrs:{icon:"el-icon-view",size:"mini",type:"primary"},on:{click:function(t){return e.clickStartRealPlay(void 0,e.hasLogin)}}},[e._v("播放")]),t("el-button",{attrs:{icon:"el-icon-view",size:"mini",type:"info"},on:{click:e.clickFullScreen}},[e._v("全屏")])],1)],1)],1)],1)])],1)},s=[],o={name:"hkVideo",inheritAttrs:!1,props:{data:{type:Object||Array,require:!0},mode_info:{type:String,require:!0},newId:{type:String,require:!0,default:"div123"},loading_time:{type:Number,require:!0,default:2e3}},computed:{activeIndex(){return this.$route.path}},watch:{newId:{deep:!0,immediate:!0,handler(e,t){e&&(this.myNewId=e)}},loading_time:{deep:!0,immediate:!0,handler(e,t){e&&(this.loadingtime=e)}},data:{deep:!0,immediate:!0,handler(e,t){if(e){switch(console.log("assign value",e),this.ip=e.nvrAddress,"/videomonit/bottle/1"==this.activeIndex&&(this.ip="200.150.100.252"),this.userName=e.userName,this.passWord=e.passWord,!0){case this.ip.indexOf("200.150.100.252")>=0:this.passWord="ZG20241019";break}console.log(this.ip),console.log("aaaaa",this.passWord),e.rtspPort?this.rtspPort=e.rtspPort:this.rtspPort=554,e.transStream?this.transStream=!0:this.transStream=!1,e.analogMode?this.analogMode=!0:this.analogMode=!1,console.log("analogMode",this.analogMode),e.port?this.port=e.port:this.port=80,this.iChannelID=e.channelID?e.channelID:1,e.title?this.title=e.title:this.title="监控摄像头",e.streamType?this.streamType=e.streamType:this.streamType=1,e.videoWidth&&(this.videoWidth=e.videoWidth),e.videoHeight&&(this.videoHeight=e.videoHeight),this.ip&&this.port&&(this.plugInInitialized?this.clickLogin():setTimeout((()=>{this.initS(),console.log("摄像头加载延迟时间",this.loading_time)}),this.loading_time))}}}},data(){return{mode:this.mode_info,imgdialog:!1,myNewId:"divccf",visible:!0,showSearch:!0,advanceMode:!0,queryParams:{},ip:"",transStream:!0,rtspPort:554,userName:"",passWord:"",port:80,iChannelID:1,windowCount:1,loadingTime:2e3,timeOut:2e3,videoWidth:600,videoHeight:400,fullSize:!1,title:"",rtsp:"",startTime:"",endTime:"",g_iWndIndex:0,timeRange:[],streamType:1,bZeroChannel:!1,analogMode:!1,streamTypeList:[{id:1,label:"主码流"},{id:2,label:"子码流"},{id:3,label:"第三码流"},{id:4,label:"转码码流"}],startTime:"",endTime:"",plugInInitialized:!1,loading:!0,hasLogin:!1}},mounted(){console.log("插件下载地址：webSDKPlugin/HCWebSDKPlugin.exe")},methods:{initS(){let e=this;e.newId?e.ip&&e.port?this.plugInInitialized||(console.log("plugin initialized."),WebVideoCtrl.I_InitPlugin({bWndFull:!0,iWndowType:1,cbSelWnd:function(e){this.g_iWndIndex=parseInt($(e).find("SelectWnd").eq(0).text(),10);var t="当前选择的窗口编号："+this.g_iWndIndex;console.log(t)},cbDoubleClickWnd:function(e,t){this.iWndIndex=e;var a="当前放大的窗口编号："+e;t||(a="当前还原的窗口编号："+e),console.log(a)},cbEvent:function(e,t,a){console.log("收到事件消息, eventType="+e+",param1="+t+",p2="+a),2==e?console.log("窗口"+t+"回放结束！"):-1==e?console.log("设备"+t+"网络错误！"):3001==e&&this.clickStopRealPlay()},cbInitPluginComplete:function(){e.plugInInitialized=!0,WebVideoCtrl.I_InsertOBJECTPlugin(e.newId).then((()=>{console.log("init ok."),e.clickLogin(),e.setVideoWindowResize(this.newId,"700","500"),WebVideoCtrl.I_CheckPluginVersion().then((e=>{}))}),(()=>{let t="插件初始化失败，请确认是否已安装插件；如果未安装，请双击开发包目录里的HCWebSDKPlugin.exe安装！";e.$message.error(t),console.log(t),this.loading=!1}))}})):console.warn("hk video ip/port empty, can not init plugin."):console.warn("hk video id empty, can not create hk video plugin.")},clickFullScreen(){WebVideoCtrl.I_FullScreen(!0).then((()=>{console.log("全屏成功")}),(e=>{console.log("全屏失败！",e.errorCode,e.errorMsg)}))},setVideoWindowResize(e,t,a){if(e){var i=document.getElementById(e);i&&(i.style.width=t+"px",i.style.height=a+"px")}},clickLogin(){let e=this;e.hasLogin=!1,this.loading=!0;var t=this.ip+"_"+this.port;WebVideoCtrl.I_Login(this.ip,1,this.port,this.userName,this.passWord,{timeout:this.timeOut,success:function(a){e.hasLogin=!0,console.log(t+" 已登录！"),console.log(" this.hasLogin",e.hasLogin),console.log("do start realplay..."),e.getDevicePort(e.hasLogin)},error:function(a){console.log("登录-err===>",a),2001==a.errorCode?(e.hasLogin=!0,console.log(t+" 已登录过！"),console.log("do start realplay..."),e.getDevicePort(e.hasLogin)):e.$message.error("设备登录失败，请检查登陆密码/访问地址的配置是否正确！"),e.loading=!1}})},getDevicePort(e){null!=this.ip&&WebVideoCtrl.I_GetDevicePort(this.ip).then((t=>{console.log("152获取端口",t),this.getChannelInfo(e)}))},getChannelInfo(e){let t=this;var a=this.ip+"_"+this.port;null!=a&&(console.log("获取通道",a),WebVideoCtrl.I_GetAnalogChannelInfo(a,{success:function(a){setTimeout((()=>{t.clickStartRealPlay(void 0,e),console.log("走模拟通道")}),t.loadingTime)},error:function(e){console.log("模拟通道"),console.log(a+"模拟通道",e.errorCode,e.errorMsg)}}),WebVideoCtrl.I_GetDigitalChannelInfo(a,{success:function(a){$(a).find("InputProxyChannelStatus");console.log("走数字通道"),setTimeout((()=>{t.analogMode||t.clickStartRealPlay(void 0,e)}),t.loadingTime)},error:function(e){console.log(a+" 数字通道",e.errorCode,e.errorMsg)}}))},clickStartRealPlay(e,t){if(console.log("是否登陆",t),this.plugInInitialized&&t){let t=this;t.loading=!0;var a=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex)||null;if(!this.ip||!this.port)return;var i=this.ip+"_"+this.port;if(this.streamType="undefined"===e?1:e,null==i)return;var s={iStreamType:t.streamType,iChannelID:t.iChannelID,bZeroChannel:t.bZeroChannel,success:function(){console.log("开始预览成功！"),t.loading=!1},error:function(e){t.$message.error(i+"开始预览失败！请点击播放按钮重试！"),console.log(i+"开始预览失败！"),console.log("oError",e),t.loading=!1}};console.log("start real play with option:",s),s.iStreamType=1;var o=function(){WebVideoCtrl.I_StartRealPlay(i,s)};null!=a?WebVideoCtrl.I_Stop({success:function(){o()}}):o()}else t||this.$message.error("设备登录失败，请刷新页面重新登录！");this.plugInInitialized||this.$message.error("插件初始化失败，请确认是否已安装插件；如果未安装，请双击开发包目录里的HCWebSDKPlugin.exe安装！")},clickStopRealPlay(){WebVideoCtrl.I_Stop({success:function(){console.log("停止预览成功！")},error:function(e){console.log(" 停止预览失败！")}})},closeVideo(){if(console.log("plugInInitialized",this.plugInInitialized),this.plugInInitialized){try{WebVideoCtrl.I_StopAllPlay();var e=this.ip+"_"+this.port;WebVideoCtrl.I_Logout(e),WebVideoCtrl.I_DestroyPlugin(e)}catch(t){console.log(t.$message)}this.plugInInitialized=!1,window.location.reload()}},loginOut(){WebVideoCtrl.I_Logout(this.ip+"_"+this.port).then((()=>{console.log("退出成功"),WebVideoCtrl.I_DestroyPlugin()}),(()=>{console.log("退出失败！")}))},stopAllPlay(){WebVideoCtrl.I_StopAllPlay()},breakDom(){WebVideoCtrl.I_DestroyPlugin()},viewReload(){window.location.reload()}},beforeDestroy(){this.loginOut(),this.stopAllPlay(),window.removeEventListener(this.viewReload)},destroyed(){}},l=o,r=a(81656),n=(0,r.A)(l,i,s,!1,null,null,null),c=n.exports},27496:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return d}});var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("router-view"),t("div",{staticStyle:{width:"50%","text-align":"center",position:"absolute",bottom:"0.1rem"}})],1)},s=[],o=(a(34829),a(95152),a(20986)),l={components:{Navbar:o.A},data(){return{}},mounted(){}},r=l,n=a(81656),c=(0,n.A)(r,i,s,!1,null,null,null),d=c.exports},35358:function(e,t,a){var i={"./af":22190,"./af.js":22190,"./ar":7218,"./ar-dz":85785,"./ar-dz.js":85785,"./ar-kw":29417,"./ar-kw.js":29417,"./ar-ly":56904,"./ar-ly.js":56904,"./ar-ma":98617,"./ar-ma.js":98617,"./ar-ps":91318,"./ar-ps.js":91318,"./ar-sa":82699,"./ar-sa.js":82699,"./ar-tn":36789,"./ar-tn.js":36789,"./ar.js":7218,"./az":23050,"./az.js":23050,"./be":8316,"./be.js":8316,"./bg":70310,"./bg.js":70310,"./bm":58884,"./bm.js":58884,"./bn":83469,"./bn-bd":46672,"./bn-bd.js":46672,"./bn.js":83469,"./bo":39118,"./bo.js":39118,"./br":13113,"./br.js":13113,"./bs":23626,"./bs.js":23626,"./ca":40921,"./ca.js":40921,"./cs":17799,"./cs.js":17799,"./cv":12828,"./cv.js":12828,"./cy":93521,"./cy.js":93521,"./da":56962,"./da.js":56962,"./de":93294,"./de-at":16158,"./de-at.js":16158,"./de-ch":95960,"./de-ch.js":95960,"./de.js":93294,"./dv":47963,"./dv.js":47963,"./el":3432,"./el.js":3432,"./en-au":20998,"./en-au.js":20998,"./en-ca":15931,"./en-ca.js":15931,"./en-gb":45930,"./en-gb.js":45930,"./en-ie":58081,"./en-ie.js":58081,"./en-il":71594,"./en-il.js":71594,"./en-in":23904,"./en-in.js":23904,"./en-nz":1507,"./en-nz.js":1507,"./en-sg":19409,"./en-sg.js":19409,"./eo":22177,"./eo.js":22177,"./es":84805,"./es-do":39155,"./es-do.js":39155,"./es-mx":69791,"./es-mx.js":69791,"./es-us":76098,"./es-us.js":76098,"./es.js":84805,"./et":96240,"./et.js":96240,"./eu":20391,"./eu.js":20391,"./fa":20612,"./fa.js":20612,"./fi":4220,"./fi.js":4220,"./fil":65570,"./fil.js":65570,"./fo":5466,"./fo.js":5466,"./fr":14461,"./fr-ca":66306,"./fr-ca.js":66306,"./fr-ch":27081,"./fr-ch.js":27081,"./fr.js":14461,"./fy":73484,"./fy.js":73484,"./ga":76957,"./ga.js":76957,"./gd":72978,"./gd.js":72978,"./gl":89866,"./gl.js":89866,"./gom-deva":65011,"./gom-deva.js":65011,"./gom-latn":84724,"./gom-latn.js":84724,"./gu":71601,"./gu.js":71601,"./he":79802,"./he.js":79802,"./hi":9358,"./hi.js":9358,"./hr":13907,"./hr.js":13907,"./hu":10218,"./hu.js":10218,"./hy-am":20533,"./hy-am.js":20533,"./id":52844,"./id.js":52844,"./is":97353,"./is.js":97353,"./it":6364,"./it-ch":20774,"./it-ch.js":20774,"./it.js":6364,"./ja":6008,"./ja.js":6008,"./jv":68221,"./jv.js":68221,"./ka":92417,"./ka.js":92417,"./kk":42071,"./kk.js":42071,"./km":76149,"./km.js":76149,"./kn":94572,"./kn.js":94572,"./ko":60659,"./ko.js":60659,"./ku":66285,"./ku-kmr":59398,"./ku-kmr.js":59398,"./ku.js":66285,"./ky":81609,"./ky.js":81609,"./lb":119,"./lb.js":119,"./lo":81748,"./lo.js":81748,"./lt":71973,"./lt.js":71973,"./lv":81347,"./lv.js":81347,"./me":53023,"./me.js":53023,"./mi":65747,"./mi.js":65747,"./mk":64341,"./mk.js":64341,"./ml":63840,"./ml.js":63840,"./mn":62058,"./mn.js":62058,"./mr":19182,"./mr.js":19182,"./ms":45197,"./ms-my":89136,"./ms-my.js":89136,"./ms.js":45197,"./mt":36408,"./mt.js":36408,"./my":51683,"./my.js":51683,"./nb":53141,"./nb.js":53141,"./ne":29344,"./ne.js":29344,"./nl":44703,"./nl-be":84641,"./nl-be.js":84641,"./nl.js":44703,"./nn":79873,"./nn.js":79873,"./oc-lnc":61217,"./oc-lnc.js":61217,"./pa-in":24612,"./pa-in.js":24612,"./pl":24457,"./pl.js":24457,"./pt":1089,"./pt-br":79146,"./pt-br.js":79146,"./pt.js":1089,"./ro":45950,"./ro.js":45950,"./ru":27292,"./ru.js":27292,"./sd":56774,"./sd.js":56774,"./se":87493,"./se.js":87493,"./si":3761,"./si.js":3761,"./sk":49711,"./sk.js":49711,"./sl":88558,"./sl.js":88558,"./sq":8633,"./sq.js":8633,"./sr":90688,"./sr-cyrl":47903,"./sr-cyrl.js":47903,"./sr.js":90688,"./ss":31991,"./ss.js":31991,"./sv":27020,"./sv.js":27020,"./sw":15891,"./sw.js":15891,"./ta":45714,"./ta.js":45714,"./te":30206,"./te.js":30206,"./tet":24768,"./tet.js":24768,"./tg":28276,"./tg.js":28276,"./th":57977,"./th.js":57977,"./tk":56928,"./tk.js":56928,"./tl-ph":8046,"./tl-ph.js":8046,"./tlh":41361,"./tlh.js":41361,"./tr":64367,"./tr.js":64367,"./tzl":10627,"./tzl.js":10627,"./tzm":12636,"./tzm-latn":98148,"./tzm-latn.js":98148,"./tzm.js":12636,"./ug-cn":68823,"./ug-cn.js":68823,"./uk":40461,"./uk.js":40461,"./ur":41366,"./ur.js":41366,"./uz":83454,"./uz-latn":18374,"./uz-latn.js":18374,"./uz.js":83454,"./vi":78572,"./vi.js":78572,"./x-pseudo":80464,"./x-pseudo.js":80464,"./yo":93709,"./yo.js":93709,"./zh-cn":65873,"./zh-cn.js":65873,"./zh-hk":17549,"./zh-hk.js":17549,"./zh-mo":52240,"./zh-mo.js":52240,"./zh-tw":90405,"./zh-tw.js":90405};function s(e){var t=o(e);return a(t)}function o(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}s.keys=function(){return Object.keys(i)},s.resolve=o,e.exports=s,s.id=35358},40412:function(e,t,a){"use strict";var i=a(94373),s=a(19122),o=a.n(s),l=a(43603);let r="/api";const n=i.A.create({request:r,headers:{"Content-Type":"application/x-www-form-urlencoded"}});n.interceptors.request.use((e=>{const t=(0,l.gf)("Admin-Token");return t&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e))),n.interceptors.response.use((e=>e),(e=>(console.error("Request Error:",e),Promise.reject(e)))),t.A={getimage(e){return console.log(r+e),i.A.get(r+e,{responseType:"blob"})},companyinfo(){return i.A.get(r+"/basic/tb_iron_companyinfo/read")},writecompanyinfo(e){return i.A.post(r+"/basic/tb_iron_companyinfo/write",o().stringify(e))},companyspecialinfo(){return i.A.get(r+"/basic/tb_iron_ironinfo/read")},writecompanyspecialinfo(e){return i.A.post(r+"/basic/tb_iron_ironinfo/write",o().stringify(e))},autocompanyInfo(){return i.A.get(r+"/basic/tb_auto_construction_situation/read")},writeAutocompanyInfo(e){return i.A.post(r+"/basic/tb_auto_construction_situation/write",o().stringify(e))},deleteAutocompanyInfo(e){return i.A.post(r+"/basic/tb_auto_construction_situation/delete",o().stringify(e))},deleteDeviceinfo(e){return i.A.post(r+"/function/switch_device_to_unactive",o().stringify(e))},filterDeviceinfo(e){return console.log(e),i.A.post(r+"/function/device_info_filter",o().stringify(e))},readTallbottle(e){return i.A.post(r+"/basic/tb_iron_blastfurnace_info/read",o().stringify(e))},writeTallbottle(e){return i.A.post(r+"/basic/tb_iron_blastfurnace_info/write",o().stringify(e))},updateTallbottle(e){return i.A.post(r+"/basic/tb_iron_blastfurnace_info/update",o().stringify(e))},readRotatebottle(e){return i.A.post(r+"/basic/tb_iron_basicoxygenfurnace_info/read",o().stringify(e))},writeRotatebottle(e){return i.A.post(r+"/basic/tb_iron_basicoxygenfurnace_info/write",o().stringify(e))},updateRotatebottle(e){return i.A.post(r+"/basic/tb_iron_basicoxygenfurnace_info/update",o().stringify(e))},readGasbox(e){return i.A.post(r+"/basic/tb_iron_gastank_info/read",o().stringify(e))},writeGasbox(e){return i.A.post(r+"/basic/tb_iron_gastank_info/write",o().stringify(e))},updateGasbox(e){return i.A.post(r+"/basic/tb_iron_gastank_info/update",o().stringify(e))},readContinuous(e){return i.A.post(r+"/basic/tb_iron_continuouscastingmachine_info/read",o().stringify(e))},writeContinuous(e){return i.A.post(r+"/basic/tb_iron_continuouscastingmachine_info/write",o().stringify(e))},updateContinuous(e){return i.A.post(r+"/basic/tb_iron_continuouscastingmachine_info/update",o().stringify(e))},readHangmachine(e){return i.A.post(r+"/basic/tb_iron_crane_info/read",o().stringify(e))},writeHangmachine(e){return i.A.post(r+"/basic/tb_iron_crane_info/write",o().stringify(e))},updateHangmachine(e){return i.A.post(r+"/basic/tb_iron_crane_info/update",o().stringify(e))},readmoltentaltank(e){return i.A.post(r+"/basic/tb_iron_moltenmetaltank_info/read",o().stringify(e))},writemoltentaltank(e){return i.A.post(r+"/basic/tb_iron_moltenmetaltank_info/write",o().stringify(e))},updatemoltentaltank(e){return i.A.post(r+"/basic/tb_iron_moltenmetaltank_info/update",o().stringify(e))},readGaspartitiondevice(e){return i.A.post(r+"/basic/tb_iron_gaspartitiondevice_info/read",o().stringify(e))},writeGaspartitiondevice(e){return i.A.post(r+"/basic/tb_iron_gaspartitiondevice_info/write",o().stringify(e))},updateGaspartitiondevice(e){return i.A.post(r+"/basic/tb_iron_gaspartitiondevice_info/update",o().stringify(e))},readGasdrainer(e){return i.A.post(r+"/basic/tb_iron_gasdrainer_info/read",o().stringify(e))},writeGasdrainer(e){return i.A.post(r+"/basic/tb_iron_gasdrainer_info/write",o().stringify(e))},updateGasdrainer(e){return i.A.post(r+"/basic/tb_iron_gasdrainer_info/update",o().stringify(e))},readCoalarm(e){return i.A.post(r+"/basic/tb_iron_coalarm_info/read",o().stringify(e))},writeCoalarm(e){return i.A.post(r+"/basic/tb_iron_coalarm_info/write",o().stringify(e))},updateCoalarm(e){return i.A.post(r+"/basic/tb_iron_coalarm_info/update",o().stringify(e))},readEmergencyfac(e){return i.A.post(r+"/basic/tb_emergency_facilities_info/read",o().stringify(e))},writeEmergencyfac(e){return i.A.post(r+"/basic/tb_emergency_facilities_info/write",o().stringify(e))},deleteEmergencyfac(e){return i.A.post(r+"/basic/tb_emergency_facilities_info/delete",o().stringify(e))},updateEmergencyfac(e){return i.A.post(r+"/basic/tb_emergency_facilities_info/update",o().stringify(e))},readReliefset(e){return i.A.post(r+"/basic/tb_relief_pressure_setting_info/read",o().stringify(e))},writeReliefset(e){return i.A.post(r+"/basic/tb_relief_pressure_setting_info/write",o().stringify(e))},updateReliefset(e){return i.A.post(r+"/basic/tb_relief_pressure_setting_info/update",o().stringify(e))},readCheckout(e){return i.A.post(r+"/dm/tb_iron_check_record/read",o().stringify(e))},OnedeviceCheckout(e){return i.A.post(r+"/dm/tb_iron_check_record/read_one_device",o().stringify(e))},updateCheckout(e){return i.A.post(r+"/dm/tb_iron_check_record/update",o().stringify(e))},writeCheckout(e){return i.A.post(r+"/dm/tb_iron_check_record/write",o().stringify(e))},deleteCheckout(e){return i.A.post(r+"/dm/tb_iron_check_record/delete",o().stringify(e))},readRegularcheck(e){return i.A.post(r+"/dm/tb_iron_regularcheck_record/read",o().stringify(e))},OnedeviceRegularcheck(e){return i.A.post(r+"/dm/tb_iron_regularcheck_record/read_one_device",o().stringify(e))},updateRegularcheck(e){return i.A.post(r+"/dm/tb_iron_regularcheck_record/update",o().stringify(e))},writeRegularcheck(e){return i.A.post(r+"/dm/tb_iron_regularcheck_record/write",o().stringify(e))},deleteRegularcheck(e){return i.A.post(r+"/dm/tb_iron_regularcheck_record/delete",o().stringify(e))},readStopwork(e){return i.A.post(r+"/dm/tb_iron_device_stopwork_record/read",o().stringify(e))},writeStopwork(e){return i.A.post(r+"/dm/tb_iron_device_stopwork_record/write",o().stringify(e))},OnedeviceStopcheck(e){return i.A.post(r+"/dm/tb_iron_device_stopwork_record/read_one_device",o().stringify(e))},deleteStopwork(e){return i.A.post(r+"/dm/tb_iron_device_stopwork_record/delete",o().stringify(e))},updateStopwork(e){return i.A.post(r+"/dm/tb_iron_device_stopwork_record/update",o().stringify(e))},readScrapwork(e){return i.A.post(r+"/dm/tb_iron_device_scrap_record/read",o().stringify(e))},writeScrapwork(e){return i.A.post(r+"/dm/tb_iron_device_scrap_record/write",o().stringify(e))},updateScrapwork(e){return i.A.post(r+"/dm/tb_iron_device_scrap_record/update",o().stringify(e))},deleteScrapwork(e){return i.A.post(r+"/dm/tb_iron_device_scrap_record/delete",o().stringify(e))},OnedeviceScrapwork(e){return i.A.post(r+"/dm/tb_iron_device_scrap_record/read_one_device",o().stringify(e))}}},99955:function(e,t,a){"use strict";a.d(t,{$I:function(){return h},MK:function(){return m},OE:function(){return g},OX:function(){return u},ZF:function(){return d},aJ:function(){return c},kI:function(){return n},t1:function(){return p}});var i=a(89143),s=a(93230),o=a(46002);a(40412);let l={"所属分厂":"","所属车间":"","设备类型":"","设备名称":"","企业内部编号":"","安装地点":"","运行状态":""},r={"吊运熔融":{"起重机代码":"","起重机品种":"","起重机型号":"","起重机类型":"","备注":""},"金属熔融":{"罐体设备类别":"","额定容量（t）":"","耳轴数量（个）":"","备注":""},"一氧化碳报警器":{"位置类型":"","量程PPM":"","设备厂家":"","规格型号":"","出厂编号":"","通讯协议":"","备注":""}};const n=(e,t)=>{let a="string"==typeof e&&r[e]?r[e]:l,i=Object.keys(a).reduce(((e,a)=>(e[a]=t[a]?t[a]:"",e[a]=null===t[a]?"":e[a],a.indexOf("日期")>=0&&(e[a]=e[a]?e[a]:"0000-00-00"),e)),{}),s=Object.keys(t).reduce(((e,i)=>(a.hasOwnProperty(i)||(e[i]=t[i],e[i]=null===e[i]?"":e[i],i.indexOf("日期")>=0&&(e[i]=e[i]?e[i]:"0000-00-00")),e)),{});return[i,s]},c=(e,t)=>{let a=l;console.log(t);let i=Object.keys(a).reduce(((e,a)=>(e[a]=null===t[a]?null:t[a],e)),{}),s=Object.keys(t).reduce(((e,i)=>(a.hasOwnProperty(i)||(e[i]=null===t[i]?null:t[i]),e)),{});return[i,s]},d=e=>Object.keys(e).every((t=>null==e[t])),h=(e,t,a)=>{console.log(e,t,a);let i={};for(let s in t)switch(!0){case e.indexOf(s)>=0:i[s]=[{required:!0,message:"必填项",trigger:"change"},{pattern:/^(\d+(\.\d*)?|\.\d+)$/,message:"请输入一个数字",trigger:"change"}];break;case a&&"object"==typeof a[s]||a&&"备注"==s||a&&"设备编码"==s||a&&"问题描述"==s||a&&"图片描述"==s||a&&"存在问题"==s:i[s]=a[s];break;default:i[s]=[{required:!0,message:"不能为空",trigger:"change"}];break}return i},p=e=>new Promise(((t,a)=>{i.MessageBox.confirm("确认上报已选信息?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{console.log(e),t({status:"yes",value:e})})).catch((()=>{t({status:"no"})}))})),g=e=>{let t=e.tableData.map((e=>{const{"系统ID":t,ID:a,...i}=e;return i}));const a=s.Wp.json_to_sheet(t),i=s.Wp.book_new();s.Wp.book_append_sheet(i,a,e.title+"表格数据"),s._h(i,e.title+"表格数据.xlsx")};async function u(){let e=await o.A.getReportId();return console.log(e),"成功"==e.data.msg?e.data.data:(this.$message.error("获取ID失败！"),!1)}async function m(e,t){console.log("imageUrl",e),console.log("referType",t);let a=e.split("/");console.log(a[a.length-1]);const s=await this.$axios.get("/api/statics/"+a[a.length-1],{responseType:"blob"}),l=new Blob([s.data]),r=e.split(".").pop(),n=e.split("/")[4].split("_")[0],c=new File([l],`${n}.${r}`,{type:"image/"+r});console.log("上报图片参数"),console.log(r),console.log(n),console.log(c);const d=new FormData;d.append("file",c),d.append("relativeId",n),d.append("referType",t),console.log("formData",d);let h=await o.A.getReportToken();if(200==h.status){let e=await o.A.uploadFile(d,n);return e}return i.MessageBox.error("局端token获取失败"),{data:{code:401}}}},47149:function(e,t,a){"use strict";a.d(t,{Vp:function(){return o},iD:function(){return s},ri:function(){return l}});var i=a(44453);function s(e,t,a,s){const o={username:e,password:t,code:a,uuid:s};return(0,i.Ay)({url:"/login",headers:{isToken:!1},method:"post",data:o})}function o(){return(0,i.Ay)({url:"/getInfo",method:"get"})}function l(){return(0,i.Ay)({url:"/logout",method:"post"})}},46002:function(e,t,a){"use strict";var i=a(94373),s=a(43603);a(89143);let o="/reportapi/qinyou";t.A={async getReportToken(){return i.A.get(o+"/ReportedData/getToken")},async uploadFile(e,t){try{let a=await this.getReportToken();if(200!==a.status)throw new Error("Failed to get report token");let s=await this.getFile({relativeId:t},a.data.data);if(console.log("局端是否有该rellativeid",s.data.data),0==s.data.data.length){const t=i.A.post("/zfapi/prod-api/web/ironWarn/store/upload",e,{headers:{Authorization:a.data.data,"Content-Type":"multipart/form-data"}});if(200===t.status)return console.log("Warning Info:",t.data),t.data;throw new Error(`Request failed with status ${t.status}`)}return[]}catch(a){throw console.error("Error in zfwarningInfo:",a.message),a}},uploadFileLocal(e){return i.A.post("/api/function/upload",e,{})},deleteuploadFile(e){return i.A.get("/api/web/ironWarn/store/deleteFileById?id="+e.id,{headers:{Authorization:(0,s.gf)("Report-Token")}})},async getFile(e,t){try{const a=await i.A.get("/zfapi/prod-api/web/ironWarn/store/getByRelativeId?relativeId="+e.relativeId,{headers:{Authorization:t}});if(200===a.status)return console.log("Warning Info:",a.data),a.data;throw new Error(`Request failed with status ${a.status}`)}catch(a){throw console.error("Error in zfwarningInfo:",a.message),a}},getReportId(){return i.A.get(o+"/ReportedData/getId")},reportCompany(e){return i.A.post(o+"/ReportedData/ironWarn/basicCompany/updateByState",e)},readCompany(){return i.A.get(o+"/TbIronCompanyinfo/1")},updateCompany(e){return i.A.put(o+"/TbIronCompanyinfo",e)},reportPersonal(e){return i.A.post(o+"/ReportedData/ironWarn/basicIron/saveByState",e)},readPersonal(){return i.A.get(o+"/TbIronIroninfo/1",{headers:{Authorization:"Bearer "+(0,s.gf)("Admin-Token")}})},updatePersonal(e){return i.A.put(o+"/TbIronIroninfo",e)},reportDevice(e){return i.A.post(o+"/ReportedData/ironWarn/device/enterpriseSave",e)},listReportStatus(e){return i.A.post(o+"/ReportedData/device/state",e)},idscheckReportStatus(e){return i.A.post(o+"/ReportedData/supervision/checkRecord/flag",e)},idsregularcheckReportStatus(e){return i.A.post(o+"/ReportedData/supervision/regularcheck/flag",e)},idsstopReportStatus(e){return i.A.post(o+"/ReportedData/supervision/stopworkRecord/flag",e)},idsscrabReportStatus(e){return i.A.post(o+"/ReportedData/supervision/scarpRecord/flag",e)},checkreportDevice(e){return i.A.post(o+"/ReportedData/supervision/checkRecord/save",e)},reugularcheckreportDevice(e){return i.A.post(o+"/ReportedData/supervision/regularcheck/save",e)},stopreportDevice(e){return i.A.post(o+"/ReportedData/supervision/stopworkRecord/save",e)},scrabreportDevice(e){return i.A.post(o+"/ReportedData/ironWarn/scarpRecord/save",e)},async zfwarningInfo(e){try{let t=await this.getReportToken();if(200!==t.status)throw new Error("Failed to get report token");const a=await i.A.get("/zfapi/prod-api/judgment/tbIronWarninfo/findJudgmentWarnInfo",{headers:{Authorization:t.data.data},params:e});if(200===a.status)return a.data;throw new Error(`Request failed with status ${a.status}`)}catch(t){throw console.error("Error in zfwarningInfo:",t.message),t}},warninginfoFeedback(e){return i.A.post(o+"/ReportedData/judgment/tbIronWarninfo/updateFeedback",e)},videoReport(e){return i.A.post(o+"/ReportedData/ironWarn/video/saveByState",e)}}},34829:function(e,t,a){"use strict";a.d(t,{AX:function(){return s}});var i=a(44453);function s(e){return(0,i.Ay)({url:"/mes/watch/videodevice/query",method:"get",params:e})}},95152:function(e,t,a){"use strict";a.d(t,{z9:function(){return s}});var i=a(44453);function s(e){return(0,i.Ay)({url:"/mes/watch/videosite/query",method:"get",params:e})}},9561:function(e,t,a){"use strict";var i=a(66848),s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("keep-alive",["index"==e.$route.name?t("router-view"):e._e()],1),"index"!=e.$route.name?t("router-view"):e._e()],1)},o=[],l={name:"App"},r=l,n=a(81656),c=(0,n.A)(r,s,o,!1,null,null,null),d=c.exports,h=a(37303),p=a(89143),g=a.n(p),u=a(7808),m=a(87149),f=a.n(m),w=a(99955),b=a(61250),v=a(94373);i["default"].config.productionTip=!1,i["default"].prototype.$echarts=u,i["default"].config.productionTip=!1,i["default"].use(f()),i["default"].use(g()),i["default"].prototype.$assignValues=w.kI,i["default"].prototype.$formatFormRules=w.$I,i["default"].prototype.$functionConfrim=w.t1,i["default"].prototype.$store=b.A,i["default"].prototype.$downloadExcel=w.OE,i["default"].prototype.$getId=w.OX,i["default"].prototype.$axios=v.A,i["default"].prototype.$reportimginfo=w.MK,new i["default"]({router:h.A,render:e=>e(d)}).$mount("#app")},37303:function(e,t,a){"use strict";a.d(t,{z:function(){return xr},A:function(){return Ir}});a(44114);var i=a(66848),s=a(56178),o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("Head"),t("div",{staticClass:"mainbox"},[t("el-row",[t("el-col",{attrs:{span:6}},[t("div",{directives:[{name:"show",rawName:"v-show",value:0==e.activeNum,expression:"activeNum == 0"}],staticClass:"leftside"},[t("div",{staticClass:"part1"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid","margin-top":"0.35rem"}},[t("div",{staticClass:"alltitle"},[e._v("秦邮概况")])]),t("div",{staticStyle:{width:"22.4vw",height:"100%","padding-top":"0.01rem","z-index":"2"}},e._l(e.navlink,(function(a,i){return t("div",{key:a.title,staticClass:"quickNavLink"},[t("router-link",{attrs:{to:a.path}},[e._v(" "+e._s(a.title)+" ")])],1)})),0)]),t("div",{staticClass:"part2"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid"}},[t("div",{staticStyle:{float:"right",color:"rgb(255, 255, 255, 0.7)","font-size":"0.15rem","border-radius":"0.05rem",width:"0.5rem",height:"0.21rem","line-height":"0.18rem",border:"0.02rem #1bb3d9 solid"}},[e._v("  "+e._s(e.thisyear)+"  ")]),t("div",{staticClass:"alltitle"},[e._v("设备占比")])]),t("el-row",{staticStyle:{width:"100%",height:"20vh",display:"flex","align-items":"center","margin-top":"0.1rem"}},[t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{width:"100%",height:"20vh"},attrs:{id:"pie"}})]),t("el-col",{attrs:{span:10}},[t("div",{staticClass:"pielabel",staticStyle:{width:"100%"}},[t("div",{staticClass:"labelbox",staticStyle:{width:"100%","border-top":"0.02rem rgb(24, 185, 177, 1) solid",display:"flex"}},[t("div",{staticStyle:{"background-color":"rgb(24, 185, 177, 1)",height:"0.35rem",width:"0.9rem",color:"white","text-align":"center","line-height":"0.34rem","margin-top":"0.07rem","font-size":"0.19rem","min-width":"50px"}},[e._v(" 设备台数 ")]),t("div",{staticStyle:{color:"#fff","font-size":"0.2rem","margin-top":"0.05rem","text-align":"right","line-height":"0.4rem",width:"45%"}},[e._v(" "+e._s(e.thisStu)+"台 ")])]),t("div",{staticClass:"labelbox",staticStyle:{width:"100%","margin-top":"0.1rem","border-bottom":"0.02rem rgb(98, 73, 185, 1) solid",display:"flex"}})])])],1)],1),t("div",{staticClass:"part3"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.27rem"}},[t("div",{staticStyle:{float:"right",color:"rgb(255, 255, 255, 0.7)","font-size":"0.15rem","border-radius":"0.05rem",width:"0.7rem",height:"0.21rem","line-height":"0.17rem",border:"0.02rem #1bb3d9 solid","text-align":"center"}},[e._v("  "+e._s(e.thismajor)+"  ")]),t("div",{staticClass:"alltitle"},[e._v("安防概况")])]),t("div",{staticStyle:{width:"100%",height:"28vh"},attrs:{id:"category"}})])]),t("div",{directives:[{name:"show",rawName:"v-show",value:1==e.activeNum,expression:"activeNum == 1"}],staticClass:"leftside"},[t("div",{staticClass:"part1"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem"}},[t("div",{staticClass:"alltitle"},[e._v("设备信息")])]),t("div",{staticStyle:{width:"22.4vw",height:"25vh"}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("div",[t("div",{staticClass:"teachertype1"},[e._v(e._s(e.postgraduate))]),t("img",{staticStyle:{width:"1.2rem",height:"1.1rem",margin:"-0.45rem 0 0 0.2rem"},attrs:{src:a(81462)}}),t("div",{staticStyle:{color:"#fff","margin-left":"0.42rem"}},[e._v(" 安全报警 ")])])]),t("el-col",{attrs:{span:8}},[t("div",[t("div",{staticClass:"teachertype2"},[e._v(e._s(e.undergraduate))]),t("img",{staticStyle:{width:"1.2rem",height:"1.1rem",margin:"-0.45rem 0 0 0.2rem"},attrs:{src:a(43139)}}),t("div",{staticStyle:{color:"#fff","margin-left":"0.42rem"}},[e._v(" 能源报警 ")])])]),t("el-col",{attrs:{span:8}},[t("div",[t("div",{staticClass:"teachertype3"},[e._v(e._s(e.juniorgraduate))]),t("img",{staticStyle:{width:"1.2rem",height:"1.1rem",margin:"-0.45rem 0 0 0.2rem"},attrs:{src:a(4903)}}),t("div",{staticStyle:{color:"#fff","margin-left":"0.42rem"}},[e._v(" 其他报警 ")])])])],1)],1)]),t("div",{staticClass:"part2",staticStyle:{"margin-top":"-0.7rem"}},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem"}},[t("div",{staticClass:"alltitle"},[e._v("出勤概况")])]),t("div",[t("el-row",[t("el-col",{attrs:{span:12}},[t("div",{staticClass:"circular2"}),t("div",{staticStyle:{width:"16vw",height:"20vh",margin:"0.1rem 0 0 -0.63rem",position:"absolute"},attrs:{id:"pie2"}}),t("div",{staticClass:"circular3"},[t("img",{staticStyle:{width:"0.65rem",height:"0.65rem",margin:"0.24rem 0.25rem"},attrs:{src:a(69487)}})])]),t("el-col",{attrs:{span:12}},[t("div",{staticStyle:{width:"2.67rem",height:"2rem",margin:"-0.1rem 0 0 2rem"}},[t("div",{staticStyle:{margin:"0.1rem",float:"left","text-align":"center","margin-left":"0.4rem"}},[t("div",{class:0==e.showindex?"activeindex":"nomalindex",staticStyle:{float:"left",width:"0.7rem",height:"0.3rem",margin:"0.1rem 0"}},[e._v(" 本月 ")]),t("div",{class:1==e.showindex?"activeindex":"nomalindex",staticStyle:{float:"left",width:"0.7rem",height:"0.3rem",margin:"0.1rem 0"}},[e._v(" 本季 ")]),t("div",{class:2==e.showindex?"activeindex":"nomalindex",staticStyle:{float:"left",width:"0.7rem",height:"0.3rem",margin:"0.1rem 0"}},[e._v(" 本年 ")])]),t("div",{staticStyle:{width:"1.6rem",height:"1.37rem",float:"left","margin-top":"0.01rem","border-top":"0.02rem #03ffb1 solid","border-bottom":"0.02rem #ff5a66 solid","margin-left":"0.4rem"}},[t("div",{staticStyle:{"margin-top":"0.06rem"}},[t("div",{staticStyle:{"margin-bottom":"0.15rem",width:"0.5rem",height:"0.3rem","background-color":"rgb(3, 255, 177, 0.69)",color:"#fff","text-align":"center","line-height":"0.27rem"}},[e._v(" 满勤 ")]),t("div",{staticStyle:{color:"#03ffb1",float:"right","margin-top":"-0.48rem","text-align":"right"}},[e._v(" "+e._s(this.thisFullAttendance)+"台 "),t("div",{staticStyle:{color:"#03ffb1","margin-top":"-0.05rem"}},[e._v(" "+e._s(Math.round(e.thisFullAttendance/(e.thisFullAttendance+e.thisLate+e.thisLeaveEarly)*100))+"% ")])])]),t("div",[t("div",{staticStyle:{"margin-bottom":"0.15rem",width:"0.5rem",height:"0.3rem","background-color":"#f8b700",color:"#fff","text-align":"center","line-height":"0.27rem"}},[e._v(" 迟到 ")]),t("div",{staticStyle:{color:"#fede7f",float:"right","margin-top":"-0.48rem","text-align":"right"}},[e._v(" "+e._s(this.thisLate)+"人 "),t("div",{staticStyle:{color:"#fede7f","margin-top":"-0.05rem"}},[e._v(" "+e._s(Math.round(e.thisLate/(e.thisFullAttendance+e.thisLate+e.thisLeaveEarly)*100))+"% ")])])]),t("div",[t("div",{staticStyle:{width:"0.5rem",height:"0.3rem","background-color":"#ff5a66",color:"#fff","text-align":"center","line-height":"0.28rem"}},[e._v(" 早退 ")]),t("div",{staticStyle:{color:"#ff5a66",float:"right","margin-top":"-0.34rem","text-align":"right"}},[e._v(" "+e._s(this.thisLeaveEarly)+"人 "),t("div",{staticStyle:{color:"#ff5a66","margin-top":"-0.05rem"}},[e._v(" "+e._s(Math.round(e.thisLeaveEarly/(e.thisFullAttendance+e.thisLate+e.thisLeaveEarly)*100))+"% ")])])])])])])],1),t("div",[t("ScrollTable")],1)],1)])]),t("div",{directives:[{name:"show",rawName:"v-show",value:2==e.activeNum,expression:"activeNum == 2"}],staticClass:"leftside"},[t("div",{staticClass:"part1"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem"}},[t("div",{staticClass:"alltitle"},[e._v("男女比例")])]),t("div",{staticStyle:{width:"12vw",height:"19vh",margin:"2% 0"}},[t("el-row",{attrs:{span:8}},[t("div",{staticClass:"circular"}),t("div",{staticStyle:{width:"12vw",height:"19vh",margin:"-0.05rem 0 0 -0.25rem",position:"absolute"},attrs:{id:"pie3"}}),t("div",{staticClass:"circular1"},[t("img",{staticStyle:{width:"0.55rem",height:"0.55rem",margin:"0.1rem 0.12rem"},attrs:{src:a(5314)}})])]),t("el-row",{attrs:{span:16}},[t("div",{staticClass:"pielabel",staticStyle:{width:"70%",height:"100%",position:"absolute",margin:"0.25rem 0 0 2.2rem"}},[t("div",{staticClass:"labelbox",staticStyle:{width:"100%",height:"100%",margin:"0.03rem 0 0 0","border-top":"0.02rem rgb(24, 185, 177, 1) solid"}},[t("div",{staticStyle:{float:"left","background-color":"rgb(24, 185, 177, 1)",height:"0.35rem",width:"0.9rem",color:"white","text-align":"center","line-height":"0.3rem","margin-top":"0.07rem","font-size":"0.19rem"}},[e._v(" 男生人数 ")]),t("div",{staticStyle:{float:"left",color:"rgb(24, 185, 177)","font-size":"0.01rem","margin-top":"0.01rem","font-weight":"bold","text-align":"right",width:"45%"}},[e._v(" "+e._s(e.men)+"人 "),t("div",{staticStyle:{color:"rgb(24, 185, 177)"}},[e._v(" "+e._s(Math.round(e.men/(e.men+e.women)*100))+"% ")])])]),t("div",{staticClass:"labelbox",staticStyle:{width:"100%",height:"0.45rem",margin:"0.7rem 0 2rem 0","border-bottom":"0.02rem rgb(98, 73, 185, 1) solid"}},[t("div",{staticStyle:{float:"left","background-color":"rgb(98, 73, 185, 1)",height:"0.35rem",width:"0.9rem",color:"white","text-align":"center","line-height":"0.3rem","font-size":"0.19rem"}},[e._v(" 女生人数 ")]),t("div",{staticStyle:{float:"left",color:"rgb(98, 73, 185)","font-size":"0.01rem","margin-top":"-0.07rem","font-weight":"bold","text-align":"right",width:"45%"}},[e._v(" "+e._s(e.women)+"人 "),t("div",{staticStyle:{color:"rgb(98, 73, 185)"}},[e._v(" "+e._s(Math.round(e.women/(e.women+e.men)*100))+"% ")])])])])])],1)]),t("div",{staticClass:"part2"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem"}},[t("div",{staticClass:"alltitle"},[e._v("年纪人数")])]),t("div",{staticStyle:{width:"22.4vw",height:"25vh"},attrs:{id:"bar"}})]),t("div",{staticClass:"part3"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem"}},[t("div",{staticClass:"alltitle"},[e._v("生源分布")])]),t("div",{staticStyle:{width:"22.4vw",height:"32vh",overflow:"hidden"}},[t("img",{staticStyle:{width:"6.5rem",height:"2.8rem",margin:"1.3rem 0 0 -1.2rem","z-index":"-1"},attrs:{src:a(64636)}}),t("img",{staticStyle:{width:"2.6rem",height:"2.3rem",margin:"-5.9rem 0 0 0.76rem"},attrs:{src:a(42313)}})])])])]),t("el-col",{attrs:{span:12}},[t("div",{},[e._v(" ")]),t("div",{staticStyle:{width:"50%","text-align":"center",position:"fixed",bottom:"0.2rem"}},[t("Navbar")],1)]),t("el-col",{attrs:{span:6}},[t("div",{directives:[{name:"show",rawName:"v-show",value:0==e.activeNum,expression:"activeNum == 0"}],staticClass:"rightside"},[t("div",{staticClass:"part4"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem"}},[t("div",{staticClass:"alltitle"},[e._v("公司介绍")])]),t("div",{staticClass:"part4_box"},[t("el-row",{staticStyle:{height:"100%",padding:"0.5rem 0 0 0.2rem"}},[t("el-col",{staticStyle:{height:"100%"},attrs:{span:10}},[t("img",{staticStyle:{width:"1.7rem",height:"calc(100% - 0.5rem)"},attrs:{src:a(42255)}})]),t("el-col",{staticStyle:{height:"100%"},attrs:{span:14}},[t("div",{staticStyle:{color:"rgb(255, 255, 255, 0.8)",height:"calc(100% - 0.5rem)",width:"100%","overflow-y":"auto"}},[e._v("   扬州市秦邮特种金属材料有限公司是隶属于江苏沿海钢铁集团有限公司六大生产基地之一。江苏沿海钢铁集团有限公司由总裁陈家榕先生等知名企业家创建于2011年，集团总部设在新亚欧大陆桥经济走廊的东方桥头堡、充满生机和魅力的海滨城市——连云港。经过13年的快速发展,沿海钢铁集团已成长为华东地区最具竞争力的建筑钢材产业集群，经国家发改委、工信部确认的产能达1800万吨，拥有固定资产800多亿元。2023年生产钢材超1600万吨，实现销售收入超650亿元、利税总额逾25亿元。 扬州市秦邮特种金属材料有限公司成立于2009年，由沿海集团出资收购重组而成。仅用16个月优质高效的完成了年产300万吨高强优特钢技改工程建设。公司区域优势明显，东接京沪高速，西临京杭大运河。目前公司具备年产300万吨优特建筑钢材生产能力，是一家集烧结、炼铁、炼钢、轧钢、球团、石灰、质检、制氧、物流、余热余气发电、渣处理为一体的资源节约型、环境友好型企业，企业工艺流程完备、技术装备先进，管理制度规范、企业文化优秀。产品远销上海、浙江、安徽、湖北、重庆等，并被港珠澳大桥、京沪高铁等国家重点工程选用，深受用户好评。 ")])])],1)],1)]),t("div",{staticClass:"part5"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.27rem"}},[t("div",{staticClass:"alltitle"},[e._v("监控统计")]),t("el-row",{staticStyle:{height:"100%"}},[t("el-col",{attrs:{span:6}},[t("div",{attrs:{id:"liquidEchart"}})]),t("el-col",{attrs:{span:18}},[t("div",{staticStyle:{width:"17vw",height:"20vh"},attrs:{id:"studntDetails"}})])],1)],1)]),t("div",{staticClass:"part6"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem"}},[t("div",{staticClass:"alltitle"},[e._v("员工风采")])]),t("el-row",{attrs:{gutter:35}},e._l(e.teatherList,(function(i){return t("div",{key:i.index,attrs:{data:e.teatherList}},[t("el-col",{attrs:{span:8}},[t("div",{staticClass:"showTeacher"},[t("img",{staticStyle:{width:"1rem",height:"0.75rem","margin-top":"0.15rem"},attrs:{src:a(67233)}})]),t("div",{staticStyle:{"margin-top":"-0.7rem","text-align":"center",height:"0.75rem"}},[t("div",{staticStyle:{color:"white","font-size":"0.15rem"}},[e._v(" "+e._s(i.name)+" ")]),t("div",{staticStyle:{color:"white","font-weight":"100","font-size":"0.125rem"}},[e._v(" "+e._s(i.position)+" ")]),t("div",{staticStyle:{color:"white","font-weight":"100","font-size":"0.125rem"}},[e._v(" "+e._s(i.rank)+" ")])])])],1)})),0)],1)]),t("div",{directives:[{name:"show",rawName:"v-show",value:1==e.activeNum,expression:"activeNum == 1"}],staticClass:"rightside"},[t("div",{staticClass:"part4"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem"}},[t("div",{staticClass:"alltitle"},[e._v("教师数量")])]),t("div",{staticStyle:{width:"22.4vw",height:"25vh"}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("div",[t("div",{staticClass:"teachertype1",staticStyle:{"margin-left":"0.51rem"}},[e._v(" "+e._s(e.internship)+" ")]),t("img",{staticStyle:{width:"1.2rem",height:"1.1rem",margin:"-0.45rem 0 0 0.2rem"},attrs:{src:a(81462)}}),t("div",{staticStyle:{color:"#fff","margin-left":"0.5rem"}},[e._v(" 实习教师 ")])])]),t("el-col",{attrs:{span:8}},[t("div",[t("div",{staticClass:"teachertype2"},[e._v(e._s(e.backbone))]),t("img",{staticStyle:{width:"1.2rem",height:"1.1rem",margin:"-0.45rem 0 0 0.2rem"},attrs:{src:a(43139)}}),t("div",{staticStyle:{color:"#fff","margin-left":"0.5rem"}},[e._v(" 骨干教师 ")])])]),t("el-col",{attrs:{span:8}},[t("div",[t("div",{staticClass:"teachertype3"},[e._v(e._s(e.superteacher))]),t("img",{staticStyle:{width:"1.2rem",height:"1.1rem",margin:"-0.45rem 0 0 0.2rem"},attrs:{src:a(4903)}}),t("div",{staticStyle:{color:"#fff","margin-left":"0.5rem"}},[e._v(" 特级教师 ")])])])],1)],1)]),t("div",{staticClass:"part5"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem","margin-top":"-0.7rem"}},[t("div",{staticClass:"alltitle",staticStyle:{width:"1.3rem"}},[e._v("教师获奖信息")])]),t("div",{staticStyle:{"margin-top":"0.18rem"}},e._l(e.awardList,(function(i){return t("div",{key:i.index,attrs:{data:e.awardList}},[t("div",{staticStyle:{height:"1.16rem",width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid","margin-bottom":"0.2rem"}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("img",{staticStyle:{width:"1.3rem",height:"1rem"},attrs:{src:a(67233)}})]),t("el-col",{attrs:{span:16}},[t("div",[t("div",[t("span",{staticStyle:{color:"#fff"}},[e._v("姓名："+e._s(i.name))]),t("span",{staticStyle:{color:"#fff"}},[e._v(" 年龄："+e._s(i.age))]),t("span",{staticStyle:{color:"#fff"}},[e._v(" 职称："+e._s(i.title))])]),t("br"),t("div",{staticStyle:{color:"#fff",height:"0.53rem",width:"3rem","word-wrap":"break-word",overflow:"auto"}},[e._v(" 获得荣誉："+e._s(i.award)+" ")])])])],1)],1)])})),0)])]),t("div",{directives:[{name:"show",rawName:"v-show",value:2==e.activeNum,expression:"activeNum == 2"}],staticClass:"rightside"},[t("div",{staticClass:"part4"},[t("div",{staticStyle:{width:"22.4vw","border-bottom":"0.01rem rgb(27, 179, 217, 0.38) solid",height:"0.265rem"}},[t("div",{staticClass:"alltitle"},[e._v("招生列表")]),t("div",{staticStyle:{"margin-top":"0.15rem"}},e._l(e.studentList,(function(a){return t("div",{key:a.index,attrs:{data:e.studentList}},[t("div",{staticClass:"studentList"},[e._v("   "+e._s(a.name)+" "+e._s(a.area)+" "+e._s(a.gender)+" "+e._s(a.nation)+"  "+e._s(a.college)+" "+e._s(a.stuclass)+" ")])])})),0)])])])])],1)],1)],1)},l=[],r=a(20986),n=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("div",{staticClass:"head"},[t("div",{staticClass:"notice"},[e._v("欢迎浏览秦邮企业安全风险预警系统!")]),t("h1",[e._v("秦邮安全风险预警系统")]),t("div",{staticClass:"weather"},[t("div",{staticClass:"date"},[t("weather"),e._v(" "+e._s(e.date+" "+e.time)+" ")],1)]),t("systemmanage")],1)])},c=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"loading"},[t("div",{staticClass:"loadbox"},[t("img",{attrs:{src:a(18788)}}),e._v(" 页面加载中... ")])])}],d=a(43603),h=function(){var e=this,t=e._self._c;return t("span",[e._v(e._s(e.weather.temperature)+" °C "+e._s(e.weather.weather)+" "+e._s(e.weather.windDirection)+"风："+e._s(e.weather.windPower)+"级 "+e._s(e.weather.pressure))])},p=[],g=a(83560),u=a.n(g),m={name:"map-view",mounted(){this.initAMap(),this.timer=setInterval((()=>{this.getCityWeather()}),3e5)},data(){return{weather:{},timer:null}},methods:{initAMap(){window._AMapSecurityConfig={securityJsCode:"0880215613b23afb6984e5798737c355"},u().load({key:"e2286ba58bd9621be85e31415c7e03d6"}).then((e=>{this.getCityWeather()})).catch((e=>{console.log(e)}))},getCityWeather(){var e=this;AMap.plugin("AMap.Weather",(function(){let t=new AMap.Weather;t.getLive("高邮市",(function(t,a){"OK"==a.info&&(e.weather=a)}))}))}}},f=m,w=a(81656),b=(0,w.A)(f,h,p,!1,null,"85ca3f00",null),v=b.exports,y=function(){var e=this,t=e._self._c;return t("div",[t("el-dropdown",{staticClass:"systemset",on:{command:e.clickmenu}},[t("i",{staticClass:"el-icon-more"}),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{attrs:{icon:"el-icon-caret-left",command:"logout"}},[e._v("退出系统")])],1)],1),t("el-dialog",{staticClass:"messageHandle",attrs:{title:"处理工单",visible:e.addRowDialogVisible,modal:!1,center:"","close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("el-radio-group",{attrs:{size:"medium"},model:{value:e.radio1,callback:function(t){e.radio1=t},expression:"radio1"}},[t("el-radio-button",{attrs:{label:"待我处理的工单"}}),t("el-radio-button",{attrs:{label:"我提交的工单"}})],1),t("el-table",{staticStyle:{width:"100%",background:"transparent"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{label:"编辑",width:"180"}},[t("el-button",{attrs:{type:"text",size:"medium"},on:{click:e.handleRow}},[e._v("处理")])],1),t("el-table-column",{attrs:{prop:"info",label:"报警信息"}}),t("el-table-column",{attrs:{prop:"alarm_level",label:"报警等级"}}),t("el-table-column",{attrs:{prop:"co",label:"一氧化碳浓度"}}),t("el-table-column",{attrs:{prop:"responPerson",label:"提交人"}})],1),t("el-dialog",{staticClass:"messageHandle2",attrs:{title:"填写",visible:e.DialogVisible,modal:!1,center:"",width:"8rem",top:"3rem","close-on-click-modal":!1},on:{"update:visible":function(t){e.DialogVisible=t}}},[e._v(" 处理意见："),t("el-input",{model:{value:e.newRow.value,callback:function(t){e.$set(e.newRow,"value",t)},expression:"newRow.value"}}),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.handle()}}},[e._v("确定")]),t("el-button",{on:{click:function(t){e.DialogVisible=!1}}},[e._v("取消")])],1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow()}}},[e._v("提交")]),t("el-button",{on:{click:function(t){e.addRowDialogVisible=!1}}},[e._v("取消")])],1)],1)],1)},_=[],S={data(){return{addRowDialogVisible:!1,DialogVisible:!1,radio1:"待我处理的工单",tableData:[{info:"石固221_4#加压机旁",alarm_level:"红色预警",co:"10.00",responPerson:"test"},{info:"石固221_4#加压机旁",alarm_level:"红色预警",co:"10.00",responPerson:"test"},{info:"石固221_4#加压机旁",alarm_level:"红色预警",co:"10.00",responPerson:"test"}],newRow:{value:""},loadingbtn:!1}},methods:{handleRow(e){this.DialogVisible=!0},handle(){},addRow(){},clickmenu(e){console.log(e),"logout"==e?((0,d.eF)("Admin-Token"),(0,d.eF)("Report-Token"),setTimeout((()=>{this.$router.push("/")}),500)):this.addRowDialogVisible=!0}}},D=S,R=(0,w.A)(D,y,_,!1,null,null,null),k=R.exports,$=a(46587),C=a.n($),x={data(){return{date:"",time:"",wea:"",tem:"",wea_img:""}},components:{weather:v,systemmanage:k},created(){this.getTimes()},mounted(){C()(window).ready((function(){C()(".loading").fadeOut()}))},methods:{getTimes(){setInterval(this.getTimesInterval,1e3)},getTimesInterval:function(){let e=this,t=(new Date).getFullYear(),a=(new Date).getMonth()+1,i=(new Date).getDate(),s=(new Date).getHours(),o=(new Date).getMinutes(),l=(new Date).getSeconds();s<10&&(s="0"+s),o<10&&(o="0"+o),l<10&&(l="0"+l),e.date=t+"-"+a+"-"+i,e.time=s+":"+o+":"+l}}},I=x,A=(0,w.A)(I,n,c,!1,null,null,null),z=A.exports,O=(a(92356),function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[e._m(0),t("vue-seamless-scroll",{staticClass:"scrollarea",attrs:{data:e.List,"class-option":e.classOption}},[t("ul",{staticClass:"tr-cont"},e._l(e.List,(function(a,i){return t("li",{key:i},[t("span",{staticClass:"tr-cont-li",staticStyle:{width:"10%"}},[e._v(e._s(i+1))]),t("span",{staticClass:"tr-cont-li",staticStyle:{width:"25%"}},[e._v(e._s(a.name))]),t("span",{staticClass:"tr-cont-li",staticStyle:{width:"35%"}},[e._v(e._s(a.time))]),"满勤"==a.state?t("span",{staticClass:"tr-cont-li",staticStyle:{width:"25%",color:"#03FFB1"}},[e._v(e._s(a.state))]):e._e(),"迟到"==a.state?t("span",{staticClass:"tr-cont-li",staticStyle:{width:"25%",color:"#FF5A66"}},[e._v(e._s(a.state))]):e._e(),"早退"==a.state?t("span",{staticClass:"tr-cont-li",staticStyle:{width:"25%",color:"#F8B700"}},[e._v(e._s(a.state))]):e._e()])})),0)])],1)}),T=[function(){var e=this,t=e._self._c;return t("ul",{staticClass:"tabletitle"},[t("li",{staticStyle:{width:"12%"}},[e._v("序号")]),t("li",{staticStyle:{width:"24%"}},[e._v("姓名")]),t("li",{staticStyle:{width:"37.5%"}},[e._v("时间")]),t("li",{staticStyle:{width:"25%"}},[e._v("状态")])])}],V={name:"ScrollTable",data(){return{List:[{name:"李老师",time:"2022.5.6 9:20",state:"满勤"},{name:"李老师",time:"2022.5.6 9:20",state:"满勤"},{name:"李老师",time:"2022.5.6 9:20",state:"满勤"},{name:"李老师",time:"2022.5.6 9:20",state:"迟到"},{name:"李老师",time:"2022.5.6 9:20",state:"满勤"},{name:"李老师",time:"2022.5.6 9:20",state:"满勤"},{name:"李老师",time:"2022.5.6 9:20",state:"迟到"},{name:"李老师",time:"2022.5.6 9:20",state:"满勤"},{name:"李老师",time:"2022.5.6 9:20",state:"满勤"},{name:"李老师",time:"2022.5.6 9:20",state:"满勤"},{name:"李老师",time:"2022.5.6 9:20",state:"早退"},{name:"李老师",time:"2022.5.6 9:20",state:"迟到"},{name:"李老师",time:"2022.5.6 9:20",state:"满勤"},{name:"李老师",time:"2022.5.6 9:20",state:"满勤"}]}},methods:{},computed:{classOption(){return{step:.7,limitMoveNum:this.List.length,hoverStop:!0,direction:1,openWatch:!0,singleHeight:38,singleWidth:0,waitTime:3e3}}}},P=V,F=(0,w.A)(P,O,T,!1,null,null,null),N=F.exports;const j=e=>{document.documentElement;let t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;if(!t)return;let a=t/1920;return e*a};var W=function(){var e=this;e._self._c;return e._m(0)},M=[function(){var e=this,t=e._self._c;return t("div",[t("div",{staticStyle:{width:"100%",height:"500px"},attrs:{id:"mapContainer"}})])}],L={mounted(){this.initMap()},methods:{initMap(){const e=new AMap.Map("mapContainer",{zoom:15,center:[116.397428,39.90923],mapStyle:"amap://styles/whitesmoke"});AMap.plugin(["AMap.AR"],(()=>{const t=new AMap.AR({position:"RB",viewMode:"3D"});e.addControl(t),t.start()}))}}},E=L,J=(0,w.A)(E,W,M,!1,null,"4b146d01",null),U=J.exports,B={components:{Navbar:r.A,Head:z,ScrollTable:N,mapVue:U},data(){return{loading:!1,stu:[699,805,1022,2133,3143,4153,5167],thisStu:"1001",thisTeather:"717",teather:[300,450,550,660,860,970,1690],year:[2016,2017,2018,2019,2020,2021,2022],thisyear:"2024",area:[[2050,2600,2622,2832,2461,2686,2701],[1130,1420,1200,1180,1434,1689,1214],[2203,1622,2232,2442,2050,2256,1860],[1318,1538,1816,2326,2614,2714,2826],[2116,2110,2110,2138,2110,2114,2118],[2428,2012,2632,2835,2617,2720,2530]],major:["部门1","部门2","部门3","部门4","部门5","部门6"],thismajor:"部门1",teatherList:[{name:"圣鑫",rank:"高级工程师",position:"安全部部长"},{name:"圣鑫",rank:"高级工程师",position:"安全部部长"},{name:"圣鑫",rank:"高级工程师",position:"安全部部长"}],chartsLiquid:"",activeNum:0,navlink:[{title:"企业基础信息",path:"/basicinfo/introduction"},{title:"企业自动化系统建设",path:"/basicinfo/autocompany"},{title:"企业专项信息",path:"/basicinfo/personalrecord"},{title:"设施设备信息",path:"/basicinfo/deviceinfo/devicetallbottle"},{title:"企业日常数据",path:"/basicinfo/companydaily/checkout"}],postgraduate:32,undergraduate:64,juniorgraduate:12,fullAttendance:[1567,1132,667],late:[121,201,330],leaveEarly:[50,100,200],thisFullAttendance:"",thisLate:"",thisLeaveEarly:"",showindex:0,internship:200,backbone:56,superteacher:34,awardList:[{name:"李老师",age:"26",title:"特级教师",award:"XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX"},{name:"李老师",age:"26",title:"特级教师",award:"XXXXXXXXXXXXXXXXXXXXXX"},{name:"李老师",age:"26",title:"特级教师",award:"XXXXXXXXXXXXXXXXXXXXXX"},{name:"李老师",age:"26",title:"特级教师",award:"XXXXXXXXXXXXXXXXXXXXXX"}],men:4567,women:5467,menList:[300,450,550,660,860,970,1690],womenList:[699,805,1022,2133,3143,4153,5167],studentList:[{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"},{name:"阿湫",area:"四川",gender:"男",nation:"汉",college:"制造学院",stuclass:"制造2201"}]}},created(){setTimeout((()=>{}),1e3),this.loading=!0},computed:{},mounted(){this.getPieData(),this.getCategory(),this.initLiquidEchart(),this.getStudent(),this.getPieData2(),this.getPieData3(),this.getBarData()},methods:{select(e){this.activeNum=e},getEchartData(){let e=this.$echarts.init(document.getElementById("chart"));var t={dataZoom:[{type:"inside",xAxisIndex:0,startValue:0,endValue:4}],tooltip:{trigger:"axis",axisPointer:{lineStyle:{color:"#dddc6b"}}},legend:{left:10,top:15,itemWidth:12,itemHeight:8,data:["用量","消耗"],textStyle:{color:"rgba(255,255,255,1)",fontSize:10}},grid:{left:"1%",top:"15%",right:"0%",bottom:"13%",containLabel:!0},xAxis:{type:"category",data:[2016,2017,2018,2019,2020,2021,2022],axisTick:{show:!1},axisLine:{lineStyle:{color:"#1BB3D9"}}},yAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},series:[{name:"学生",type:"bar",data:[99,105,122,133,143,153,167],smooth:!0,symbol:"circle",barWidth:15,barGap:"100%",lineStyle:{normal:{color:"#0184d5",width:"2px"}},itemStyle:{normal:{color:"rgb(1,132,213,1)",borderColor:"rgba(221, 220, 107, .1)",borderWidth:"12px"}},label:{show:!0,position:"top",fontSize:"8"}},{name:"老师",type:"bar",data:[66,73,85,99,113,125,130],smooth:!0,symbol:"circle",barWidth:15,barGap:"80%",symbolSize:"5px",showSymbol:!1,lineStyle:{normal:{color:"#00d887",width:"2px"}},itemStyle:{normal:{color:"rgb(0,216,135,1)",borderColor:"rgba(221, 220, 107, .1)",borderWidth:"12px"}},label:{show:!0,position:"top",fontSize:"8"}}],textStyle:{color:"#fff"}};t&&e.setOption(t),window.addEventListener("resize",(()=>{e.resize()}),!1),setInterval((()=>{t.dataZoom[0].endValue==t.series[0].data.length-1?(t.dataZoom[0].endValue=4,t.dataZoom[0].startValue=0):(t.dataZoom[0].endValue=t.dataZoom[0].endValue+1,t.dataZoom[0].startValue=t.dataZoom[0].startValue+1),e.setOption(t)}),3e3)},getPieData(){let e=this.$echarts.init(document.getElementById("pie"));var t;const a=[{value:2,name:"高炉"},{value:2,name:"转炉"},{value:2,name:"煤气柜"},{value:4,name:"连铸机"},{value:7,name:"吊运熔融金属起重机"},{value:98,name:"熔融金属罐体"},{value:73,name:"煤气设施（管道）眼镜阀组合式隔断装置"},{value:94,name:"正压煤气管道水封式煤气排水器"},{value:717,name:"固定式一氧化碳报警器"}];t={tooltip:{trigger:"item",position:"right",formatter:"{b}</br>: {c} ({d}%)",textStyle:{fontSize:12}},series:[{name:"设备数量",type:"pie",avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"12",fontWeight:"bold"}},labelLine:{show:!1},data:a,color:["rgb(27,241,236)","rgb(134,90,249)","rgb(255,183,77)","rgb(255,77,77)","rgb(77,255,77)","rgb(77,183,255)","rgb(255,77,255)","rgb(183,77,255)","#399bff"]}]},t&&e.setOption(t),window.addEventListener("resize",(()=>{e.resize()}),!1)},getCategory(){let e=this.$echarts.init(document.getElementById("category"));var t;t={grid:{top:"25%",right:"1%",bottom:"18%",left:"11%"},xAxis:{type:"category",boundaryGap:!1,data:this.year,axisTick:{show:!1},axisLine:{lineStyle:{color:"#9B9D9D"}},axisLabel:{rotate:20,fontSize:j(14)}},yAxis:{type:"value",name:"数量（次）",nameTextStyle:{padding:[0,0,j(12),-j(12)],fontSize:j(14)},max:3e3,interval:500,splitLine:{lineStyle:{type:"dashed",color:"rgb(255,255,255,0.1)"}},axisTick:{show:!1},axisLine:{show:!1},axisLabel:{fontSize:j(14)}},series:[{data:[600,1500,1e3,1700,1400,1900,2e3],type:"line",lineStyle:{width:2,color:"rgb(50,77,183)"},areaStyle:{color:{type:"linear",x:0,y:0,x2:0,y2:1,colorStops:[{offset:0,color:"rgba(50,77,183,0.8)"},{offset:1,color:"rgba(50,77,183,0)"}],global:!1}},itemStyle:{normal:{color:"#0184d5",borderColor:"rgba(221, 220, 107, .1)",borderWidth:8}}}],textStyle:{color:"#fff"}},t&&e.setOption(t),window.addEventListener("resize",(()=>{e.resize()}),!1),console.log("area",this.area);let a=0;setInterval((()=>{a==this.area.length-1?(a=0,t.series[0].data=this.area[a],this.thismajor=this.major[a]):(a+=1,t.series[0].data=this.area[a],this.thismajor=this.major[a]),e.setOption(t)}),3e3)},initLiquidEchart(){var e=this.$echarts.init(document.getElementById("liquidEchart"));e.setOption({series:[{type:"liquidFill",label:{normal:{formatter:"上线监控总数\n5台",textStyle:{fontSize:j(14),color:"rgb(255,255,255,0.7)"}}},data:[.7,.5,.4],outline:{borderDistance:0,itemStyle:{borderWidth:0}},backgroundStyle:{color:"rgba(69,96,130,0.5)",itemStyle:{shadowBlur:100,shadowColor:"#f60",opacity:1}},itemStyle:{opacity:.5,shadowBlur:10,shadowColor:"rgb(33,116,186,0.5)"},emphasis:{itemStyle:{opacity:1}},color:["rgb(179,229,252)","rgb(6,147,227)","rgb(187,222,251)"],shape:"circle",center:["50%","50%"],radius:"80%",amplitude:3,waveLength:"50%",phase:0,period:(e,t)=>2e3*t,direction:"left",waveAnimation:!0,animationEasing:"linear",animationEasingUpdate:"quarticInOut",animationDuration:3e3,animationDurationUpdate:300}]})},getStudent(){let e=this.$echarts.init(document.getElementById("studntDetails")),t=this;var a;a={grid:{top:"10%",left:"6%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"value",boundaryGap:[0,.01],axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},yAxis:[{type:"category",data:["炼铁厂","炼钢厂","石灰厂","渣厂"],inverse:!0,axisLine:{show:!1},axisTick:{show:!1},axisLabel:{color:"#fff",fontSize:j(14)}},{type:"category",data:[4,1,0,0],inverse:!0,axisTick:{alignWithLabel:!0,show:!1},axisLabel:{color:"#fff",fontSize:j(14)},axisLine:{show:!1},position:"right"}],series:[{name:"",type:"bar",yAxisIndex:0,label:{show:!1},itemStyle:{color:"rgb(111,109,109,.2)"},barWidth:"40%"},{name:"",type:"bar",yAxisIndex:1,data:[4,1,0,0],label:{show:!1},barWidth:"40%",itemStyle:{normal:{color:function(e){var a=[["#124F77","#1A959C"],["#F63737","#F6B937"],["#77A1F7","#9377F7"],["#F7778C","#F777C8"]],i=a[e.dataIndex];return new t.$echarts.graphic.LinearGradient(0,0,1,0,[{offset:0,color:i[0]},{offset:1,color:i[1]}],!1)}}}}]},a&&e.setOption(a),window.addEventListener("resize",(()=>{e.resize()}),!1)},getPieData2(){let e=this.$echarts.init(document.getElementById("pie2"));var t;t={series:[{name:" ",type:"pie",radius:["73%","85%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!1,fontSize:"20",fontWeight:"bold"}},labelLine:{show:!1},data:[{value:1567,name:"满勤"},{value:121,name:"迟到"},{value:500,name:"早退"}],color:["#03FFB1","#F8B700","#FF5A66"]}]},t&&e.setOption(t),window.addEventListener("resize",(()=>{e.resize()}),!1);let a=0;setInterval((()=>{a==this.late.length-1?(a=0,t.series[0].data[0].value=this.fullAttendance[a],t.series[0].data[0].name="满勤",t.series[0].data[1].value=this.late[a],t.series[0].data[1].name="迟到",t.series[0].data[2].value=this.leaveEarly[a],t.series[0].data[2].name="早退",this.showindex=a,this.thisFullAttendance=this.fullAttendance[a],this.thisLate=this.late[a],this.thisLeaveEarly=this.leaveEarly[a]):(a+=1,t.series[0].data[0].value=this.fullAttendance[a],t.series[0].data[0].name="满勤",t.series[0].data[1].value=this.late[a],t.series[0].data[1].name="迟到",t.series[0].data[2].value=this.leaveEarly[a],t.series[0].data[2].name="早退",this.showindex=a,this.thisFullAttendance=this.fullAttendance[a],this.thisLate=this.late[a],this.thisLeaveEarly=this.leaveEarly[a]),e.setOption(t)}),3e3)},getPieData3(){let e=this.$echarts.init(document.getElementById("pie3"));var t;t={series:[{name:" ",type:"pie",radius:["55%","65%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!1,fontSize:"20",fontWeight:"bold"}},labelLine:{show:!1},data:[{value:this.men,name:"男生"},{value:this.women,name:"女生"}],color:["rgb(27,241,236)","rgb(134,90,249)"]}]},t&&e.setOption(t),window.addEventListener("resize",(()=>{e.resize()}),!1)},getBarData(){let e=this.$echarts.init(document.getElementById("bar"));var t={color:["#20E2E9","#00d887"],dataZoom:[{type:"inside",xAxisIndex:0,startValue:0,endValue:4}],tooltip:{trigger:"axis",axisPointer:{lineStyle:{color:"#dddc6b"}}},legend:{left:10,top:15,itemWidth:12,itemHeight:8,data:["男生","女生"],textStyle:{color:"rgba(255,255,255,1)",fontSize:10}},grid:{left:"1%",top:"15%",right:"0%",bottom:"13%",containLabel:!0},xAxis:{type:"category",data:[2016,2017,2018,2019,2020,2021,2022],axisTick:{show:!1},axisLine:{lineStyle:{color:"#1BB3D9"}}},yAxis:{axisLine:{show:!1},axisTick:{show:!1},axisLabel:{show:!1},splitLine:{show:!1}},series:[{name:"男生",type:"bar",data:this.menList,smooth:!0,symbol:"circle",barWidth:15,barGap:"100%",lineStyle:{normal:{color:"#20E2E9",width:"2px"}},itemStyle:{normal:{borderColor:"rgba(221, 220, 107, .1)",borderWidth:"12px",color:new this.$echarts.graphic.LinearGradient(0,1,0,0,[{offset:0,color:"rgb(27, 207, 217, 0.1)"},{offset:1,color:"rgb(32, 226, 233, 1)"}],!1)}},label:{show:!0,position:"top",fontSize:"8"}},{name:"女生",type:"bar",data:this.womenList,smooth:!0,symbol:"circle",barWidth:15,barGap:"80%",symbolSize:"5px",showSymbol:!1,lineStyle:{normal:{color:"#00d887",width:"2px"}},itemStyle:{normal:{borderColor:"rgba(221, 220, 107, .1)",borderWidth:"12px",color:new this.$echarts.graphic.LinearGradient(0,1,0,0,[{offset:0,color:"rgb(137, 88, 255, 0)"},{offset:1,color:"rgb(137, 88, 255, 1)"}],!1)}},label:{show:!0,position:"top",fontSize:"8"}}],textStyle:{color:"#fff"}};t&&e.setOption(t),window.addEventListener("resize",(()=>{e.resize()}),!1),setInterval((()=>{t.dataZoom[0].endValue==t.series[0].data.length-1?(t.dataZoom[0].endValue=4,t.dataZoom[0].startValue=0):(t.dataZoom[0].endValue=t.dataZoom[0].endValue+1,t.dataZoom[0].startValue=t.dataZoom[0].startValue+1),e.setOption(t)}),3e3)}}},q=B,X=(0,w.A)(q,o,l,!1,null,null,null),H=X.exports,G=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login-container"},[t("el-card",{staticClass:"login-card",attrs:{shadow:"always"}},[t("h2",{staticClass:"login-title"},[e._v("欢迎登录秦邮企业安全风险预警系统")]),t("el-form",{ref:"formRef",attrs:{model:e.form,rules:e.rules,"label-width":"0.85rem"}},[t("el-form-item",{attrs:{label:"账号",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入账号",clearable:""},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码",clearable:""},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),t("el-form-item",[t("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary",loading:e.loading,block:""},on:{click:e.handleLogin}},[e._v(" 登录 ")])],1)],1)],1)],1)},K=[],Z=a(47149),Q=a(95152),Y=a(89143),ee=a(27496),te=a(41325),ae={name:"Login",data(){return{form:{username:"",password:"",rememberMe:!1,code:"qinyouwatch2024",uuid:""},loading:!1,rules:{username:[{required:!0,message:"请输入账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}}},mounted(){(0,d.eF)("Admin-Token"),(0,d.eF)("Report-Token")},methods:{buildTree(e){const t={};e.forEach((e=>{t[e.id]={...e,children:[]}}));const a=[];return e.forEach((e=>{null!==e.parentId&&t[e.parentId]?t[e.parentId].children.push(t[e.id]):a.push(t[e.id])})),a},async generateRoutes(){const e=await(0,Q.z9)();if(200===e.code){let t=[],i=this.buildTree(e.rows);i.map(((e,a)=>{t[a]={name:e.plant,index:e.plant,children:[]},t[a].children=e.children.map((e=>({name:e.name,path:`/videomonit/bottle/${e.id}`})))})),console.log(t);const s=[];return t.forEach((e=>{let t={path:e.index,name:e.name,component:()=>Promise.resolve().then(a.bind(a,41325)),children:[]};e.children?e.children.forEach((e=>{t.children.push({path:e.path,name:e.name,component:()=>Promise.resolve().then(a.bind(a,27496)),props:e=>({name:e.params.name})})})):t={path:e.path,name:e.name,component:()=>Promise.resolve().then(a.bind(a,41325))},s.push(t)})),console.log(s),this.$store.commit("viedomenu",s),xr(s),t}return Y.Message.error("获取视频站点信息失败，请刷新重试"),[]},async handleLogin(){this.$refs.formRef.validate((async e=>{if(!e)return this.$message.error("表单验证失败"),!1;this.loading=!0;try{const e=await(0,Z.iD)(this.form.username,this.form.password,this.form.code,this.form.uuid);200===e.code?((0,d.WG)("Admin-Token",e.token),await this.generateRoutes(),this.$store.commit("haslogin"),this.$message.success("登录成功"),this.$router.push("/index")):this.$message.error("账号或密码错误")}catch(t){this.$message.error("登录失败，请稍后再试"),console.error("Login request failed:",t)}finally{this.loading=!1}}))}}},ie=ae,se=(0,w.A)(ie,G,K,!1,null,"984feb06",null),oe=se.exports,le=function(){var e=this,t=e._self._c;return t("div",{staticClass:"menu"},[t("headmenu"),t("el-container",{staticStyle:{height:"100vh"}},[t("el-container",[t("el-aside",{staticClass:"ele_aside",staticStyle:{position:"relative"}},[t("el-tooltip",{staticClass:"item",attrs:{content:"返回首页",placement:"top-start"}},[t("div",{staticStyle:{color:"#5bc0de",position:"absolute",right:"0.7rem",top:"0rem",cursor:"pointer","font-weight":"bold"},on:{click:e.backIndex}},[t("i",{staticClass:"el-icon-d-arrow-left",staticStyle:{"font-weight":"bold"}}),t("span",[e._v(" 首页 ")])])]),t("el-menu",{staticClass:"sidebar-menu",attrs:{"default-active":e.activeSubMenu}},[e._l(e.subMenuItems,(function(a){return[a.children&&a.children.length?e._e():t("el-menu-item",{key:a.index?a.index:a.path,staticClass:"sub_menu",attrs:{index:a.index?a.index:a.path},on:{click:function(t){return e.handleLeftMenuSelect(a.index?a.index:a.path)}}},[e._v(" "+e._s(a.name)+" ")]),a.children&&a.children.length?t("el-submenu",{key:a.index,attrs:{index:a.index},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"menu_subtitle",style:{background:e.curr_videoname==a.name?"#335984c9":""},on:{click:function(t){return e.videoClick(a)}}},[e._v(" "+e._s(a.name)+" ")])]},proxy:!0}],null,!0)},e._l(a.children,(function(a){return a.children&&a.children.length?t("el-submenu",{key:a.index,staticStyle:{"margin-left":"0.15rem"},attrs:{index:a.index},scopedSlots:e._u([{key:"title",fn:function(){return[t("div",{staticClass:"menu_subtitle",style:{background:e.curr_videoname==a.name?"#335984c9":""},on:{click:function(t){return e.videoClick(a)}}},[e._v(" "+e._s(a.name)+" ")])]},proxy:!0}],null,!0)},e._l(a.children,(function(a){return t("el-menu-item",{key:a.path,staticClass:"sub_menu",attrs:{index:a.path},on:{click:function(t){return e.handleLeftMenuSelect(a.path)}}},[e._v(" "+e._s(a.name)+" ")])})),1):t("el-menu-item",{key:a.path,staticClass:"sub_menu",attrs:{index:a.path},on:{click:function(t){return e.handleLeftMenuSelect(a.path)}}},[e._v(" "+e._s(a.name)+" ")])})),1):e._e()]}))],2)],1),t("el-main",[t("router-view")],1)],1)],1)],1)},re=[],ne={components:{headmenu:z,Navbar:r.A},data(){return{activeRoute:"/basicinfo",activeSubMenu:"/basicinfo/introduction",topMenuItems:[{name:"首页",path:"/"},{name:"基础信息",path:"/basicinfo"},{name:" ",path:" "},{name:"感知数据",path:"/datashow"},{name:"视频监控",path:"/videomonit"}],subMenuItems:[],currentitle:"",allMenu:{"基础信息":[{name:"企业基础信息",index:"/basicinfo/introduction"},{name:"企业自动化系统建设",index:"/basicinfo/autocompany"},{name:"企业专项信息",index:"/basicinfo/personalrecord"},{name:"设施设备信息",index:"/deviceinfo",children:[{name:"高炉",path:"/basicinfo/deviceinfo/devicetallbottle"},{name:"转炉",path:"/basicinfo/deviceinfo/devicerotatebottle"},{name:"煤气柜",path:"/basicinfo/deviceinfo/gasbox"},{name:"连铸机",path:"/basicinfo/deviceinfo/devicecontinuous"},{name:"吊运熔融金属起重机",path:"/basicinfo/deviceinfo/deviceHangmachine"},{name:"熔融金属罐体",path:"/basicinfo/deviceinfo/devicemoltentanl"},{name:"煤气设施（管道）眼镜阀组合式隔断装置",path:"/basicinfo/deviceinfo/glassgasdevice"},{name:"正压煤气管道水封式煤气排水器",path:"/basicinfo/deviceinfo/gasdrainerdevice"},{name:"固定式一氧化碳报警器",path:"/basicinfo/deviceinfo/deviceCowarnning"},{name:"炼钢（连铸）生产过程熔融金属紧急排放和应急储存设施",path:"/basicinfo/deviceinfo/deviceEmergencyfac"},{name:"高炉生产过程炉顶放散阀联锁放散压力设定",path:"/basicinfo/deviceinfo/devicereliefset"}]},{name:"企业日常数据",index:"/companydaily",children:[{name:"点检记录",path:"/basicinfo/companydaily/checkout"},{name:"定期检验/校准记录",path:"/basicinfo/companydaily/regularcheck"},{name:"设备停用记录",path:"/basicinfo/companydaily/stopwork"},{name:"设备报废记录",path:"/basicinfo/companydaily/scrabwork"}]}],"视频监控":[{name:"炼铁厂",index:"/videomonit",children:[{name:"高炉",path:"/videomonit/bottle/bottletall"}]},{name:"炼钢厂",index:"/control",children:[{name:"转炉",path:"/services/consulting"},{name:"连铸",path:"/services/development"}]},{name:"石灰厂",index:"/car",children:[{name:"气柜车间",path:"/services/consulting"}]},{name:"制氧厂",index:"/exprience",children:[{name:"氧气球罐",path:"/services/consulting"}]}],"感知数据":[{name:"感知数据",index:"/datashow",children:[{name:"高炉",path:"/datashow/highbottleshow"},{name:"1#转炉",path:"/datashow/rotatebottleshow"},{name:"2#转炉",path:"/datashow/rotatebottleshowtwo"},{name:"煤气柜",path:"/datashow/gasboxshow"},{name:"液氧储槽",path:"/datashow/oxgenshow"},{name:"固定式一氧化碳报警器",path:"/datashow/cowarning"}]},{name:"报警信息",index:"/datashow/warning"}]},curr_videoname:""}},methods:{backIndex(){this.$router.push("/index")},videoClick(e){},handleLeftMenuSelect(e){this.curr_videoname="",this.$route.path!==e&&(this.activeSubMenu=e,this.$router.push(e))},buildTree(e){const t={};e.forEach((e=>{t[e.id]={...e,children:[]}}));const a=[];return e.forEach((e=>{null!==e.parentId&&t[e.parentId]?t[e.parentId].children.push(t[e.id]):a.push(t[e.id])})),a},generateSubMenuitems(e){const t=[];let a=this.buildTree(e);return a.map(((e,a)=>{t[a]={name:e.plant,index:e.plant,children:[]},t[a].children=e.children.map((e=>({name:e.name,path:`/videomonit/bottle/${e.id}`})))})),t},changeMenu(){switch(!0){case this.$route.path.indexOf("/basicinfo")>=0:this.subMenuItems=this.allMenu["基础信息"];break;case this.$route.path.indexOf("/datashow")>=0:this.subMenuItems=this.allMenu["感知数据"];break}this.activeSubMenu=this.$route.path}},computed:{activeIndex(){return this.$route.path}},watch:{activeIndex(e,t){this.changeMenu(),(e.indexOf("/videomonit")>=0&&t.indexOf("/videomonit")<0||e.indexOf("/warningvideo")>=0)&&(0,Q.z9)().then((e=>{this.subMenuItems=this.generateSubMenuitems(e.rows)}))}},mounted(){this.changeMenu(),(this.$route.path.indexOf("/videomonit")>=0||this.$route.path.indexOf("/warningvideo")>=0)&&(0,Q.z9)().then((e=>{200==e.code?(this.subMenuItems=this.generateSubMenuitems(e.rows),this.videoClick(this.subMenuItems[0])):(this.$message({type:"warning",message:"登录已过期,自动重新登录",showClose:!0}),setTimeout((()=>{this.$router.push("/")}),2e3))}))}},ce=ne,de=(0,w.A)(ce,le,re,!1,null,null,null),he=de.exports,pe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content"},[t("router-view"),t("div",{staticStyle:{width:"50%","text-align":"center",position:"absolute",bottom:"0.1rem"}},[t("Navbar")],1)],1)},ge=[],ue={components:{Navbar:r.A}},me=ue,fe=(0,w.A)(me,pe,ge,!1,null,null,null),we=fe.exports,be=function(){var e=this,t=e._self._c;return t("div",{staticClass:"introdunction"},[t("div",{staticClass:"base_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788)}}):e._e(),t("div",{staticStyle:{padding:"0.3rem","padding-top":"0.15rem","overflow-y":"auto",height:"calc(100% - 0.02rem)"}},[e._l(e.companyinfo,(function(a,i){return"ID"!=i&&"key"!=i&&!e.loading&&e.showinfo.indexOf(i)>=0?t("el-row",{key:i,staticClass:"introcontent"},[t("el-col",{staticClass:"name",attrs:{span:5}},[e._v(e._s(e.show_list[i]))]),t("el-col",{staticClass:"value",attrs:{span:16}},[e.format_info.indexOf(i)>=0?t("span",[e._v(e._s(e.format_show(i,a)))]):t("span",[e._v(e._s(a))])])],1):e._e()})),t("div",{staticClass:"echarts-foot"}),t("div",[t("el-button",{staticClass:"editIntroduction",attrs:{type:"text"},on:{click:e.editinfo}},[e._v("编辑")]),t("el-button",{staticClass:"editReport",staticStyle:{"margin-left":"5px"},attrs:{type:"primary"},on:{click:e.reportinfo}},[e._v("上报")])],1),e.loading?e._e():t("Editbasicinfo",{ref:"editbasicinfo",attrs:{editrow:e.companyinfo,show_list:e.show_list,showinfo:e.showinfo,productionMode:e.productionMode,administrativeSubOrdination:e.administrativeSubOrdination,registrationType:e.registrationType,companyScale:e.companyScale},on:{editIntroduction:e.editIntroduction}})],2)])])},ve=[],ye=a(40412),_e=a(46002),Se=function(){var e=this,t=e._self._c;return t("el-dialog",{attrs:{title:"修改",visible:e.addRowDialogVisible,modal:!1,top:"0.8rem"},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[e.addRowDialogVisible?t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.newRow,(function(a,i){return"ID"!=i&&"key"!=i&&e.showinfo.indexOf(i)>=0?t("el-form-item",{key:i,attrs:{rules:[{required:!0}],label:e.show_list[i],prop:i}},["营业状态"==e.show_list[i]?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[i],callback:function(t){e.$set(e.newRow,i,t)},expression:"newRow[index]"}},[t("el-option",{attrs:{label:"营业",value:"1"}}),t("el-option",{attrs:{label:"停业",value:"2"}}),t("el-option",{attrs:{label:"关闭",value:"3"}})],1):e._e(),"productionMode"==i?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[i],callback:function(t){e.$set(e.newRow,i,t)},expression:"newRow[index]"}},e._l(e.productionMode,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"administrativeSubOrdination"==i?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[i],callback:function(t){e.$set(e.newRow,i,t)},expression:"newRow[index]"}},e._l(e.administrativeSubOrdination,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),"registrationType"==i?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[i],callback:function(t){e.$set(e.newRow,i,t)},expression:"newRow[index]"}},e._l(e.registrationType,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),"companyScale"==i?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[i],callback:function(t){e.$set(e.newRow,i,t)},expression:"newRow[index]"}},e._l(e.companyScale,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),"工艺类型"==e.show_list[i]?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[i],callback:function(t){e.$set(e.newRow,i,t)},expression:"newRow[index]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),"enterpriseEquipment"==i?t("div",[t("el-checkbox",{attrs:{indeterminate:e.isIndeterminate1},on:{change:e.handleCheckAllChange1},model:{value:e.checkAll1,callback:function(t){e.checkAll1=t},expression:"checkAll1"}},[e._v("全选")]),t("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange1},model:{value:e.newRow["enterpriseEquipment"],callback:function(t){e.$set(e.newRow,"enterpriseEquipment",t)},expression:"newRow['enterpriseEquipment']"}},e._l(e.checkdata1,(function(a){return t("el-checkbox",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"topbvCommitmentletter"==i||"facilitiesCommitmentletter"==i?t("div",[e.newRow[i]?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[i]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(i)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2,referType:"topbvCommitmentletter"==i?"2":"1"},on:{imageshow:t=>e.imageshowFunc(t,i),imgrelativeId:t=>e.imgrelativeId(i,t)}})],1):e._e(),"主营业务"==i?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a,type:"textarea",rows:5},model:{value:e.newRow[i],callback:function(t){e.$set(e.newRow,i,t)},expression:"newRow[index]"}}):"营业状态"!=e.show_list[i]&&"productionMode"!=i&&"administrativeSubOrdination"!=i&&"registrationType"!=i&&"companyScale"!=i&&"productionProcess"!=i&&"enterpriseEquipment"!=i&&"topbvCommitmentletter"!=i&&"facilitiesCommitmentletter"!=i?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a},model:{value:e.newRow[i],callback:function(t){e.$set(e.newRow,i,t)},expression:"newRow[index]"}}):e._e()],1):e._e()})),1)],1):e._e(),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:e.editrowFunc}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)])},De=[],Re=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{display:"inline-block"}},[t("el-upload",{attrs:{action:e.uploadUrl,name:"file","on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.beforeUpload,"http-request":e.customRequest,"show-file-list":!1,accept:".png,.jpg"}},[t("i",{staticClass:"el-icon-upload2 download"}),e.loading?t("img",{staticClass:"loadgif",staticStyle:{width:"0.3rem"},attrs:{src:a(18788)}}):e._e(),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传 jpg/png/jpeg 文件，且不超过 500kb ")])])],1)},ke=[],$e=a(94373),Ce={props:["referType"],data(){return{uploadUrl:"/api/function/upload",loading:!1,fileId:"",action_flag:!1}},methods:{async beforeUpload(e){const t=["png","jpg"],a=e.name.split(".").pop().toLowerCase();if(!t.includes(a))return this.$message.warning("只能上传 jpg/png 格式的文件！"),!1;const i=e.size/1024<=500;if(!i)return this.$message.warning("文件大小不能超过 500kb！"),!1;try{await this.$confirm("确定上传文件？","提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"});const e=await _e.A.getReportId();return 200===e.data.code?(this.fileId=e.data.data,this.loading=!0,this.action_flag=!0,!0):(this.$message.error("获取文件 ID 失败："+e.data.message),this.action_flag=!1,!1)}catch(s){return this.$message.info("取消上传"),console.log("不上传"),this.action_flag=!1,!1}},customRequest({file:e}){if(this.action_flag){const t=new FormData,a=e.name.split(".").pop(),i=new File([e],`${this.fileId}.${a}`,{type:e.type});t.append("file",i),t.append("relativeId",this.fileId),t.append("referType",this.referType),console.log(t),$e.A.post(this.uploadUrl,t,{headers:{"Content-Type":"multipart/form-data"}}).then((e=>{console.log(e.data),200==e.data.code?(this.handleSuccess(e.data),this.$emit("imageshow",e.data.url)):this.handleError(e.data.message)})).catch((e=>{this.handleError(e)}))}},handleSuccess(e){this.loading=!1,this.$message.success("文件上传成功！"),console.log("文件上传成功：",e)},handleError(e){this.loading=!1,this.$message.error("文件上传失败："),console.error("上传失败：",e)}}},xe=Ce,Ie=(0,w.A)(xe,Re,ke,!1,null,null,null),Ae=Ie.exports,ze={props:["editrow","numberinfo","show_list","showinfo","productionMode","administrativeSubOrdination","registrationType","companyScale"],data(){return{addRowDialogVisible:!1,rules_data:{},loadingbtn:!1,newRow:{},deviceKind:[{label:"长流程",value:"1"},{label:"短流程",value:"2"}],isIndeterminate1:!0,checkdata1:["高炉","转炉","AOD精炼炉","LF精炼炉","VOD精炼炉","CAS精炼炉","IR精炼炉","RH精炼炉","电弧炉","Consteel炼钢炉","一氧化碳浓度报警器"],checkedData1:[],checkAll1:!1,showloading2:"show_loading2"}},components:{Uploadocom:Ae},methods:{showImg(e){console.log(e),_e.A.getFile({relativeId:e}).then((e=>(console.log(e.data),e.data)))},imgrelativeId(e,t){this.newRow[e]=t,console.log(this.newRow[e])},cancelImg(e){console.log(this.newRow[e]),_e.A.deleteuploadFile({id:this.newRow[e]}).then((e=>(console.log(e.data),e.data))),this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},handleCheckAllChange1(e){this.newRow["enterpriseEquipment"]=e?this.checkdata1:[],this.isIndeterminate1=!1},handleCheckedCitiesChange1(e){let t=e.length;this.checkAll1=t===this.checkdata1.length,this.isIndeterminate1=t>0&&t<this.checkdata1.length},editrowFunc(){this.$refs.newRow.validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("editIntroduction",this.newRow)}))},resetform(){this.addRowDialogVisible=!1},formatRow(){this.newRow=JSON.parse(JSON.stringify(this.editrow)),this.newRow.hasOwnProperty("productionProcess")&&(this.newRow["enterpriseEquipment"]=this.editrow["enterpriseEquipment"].split("|"))}},mounted(){}},Oe=ze,Te=(0,w.A)(Oe,Se,De,!1,null,null,null),Ve=Te.exports,Pe={data(){return{loading:!0,companyinfo:{},showinfo:["enterpriseName","productionMode","administrativeSubOrdination","registrationType","registrationAddress","addressOperating","legalRepresentative","areaCode","contactNumber","safetyProductionManagementName","safetyProductionManagementNumbe","opScope","companyScale","businessStatus","mainProduct","uniscid","longitude","latitude"],show_list:{enterpriseName:"企业名称",productionMode:"生产经营方式",uniscid:"统一社会信用代码",administrativeSubOrdination:"行政隶属关系",registrationType:"国民经济类型",registrationAddress:"注册地址",addressOperating:"经营地址",legalRepresentative:"实际控制人",areaCode:"行政区域编码",contactNumber:"实际控制人电话",safetyProductionManagementName:"安全生产管理负责人",safetyProductionManagementNumbe:"安全生产管理负责人电话",opScope:"主营业务",companyScale:"企业规模",businessStatus:"营业状态",longitude:"经度",latitude:"纬度",mainProduct:"主要产品"},businessStatus:["营业","停业","关闭"],productionMode:["生产（制造）","批发经营","零售经营","储存","使用","其他"],administrativeSubOrdination:["中央级","省级","地市级","区县级"],registrationType:["国有","集体联营","私营","有限责任","股份有限","股份合作","港澳台","外商投资","分公司","其他"],companyScale:["规上","规下"],format_info:["businessStatus","productionMode","administrativeSubOrdination","registrationType","companyScale"]}},components:{Editbasicinfo:Ve},computed:{},methods:{format_show(e,t){return this[e]&&this[e].find((e=>e.value==t))?this[e].find((e=>e.value==t)).label:t},cancelImg(e){this.newRow[e]=""},reportinfo(){this.$functionConfrim(this.companyinfo).then((e=>{console.log(e),"yes"==e.status&&_e.A.reportCompany({id:e.value.id}).then((e=>{2e3==e.data.code?this.$message.success("上报成功！"):this.$message.error("上报失败！"+e.data.msg)}))}))},editinfo(){this.$refs.editbasicinfo.addRowDialogVisible=!0,this.$refs.editbasicinfo.formatRow()},editIntroduction(e){console.log(e),this.$refs.editbasicinfo.loadingbtn=!0,delete e.ID,delete e.key;let t=JSON.parse(JSON.stringify(e));_e.A.updateCompany(t).then((e=>{console.log(e.data),200==e.data.code?(this.$message({message:"修改成功",type:"success"}),this.$refs.editbasicinfo.addRowDialogVisible=!1,this.$refs.editbasicinfo.loadingbtn=!1,this.getData()):this.$message({message:"修改失败！",type:"error"})})).catch((e=>{this.$message({message:"网络错误！修改失败！",type:"error"}),this.$refs.editbasicinfo.addRowDialogVisible=!1,this.$refs.editbasicinfo.loadingbtn=!1,this.getData()}))},getData(){this.loading=!0,_e.A.readCompany().then((e=>{console.log(e.data),200==e.data.code?this.companyinfo=e.data.data:this.$message({message:"网络错误！查询失败！",type:"error"}),this.loading=!1})).catch((e=>{this.loading=!1}))},formatData(){this.businessStatus=this.businessStatus.map(((e,t)=>({label:e,value:(t+1).toString()}))),this.productionMode=this.productionMode.map(((e,t)=>({label:e,value:(t+1).toString()}))),this.administrativeSubOrdination=this.administrativeSubOrdination.map(((e,t)=>({label:e,value:(t+1).toString()}))),this.registrationType=this.registrationType.map(((e,t)=>({label:e,value:(t+1).toString()}))),this.companyScale=this.companyScale.map(((e,t)=>({label:e,value:(t+1).toString()})))}},mounted(){this.getData(),this.formatData()}},Fe=Pe,Ne=(0,w.A)(Fe,be,ve,!1,null,null,null),je=Ne.exports,We=function(){var e=this,t=e._self._c;return t("div",{staticClass:"introdunction"},[t("div",{staticClass:"base_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788)}}):e._e(),t("div",{staticStyle:{padding:"0.3rem","padding-top":"0.15rem","overflow-y":"auto",height:"calc(100% - 0.02rem)"}},[e._l(e.companyinfo,(function(a,i){return"ID"!=i&&"key"!=i&&!e.loading&&e.showinfo.indexOf(i)>=0?t("el-row",{key:a,staticClass:"introcontent personalrecord"},[t("el-col",{staticClass:"name",attrs:{span:12}},[e._v(e._s(e.show_list[i]))]),t("el-col",{staticClass:"value",attrs:{span:7}},["企业应有的设备设施类型"!=e.show_list[i]&&e.show_list[i].indexOf("承诺书")<0?t("span",["工艺类型"==e.show_list[i]?t("span",[e._v(" "+e._s(1==a?"长流程":"短流程")+" ")]):t("span",[e._v(" "+e._s(a)+" ")])]):e.show_list[i].indexOf("承诺书")<0?t("span",[e._v(" "+e._s(a.replaceAll("|","、"))+" ")]):e._e(),e.show_list[i].indexOf("承诺书")>=0?t("span",[t("img",{staticStyle:{width:"2rem"},attrs:{src:a},on:{click:function(t){return e.showbigimg(a)}}})]):e._e()])],1):e._e()})),t("div",{staticClass:"echarts-foot"}),t("el-button",{staticClass:"editIntroduction",attrs:{type:"text"},on:{click:e.editinfo}},[e._v("编辑")]),t("el-button",{staticClass:"editReport",attrs:{type:"primary"},on:{click:e.reportinfo}},[e._v("上报")]),e.loading?e._e():t("Editbasicinfo",{ref:"editbasicinfo",attrs:{editrow:e.companyinfo,numberinfo:["粗钢(粗铁)设计产能(万吨/年)","公司范围内煤气主输配管道长度(km)","金属冶炼单元从业人员总数（分厂内部员工、生产劳务人员，不含检维修外包人员）"],showinfo:e.showinfo,show_list:e.show_list},on:{editIntroduction:e.editIntroduction}})],2),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])])],1)])},Me=[],Le={data(){return{loading:!0,companyinfo:{},imgdialog:!1,currimgsrc:!1,showinfo:["metalsmeltingWorkerNumber","gaspipelineLength","productionCapacity","productionProcess","facilitiesCommitmentletter","topbvCommitmentletter","enterpriseEquipment"],show_list:{gaspipelineLength:"企业内部煤气输配管道长度(km)",productionCapacity:"粗钢设计产能(万吨/年)",productionProcess:"工艺类型",facilitiesCommitmentletter:"炼钢连铸（模铸）生产过程熔融金属紧急排放和应急储存设施承诺书",topbvCommitmentletter:"高炉炉顶放散阀联锁放散压力值设定承诺书",enterpriseEquipment:"企业应有的设备设施类型",metalsmeltingWorkerNumber:"金属冶炼单元从业人员总数"}}},components:{Editbasicinfo:Ve},methods:{showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},async reportimginfo(){let e=await this.$reportimginfo(this.companyinfo["topbvCommitmentletter"],"2");e.data&&2e3!=e.data.code&&e.length&&this.$message.error("高炉炉顶放散阀联锁放散压力值设定承诺书上报失败");let t=await this.$reportimginfo(this.companyinfo["facilitiesCommitmentletter"],"1");t.data&&2e3!=t.data.code&&t.length&&this.$message.error("炼钢连铸（模铸）生产过程熔融金属紧急排放和应急储存设施的承诺书上报失败")},reportinfo(){this.$functionConfrim(this.companyinfo).then((e=>{console.log(e),this.loading=!0,"yes"==e.status?_e.A.reportPersonal({id:e.value.id,saveOrUpdate:2}).then((e=>{2e3==e.data.code?this.$message.success("上报成功！"):this.$message.error("上报失败！"+e.data.message),this.reportimginfo(),this.loading=!1})):this.loading=!1}))},editinfo(){this.$refs.editbasicinfo.addRowDialogVisible=!0,this.$refs.editbasicinfo.formatRow()},editIntroduction(e){console.log(e["topbvCommitmentletter"]),this.$refs.editbasicinfo.loadingbtn=!0,delete e.ID,delete e.key;let t=JSON.parse(JSON.stringify(e));t["enterpriseEquipment"]=e["enterpriseEquipment"].join("|"),t["topbvCommitmentletter"]=e["topbvCommitmentletter"]?e["topbvCommitmentletter"]:"",t["facilitiesCommitmentletter"]=e["facilitiesCommitmentletter"]?e["facilitiesCommitmentletter"]:"",console.log(t),ye.A.writecompanyspecialinfo({data:Object.values(t).join(",")}),_e.A.updatePersonal(t).then((e=>{console.log(e.data),200==e.data.code?(this.$message({message:"修改成功",type:"success"}),this.$refs.editbasicinfo.addRowDialogVisible=!1,this.$refs.editbasicinfo.loadingbtn=!1,this.getData()):this.$message({message:"修改失败！",type:"error"})})).catch((e=>{this.$message({message:"网络错误！修改失败！",type:"error"}),this.$refs.editbasicinfo.addRowDialogVisible=!1,this.$refs.editbasicinfo.loadingbtn=!1,this.getData()}))},getData(){this.loading=!0,_e.A.readPersonal().then((e=>{console.log(e.data),200==e.data.code?(this.companyinfo=e.data.data,console.log(Object.keys(this.companyinfo))):this.$message({message:"网络错误！查询失败！",type:"error"}),this.loading=!1})).catch((e=>{this.loading=!1}))}},mounted(){this.getData()}},Ee=Le,Je=(0,w.A)(Ee,We,Me,!1,null,null,null),Ue=Je.exports,Be=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content",staticStyle:{"padding-top":"10px",color:"white"}},[t("router-view"),t("div",{staticStyle:{width:"50%","text-align":"center",position:"absolute",bottom:"0.1rem"}},[t("Navbar")],1)],1)},qe=[],Xe={components:{Navbar:r.A}},He=Xe,Ge=(0,w.A)(He,Be,qe,!1,null,null,null),Ke=Ge.exports,Ze=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"0px",color:"white",height:"100%"}},[t("el-row",{staticClass:"highlight-corner highlight",staticStyle:{padding:"0px",height:"100%",color:"#6cc9d3",margin:"0px 0.1rem"},attrs:{type:"flex"}},[t("el-col",{staticClass:"title highlight",attrs:{span:12}},[t("h1",[e._v("高炉参数")]),t("watchlist",{attrs:{deviceType:e.deviceType,widthval:[12,4]}})],1),t("el-col",{attrs:{span:8}},[t("img",{staticClass:"highbottle-image",attrs:{src:a(80383),alt:"High Bottle Image"}})]),t("div",{staticClass:"echarts-foot"})],1)],1)},Qe=[],Ye=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.componentKey,staticStyle:{color:"#6cc9d3"}},[e._l(e.watchDataList,(function(a){return t("el-row",{staticClass:"introcontent",staticStyle:{margin:"0.1rem 0px"},attrs:{type:"flex"}},[t("el-col",{staticClass:"name",staticStyle:{"margin-right":"0.5rem"},attrs:{span:e.widthval[0]}},[e._v(e._s(a.paramRemark))]),a.sysDictType?t("el-col",{staticClass:"value",staticStyle:{"min-width":"2rem"},attrs:{span:e.widthval[1]},domProps:{innerHTML:e._s(e.formatValue(a))}}):t("el-tooltip",{attrs:{"popper-class":"warning_tips",effect:"dark",placement:"right"}},[t("template",{slot:"content"},[t("span",{domProps:{innerHTML:e._s(e.showInfoFunc(a))}})]),t("div",{staticClass:"title-container"},[[-2,-1,1,2].includes(a.alarmValue)?t("img",{staticClass:"warning-animation",staticStyle:{"margin-top":"-10px"},attrs:{src:e.getImageUrl(a),width:"30px"}}):e._e(),t("span",{staticClass:"warntips",staticStyle:{cursor:"pointer"},domProps:{innerHTML:e._s(e.formatValue(a))},on:{click:function(t){return e.showmoreInfo(a)}}})])],2)],1)})),t("el-dialog",{attrs:{modal:!1,title:"查看",visible:e.dialogshow,"custom-class":"warndialogshow",bodyStyle:{"padding-top":0},top:"0.6rem"},on:{"update:visible":function(t){e.dialogshow=t},close:e.setTimer}},[t("span",{staticStyle:{display:"block","margin-bottom":"0.3rem"},domProps:{innerHTML:e._s(e.showInfoFunc(e.curr_clickdata))}}),t("div",{staticStyle:{width:"100%"}},[e.dialogshow?t("chart",{ref:"chartCom",attrs:{"chart-id":"main",curr_clickdata:e.curr_clickdata}}):e._e()],1)])],2)},et=[],tt=a(44453);function at(e){return(0,tt.Ay)({url:"/system/dict/data/types",method:"post",data:e})}function it(e){return(0,tt.Ay)({url:"/mes/watch/deviceparameter/query",method:"get",params:e})}function st(e){return(0,tt.Ay)({url:"/mes/watch/devicealarmsetup/getByParamIds/"+e,method:"get"})}console.log(tt.Ay);var ot=function(){var e=this,t=e._self._c;return t("div",[t("div",[t("el-button",{attrs:{type:"实时数据刷新中..."==e.default_info?"primary":"info",icon:"el-icon-video-play"},on:{click:e.startTimer}},[e._v("查看实时")]),t("el-button",{attrs:{type:""==e.default_info?"primary":"info",icon:"el-icon-search"},on:{click:e.filterdata}},[e._v("自定义筛选")])],1),"实时数据刷新中..."==e.default_info?t("div",[t("el-button",{attrs:{type:"text",icon:"el-icon-video-pause"},on:{click:e.stoptime}},[e._v("停止")])],1):e._e(),e.default_info?t("div",{staticStyle:{margin:"0.1rem 0rem 0.1rem"}},[t("span",[e._v(e._s(e.default_info)+" "),"实时数据刷新中..."==e.default_info?t("span",[e._v("，已刷新"+e._s(e.time_value)+"s")]):e._e()])]):e._e(),e.default_info?e._e():t("div",{staticStyle:{"margin-top":"0.1rem"}},[t("div",[t("el-date-picker",{attrs:{type:"datetimerange","range-separator":"至","start-placeholder":"开始时间",size:"small","end-placeholder":"结束时间"},on:{change:e.changetime},model:{value:e.value1,callback:function(t){e.value1=t},expression:"value1"}})],1),t("div",{staticStyle:{margin:"0.1rem 0"}},[t("el-input-number",{staticClass:"chartinput",attrs:{label:"请选择时间搜索间隔",size:"small"},model:{value:e.interval,callback:function(t){e.interval=t},expression:"interval"}}),e._v("秒 (例：若输入10，则按10s间隔返回数据) ")],1),t("div",[t("el-input-number",{staticClass:"chartinput",attrs:{label:"请输入显示条目数限制",size:"small"},model:{value:e.num,callback:function(t){e.num=t},expression:"num"}}),e._v(" (例：若输入100，则返回该时间段内前100条数据) "),t("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchdata}},[e._v("查询")])],1)]),t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"echarts-container",attrs:{id:e.chartId}})])},lt=[],rt=a(7808);function nt(e){return(0,tt.Ay)({url:"/mes/watch/devicecurve/querySingleCurve",method:"post",data:e})}var ct=a(49148),dt=a.n(ct),ht={name:"LineChart",props:{chartId:{type:String,required:!0},curr_clickdata:{type:Object,required:!1}},data(){return{chartInstance:null,timer_chart:null,chartData:{xData:[],yData:[],seriesName:""},default_info:`默认显示近一小时 ${this.curr_clickdata.channelName?"CO":this.curr_clickdata.paramRemark} 的数据`,value1:[dt()().subtract(1,"hours"),dt()()],interval:0,num:3600,starttime:dt()().subtract(1,"hours"),endtime:dt()(),loading:!0,time_value:0}},mounted(){this.getOneLine("init")},beforeDestroy(){this.chartInstance&&this.chartInstance.dispose()},methods:{stoptime(){this.default_info=`默认显示近一小时 ${this.curr_clickdata.paramRemark} 的数据`,this.disableTimerchart()},changetime(e){this.value1=[dt()(e[0]),dt()(e[1])]},searchdata(){console.log(this.value1),console.log(this.interval),console.log(this.num),this.getOneLine()},filterdata(){this.disableTimerchart(),this.default_info="",this.chartData.xData=[],this.chartData.yData=[],this.updateChart()},disableTimerchart(){null!=this.timer_chart&&(this.time_value=0,clearInterval(this.timer_chart),this.timer_chart=null)},startTimer(){this.loading=!0,this.interval=0,this.num=3600,this.timer_chart&&clearInterval(this.timer_chart),this.default_info="实时数据刷新中...",this.timer_chart=setInterval((async()=>{this.value1=[dt()().subtract(1,"hours"),dt()()],this.time_value=this.time_value+2,await this.getOneLine()}),2e3)},stopTimer(){this.timer_chart&&(clearInterval(this.timer_chart),this.timer_chart=null)},async getOneLine(e){this.starttime=this.value1[0].format("YYYY-MM-DD HH:mm:ss"),this.endtime=this.value1[1].format("YYYY-MM-DD HH:mm:ss");var t={paramId:this.curr_clickdata.paramId,startTime:this.starttime,endTime:this.endtime,interval:this.interval,limit:this.num};try{let a=await nt(t);"init"==e&&this.initChart(),this.updateChartData(a.data)}catch(a){console.error("Failed to fetch new line data:",a),this.loading=!1,this.$message.error("查询出错！")}},updateChartData(e){this.chartData.xData=[],this.chartData.yData=[],e.forEach((e=>{this.chartData.xData.push(e.ts),this.chartData.yData.push(e.val)})),this.updateChart()},initChart(){const e=document.getElementById(this.chartId);this.chartInstance=rt.init(e),this.setOptions()},setOptions(){this.chartData={title:{text:""},tooltip:{trigger:"axis",formatter:function(e){return`时间:${e[0].name}</br>CO:<span style="color:#28a745"> ${e[0].value}</span>`}},grid:{top:"1.5%",left:"3%",right:"4%",bottom:"5%",containLabel:!0},xAxis:{type:"category",data:this.chartData.xData||[],axisLine:{lineStyle:{color:"#ffffff"}},axisTick:{lineStyle:{color:"#ffffff"}},axisLabel:{color:"#ffffff"}},yAxis:{min:"dataMin",max:"dataMax",type:"value",axisLine:{lineStyle:{color:"#ffffff"}},axisTick:{lineStyle:{color:"#ffffff"}},axisLabel:{color:"#ffffff"},splitLine:{show:!1}},series:[{name:this.chartData.seriesName||"数据",type:"line",data:this.chartData.yData||[],itemStyle:{color:"red"},lineStyle:{color:"#28a745",width:1}}],dataZoom:[{type:"inside",start:0,end:1e4},{type:"slider",show:!0,start:0,end:100,bottom:0,handleIcon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3v-1.2c0-5,4-9.1,8.8-9.4C19.6,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.2h6.6V19.6z",handleSize:"80%",height:15,borderColor:"#ccc",backgroundColor:"#e2e2e2",fillerColor:"#28a745",handleStyle:{color:"#fff",shadowBlur:3,shadowColor:"rgba(0, 0, 0, 0.6)",shadowOffsetX:2,shadowOffsetY:2}}]},this.chartInstance.setOption(this.chartData),this.loading=!1},updateChart(){this.chartInstance&&this.setOptions()}}},pt=ht,gt=(0,w.A)(pt,ot,lt,!1,null,"4b84e8b2",null),ut=gt.exports;function mt(e){return(0,tt.Ay)({url:"/mes/watch/devicewatch/read",method:"get",params:e})}var ft={name:"DeviceWatchList",props:["deviceId","deviceType","widthval"],data(){return{dialogshow:!1,dictConfigMap:{},loading:!0,dataList:[],componentKey:0,watchDataList:[],watchDataMap:{},timer:null,queryParams:{pageNum:1,pageSize:1e4,searchText:"",plant:null,deviceId:this.deviceId,deviceType:this.deviceType},curr_clickdata:{}}},components:{chart:ut},created(){this.getList()},mounted(){this.setTimer()},destroyed(){this.disableTimer()},methods:{async showmoreInfo(e){this.disableTimer(),this.curr_clickdata=e,this.dialogshow=!0},getImageUrl(e){return[-2,-1].includes(e.alarmValue)?a(60751):a(39472)},showInfoFunc(e){return`${this.warningtype(e)}标准值：${e.normal?e.normal+e.unit:"未设置"}；</br>低限值：${e.low?e.low+e.unit:"未设置"}；低低限值：${e.lowlow?e.lowlow+e.unit:"未设置"}；</br>高限值：${e.up?e.up+e.unit:"未设置"}；高高限值：${e.upup?e.upup+e.unit:"未设置"}；`},setTimer(){this.timer=setInterval(this.refreshWatchData,2e3)},disableTimer(){null!=this.timer&&(clearInterval(this.timer),this.timer=null)},warningtype(e){let t=e.alarmValue;switch(!0){case-2==t:return'报警类型：<span class="yellow-warning">低低报</span></br>';case-1==t:return'报警类型：<span class="yellow-warning">低报</span></br>';case 1==t:return'报警类型：<span class="red-warning">高报</span></br>';case 2==t:return'报警类型：<span class="red-warning">高高报</span></br>';default:return""}},getRedWarningSpan(e,t){switch(!0){case-2==e:return`<span class="yellow-warning">${t}</span>`;case-1==e:return`<span class="yellow-warning">${t}</span>`;case 1==e:return`<span class="red-warning">${t}</span>`;case 2==e:return`<span class="red-warning">${t}</span>`;default:return""}},formatValue(e){if(!e.sysDictType){const t=e.value?parseFloat(e.value).toFixed(2):0,a=`${t}${e.unit}`;return[-2,-1,1,2].includes(e.alarmValue)?this.getRedWarningSpan(e.alarmValue,a):a}{let t="";if(this.dictConfigMap&&this.dictConfigMap[e.sysDictType])return t=this.dictConfigMap[e.sysDictType][e.value+""]?this.dictConfigMap[e.sysDictType][e.value+""]:"","解锁"==t?`<span class="red-warning">${t}</span>`:`<span>${t}</span>`}return""},refreshWatchData(){if(null!=this.watchDataList){for(var e=[],t=0;t<this.watchDataList.length;t++){var a=this.watchDataList[t];a.paramId&&e.push(a.paramId)}var i={paramIds:e,readChanged:!0,fromCache:!0};mt(i).then((e=>{console.log("resp",e);var t=e.rows;t&&this.updateWatchData(t),this.loading=!1})).catch((e=>{}))}},async updateWatchData(e){for(var t=0;t<e.length;t++){var a=e[t].paramId,i=e[t].value,s=e[t].timeStamp,o=e[t].lastUpdateTime;if(this.watchDataMap[a]){console.log("refresh ok");var l=this.watchDataMap[a];l.value=i,l.lastUpdateTime=o,l.timeStamp=s}}console.log(e),this.componentKey++},updateWatchDictTypeMap(e){at(e).then((e=>{var t=e.data;if(200==e.code){this.dictConfigMap={};for(var a=0;a<t.length;a++){var i=t[a],s=i.dictType,o=i.dictLabel,l=i.dictValue;s&&(this.dictConfigMap[s]||(this.dictConfigMap[s]={}),this.dictConfigMap[s][l]=o)}}else this.$message({type:"warning",message:"登录已过期,自动重新登录",showClose:!0}),this.disableTimer(),setTimeout((()=>{this.$router.push("/")}),2e3)}))},buildWatchList(e){var t=[];if(!e)return t;for(var a=0;a<e.length;a++){var i=e[a],s={paramId:i.id,deviceId:i.deviceId,paramRemark:i.remark,tagId:i.tagId,timeStamp:void 0,value:void 0,deviceType:i.deviceType,sysDictType:i.sysDictType,deviceName:i.deviceName,lastUpdateTime:0,unit:""};switch(!0){case s.paramRemark.indexOf("转炉水冷氧枪氧气压力")>=0:s.unit=" MPa";break;case s.paramRemark.indexOf("水流量")>=0:s.unit=" Nm3/h";break;case s.paramRemark.indexOf("温度")>=0:s.unit=" °C";break;case s.paramRemark.indexOf("炉顶工作压力")>=0:s.unit=" kPa";break}t.push(s)}return t},async getList(){this.loading=!0,console.log("queryParams",this.queryParams);let e=await it(this.queryParams);var t=e.rows;this.total=e.total,this.watchDataList=this.buildWatchList(t),this.watchDataMap={};let a=[];for(var i=0;i<this.watchDataList.length;i++){var s=this.watchDataList[i].paramId+"",o=this.watchDataList[i].sysDictType;o&&!a.includes(o)&&a.push(o),this.watchDataMap[s]=this.watchDataList[i];let e=await st(s);e.data[0]&&(this.watchDataMap[s].normal=e.data[0].normal,this.watchDataMap[s].low=e.data[0].low,this.watchDataMap[s].lowlow=e.data[0].lowlow,this.watchDataMap[s].up=e.data[0].up,this.watchDataMap[s].upup=e.data[0].upup,this.watchDataMap[s].alarmValue=e.data[0].alarmValue)}this.updateWatchDictTypeMap(a)}}},wt=ft,bt=(0,w.A)(wt,Ye,et,!1,null,null,null),vt=bt.exports,yt={components:{watchlist:vt},data(){return{deviceType:"01"}}},_t=yt,St=(0,w.A)(_t,Ze,Qe,!1,null,"59c504f6",null),Dt=St.exports,Rt=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"0px",color:"white","overflow-y":"auto","overflow-x":"hidden",height:"calc(100% - 0px)","background-color":"black","padding-bottom":"1rem"}},[t("el-row",{staticStyle:{padding:"0px",height:"100%",color:"#6cc9d3",margin:"0px 0"},attrs:{type:"flex"}},[t("el-col",{staticClass:"title highlight",attrs:{span:15}},[t("h1",[e._v("1#转炉参数")]),t("watchlist",{attrs:{deviceId:e.deviceId,widthval:[15,4]}})],1),t("el-col",{staticStyle:{position:"relative"},attrs:{span:9}},[t("img",{staticClass:"highbottle-image",attrs:{src:a(50094),alt:"High Bottle Image"}})])],1),t("div",{staticClass:"echarts-foot"})],1)},kt=[],$t={components:{watchlist:vt},data(){return{deviceId:3}},mounted(){},watch:{$route:e=>{let t;console.log(e),"2#转炉"==e.name&&(t.deviceId=4)}}},Ct=$t,xt=(0,w.A)(Ct,Rt,kt,!1,null,"75dd0230",null),It=xt.exports,At=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"0px",color:"white","overflow-y":"auto","overflow-x":"hidden",height:"calc(100% - 0px)","background-color":"black","padding-bottom":"1rem"}},[t("el-row",{staticStyle:{padding:"0px",height:"100%",color:"#6cc9d3",margin:"0px 0"},attrs:{type:"flex"}},[t("el-col",{staticClass:"title highlight",attrs:{span:15}},[t("h1",[e._v("2#转炉参数")]),t("watchlist",{attrs:{deviceId:e.deviceId,widthval:[15,3]}})],1),t("el-col",{staticStyle:{position:"relative"},attrs:{span:9}},[t("img",{staticClass:"highbottle-image",attrs:{src:a(50094),alt:"High Bottle Image"}})])],1),t("div",{staticClass:"echarts-foot"})],1)},zt=[],Ot={components:{watchlist:vt},data(){return{deviceId:4}},mounted(){},watch:{$route:e=>{let t;console.log(e),"2#转炉"==e.name&&(t.deviceId=4)}}},Tt=Ot,Vt=(0,w.A)(Tt,At,zt,!1,null,"5f8abf72",null),Pt=Vt.exports,Ft=function(){var e=this,t=e._self._c;return t("div",{staticClass:"base_list highlight",staticStyle:{padding:"20px"}},[t("edit-table",{attrs:{column:e.columns,tabledata:e.tableData,loading:e.loading}}),t("div",{staticClass:"echarts-foot"})],1)},Nt=[],jt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",background:"transparent"},attrs:{"row-class-name":"rowstyle",data:e.paginatedData,"tooltip-effect":"light",height:"calc(100vh - 2.2rem)","cell-class-name":e.getCellClassName}},[t("el-table-column",{attrs:{label:"操作",width:"50rem"},scopedSlots:e._u([{key:"default",fn:function(a){return[0==a.row["warnStatus"]?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.editRow(a.row)}}},[e._v("处理")]):e._e()]}}])}),e._l(e.columns,(function(a,i){return t("el-table-column",{key:i,attrs:{fit:"",prop:a.prop,width:a.width?a.width:"","show-overflow-tooltip":"message"==a.prop,label:a.label,sortable:a.sortable},scopedSlots:e._u([{key:"default",fn:function(i){return["预警等级"==a.label?t("span",[t("span",[e._v(e._s(1==i.row[a.prop]?"红色预警":2==i.row[a.prop]?"橙色预警":3==i.row[a.prop]?"黄色预警":"正常"))])]):e._e(),"预警状态"==a.label?t("span",[t("span",[e._v(e._s(["1","2","3"].indexOf(i.row["warnRank"])>=0?0==i.row[a.prop]?"未消警":"已消警":""))])]):"预警状态"!=a.label&&"预警等级"!=a.label?t("span",[e._v(e._s(i.row[a.prop]))]):e._e()]}}],null,!0)})}))],2),t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("el-dialog",{staticClass:"feedback",attrs:{title:"处理警报",visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[e._l(e.columns,(function(a){return t("div",{staticStyle:{"margin-bottom":"0.1rem"}},[t("el-row",[t("el-col",{staticStyle:{"font-weight":"bold"},attrs:{span:4}},[e._v(" "+e._s(a.label)+" ")]),t("el-col",{attrs:{span:16}},["预警等级"!=a.label&&"预警状态"!=a.label?t("span",[e._v(" "+e._s(e.newRow[a.prop]))]):"预警状态"!=a.label?t("span",{domProps:{innerHTML:e._s(e.riskLevelHtml)}}):e._e(),"预警状态"==a.label?t("span",[e._v(" "+e._s(0==e.newRow[a.prop]?"未消警":"已消警")+" ")]):e._e()])],1)],1)})),t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top"}},e._l(e.feedbackInfo,(function(a){return t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.label}},[t("el-input",{model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}})],1)})),1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow()}}},[e._v("确定")]),t("el-button",{on:{click:function(t){e.addRowDialogVisible=!1}}},[e._v("取消")])],1)],2)],1)},Wt=[],Mt={props:["column","tabledata","loading"],data(){return{tableData:[],currentPage:1,pageSize:20,total:0,columns:[],currentPage:1,pageSize:10,pageSizes:[],addRowDialogVisible:!1,operatetitle:"",feedbackInfo:[{label:"反馈信息",prop:"warnFeedback"},{label:"反馈处置人",prop:"responPerson"},{label:"处置措施",prop:"alarmMeasures"},{label:"填报人",prop:"fillBy"}],newRow:{},warning_message:"",loadingbtn:!1}},created(){},methods:{addRow(){console.log(this.newRow);let e={warnFeedback:this.newRow.warnFeedback,responPerson:this.newRow.responPerson,alarmMeasures:this.newRow.responPerson,fillBy:this.newRow.fillBy,warnId:this.newRow.id};console.log(e),_e.A.warninginfoFeedback(e).then((e=>{console.log(e.data),"2000"==e.data.code?(this.$message.success(e.data.message),this.addRowDialogVisible=!1):this.$message.error(e.data.message)}))},handleCurrentChange(e){this.currentPage=e,this.fetchData()},handleSizeChange(e){this.pageSize=e,this.fetchData()},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.newRow=Object.assign({},e),this.addRowDialogVisible=!0},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){if(2==i){if(console.log(e.warnRank),"1"===e.warnRank)return"red-warning";if("2"===e.warnRank)return"orange-warning";if("3"===e.warnRank)return"yellow - warning ";if("4"===e.warnRank)return""}},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)},riskLevelHtml(){switch(console.log(this.newRow.warnRank),this.newRow.warnRank){case"1":return'<span class="red-warning">红色预警</span>';case"2":return'<span class="orange-warning">橙色预警</span>';case"3":return'<span class="yellow-warning">黄色预警</span>';default:return"未知预警"}}}},Lt=Mt,Et=(0,w.A)(Lt,jt,Wt,!1,null,null,null),Jt=Et.exports,Ut=a(83169),Bt=a.n(Ut);const qt="x8CN1UhWRmry4wXesFfuDA==client_code：LFAzIpqwzMBqGUtNjJZ+bpellt9q+2xs2HKw3PNjwZQQ2YAk5/bj0w+gC9qJOn2zFgLhpaj1zswH3B2HZbLDTWsT2/4N/MhzJwM4sxEjE0DJwYwKcPflbD01hntxYk0hIBF3P0UA6VuQcKLOVbwdJyXIrqwswGqZfSRIjiqv5nU%3D",Xt="15tyRz7Gz7/aHanqHO/1VbH32TJpZMpAqj3mZjzjWk8=";var Ht={decryptWithAES(e){try{const i=Bt().enc.Base64.parse(qt),s=Bt().enc.Base64.parse(Xt);if(!e||"string"!==typeof e)throw new Error("Invalid encrypted data");let o;try{o=Bt().AES.decrypt(e,s,{iv:i,mode:Bt().mode.CBC,padding:Bt().pad.Pkcs7})}catch(t){throw console.error("Error during decryption:",t.message),t}let l=o.toString(Bt().enc.Utf8);if(!l||""===l.trim())throw new Error("Decryption resulted in empty or invalid string");try{return JSON.parse(l)}catch(a){return console.warn("Decrypted data is not valid JSON:",l),l}}catch(t){throw console.error("解密失败:",t.message),t}},exampleUsage(){const e="your_encrypted_data_string";try{const t=this.decryptWithAES(e);console.log("解密后的数据:",t)}catch(t){console.error("Error in exampleUsage:",t.message)}}},Gt={components:{EditTable:Jt},data(){return{tableData:[],columns:[{prop:"warnOrg",label:"预警发布单位"},{prop:"warnRank",label:"预警等级",width:"80rem"},{prop:"warnStatus",label:"预警状态",width:"70rem"},{prop:"riskIndex",label:"风险预警指数",width:"90rem"},{prop:"startTime",label:"预警起始时间",width:"180rem"},{prop:"endTime",label:"预警结束时间"},{prop:"message",label:"预警描述",width:"290rem"}],loading:!0,timer:null}},destroyed(){this.disableTimer()},mounted(){this.exampleUsage(),this.timer=setInterval(this.exampleUsage,6e4)},methods:{disableTimer(){null!=this.timer&&(clearInterval(this.timer),this.timer=null)},async exampleUsage(){this.loading=!0;dt()((new Date).getTime()).format("yyyy-MM-DD HH:mm:ss");let e=await _e.A.zfwarningInfo({dataId:"GT3210840001",startTime:"2024-10-01 00:00:00"});if(2e3==e.code){const t=e.data,a=Ht.decryptWithAES(t);console.log("解密后的数据:",a),this.tableData=a.records}else this.$message.error("获取预警信息失败！");this.loading=!1}}},Kt=Gt,Zt=(0,w.A)(Kt,Ft,Nt,!1,null,null,null),Qt=Zt.exports,Yt=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content",staticStyle:{"padding-top":"10px",color:"white"}},[t("router-view"),t("div",{staticStyle:{width:"740px","text-align":"center",position:"absolute",bottom:"17px",left:"380px"}})],1)},ea=[],ta={components:{Navbar:r.A}},aa=ta,ia=(0,w.A)(aa,Yt,ea,!1,null,null,null),sa=(ia.exports,function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788)}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["edit","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)}),oa=[],la=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{type:"flex",justify:"space-between"}},[e.showSelect?e._e():t("el-col",{attrs:{span:4}},[t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加高炉信息")])],1),t("el-col",[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),e.showSelect?t("div",{staticStyle:{width:"fit-content"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{staticStyle:{display:"flex","justify-content":"end"},attrs:{span:20}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0}}})],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:e.heightValue},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small",disabled:1==e.paginatedData.length},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,419384321)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用/报废证明"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"检验报告上传"!=i.prop&&"停用/报废证明"!=i.prop?t("span",[t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"高炉"})}}},[e._v("导出数据")])],1),t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{close:e.closeDialog}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.label&&"检验日期预报警状态"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"炉顶工作压力"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),"炉顶放散阀联锁投入状态"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind2,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),"检验报告上传"==a.prop||"停用/报废证明"==a.prop?t("div",[""==e.newRow[a.prop]?t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}}):t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])])],1):"炉顶工作压力"!=a.prop&&"炉顶放散阀联锁投入状态"!=a.prop&&"运行状态"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label},on:{change:function(t){return e.changeBasic(a.prop)}},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.closeDialog}},[e._v("取消")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},ra=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],na=function(){var e=this,t=e._self._c;return t("el-row",{attrs:{type:"flex",justify:"end"}},[e._l(e.show_filterinfo,(function(a){return t("el-col",{key:a.name,style:{minWidth:"运行状态"==a.name?"1.5rem":a.name.indexOf("日期")>=0?"1.94rem":"1.97rem"},attrs:{span:2}},[t(a.type,{tag:"component",staticStyle:{margin:"0 0.05rem",width:"calc(100% - 0.1rem)"},attrs:{selectvalue:a,disabled:e.disabled},on:{selectval:t=>e.selectvalFunc(t,a.value)}})],1)})),t("el-button",{staticClass:"plusicon",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchFunc}},[e._v("查询")])],2)},ca=[],da=function(){var e=this,t=e._self._c;return t("el-date-picker",{staticClass:"filtercom",staticStyle:{width:"100%"},attrs:{type:"date",placeholder:e.selectvalue.name,"value-format":"yyyy-MM-dd",clearable:!0},on:{change:e.changedate},model:{value:e.date,callback:function(t){e.date=t},expression:"date"}})},ha=[],pa={props:["selectvalue"],data(){return{date:""}},methods:{changedate(){this.$emit("selectval",this.date?[this.date+" 00:00:00"]:[])}}},ga=pa,ua=(0,w.A)(ga,da,ha,!1,null,null,null),ma=ua.exports,fa=function(){var e=this,t=e._self._c;return t("el-select",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"filtercom",attrs:{filterable:"",placeholder:e.selectvalue.name,"popper-class":"filtercomselect",multiple:"","collapse-tags":"",clearable:!0,filterMethod:e.filterMethod},on:{change:e.changValue},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}},e._l(e.filteredOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)},wa=[],ba={props:["selectvalue"],data(){return{originalOptions:[],options:[],value:[],loading:!1,searchQuery:""}},methods:{filterMethod(e){this.searchQuery=e,console.log(this.searchQuery),this.filterOptions()},changValue(){this.$emit("selectval",this.value)},getFilterdata(){this.loading=!0,ye.A.filterDeviceinfo({key:this.selectvalue.value}).then((e=>{console.log(e.data);let t=e.data.data.map((e=>"运行状态"==this.selectvalue.name?{label:1==e?"在用":2==e?"停用":"报废",value:e}:{label:e,value:e}));this.originalOptions=[...t],this.options=[...t],this.loading=!1}))},filterOptions(){if(!this.searchQuery)return void(this.options=[...this.originalOptions]);const e=this.searchQuery.toLowerCase();this.options=this.originalOptions.filter((t=>t.label.toString().toLowerCase().includes(e))),console.log(this.searchQuery,this.options)}},mounted(){this.getFilterdata()},computed:{device_change(){return this.$store.state.device_change},filteredOptions(){return this.options}},watch:{device_change(){this.getFilterdata()},searchQuery(e){this.filterOptions()},value(e){e.length>0&&(this.searchQuery="",this.filterOptions())}}},va=ba,ya=(0,w.A)(va,fa,wa,!1,null,null,null),_a=ya.exports,Sa={props:["filterinfo","disabled"],data(){return{all_filterinfo:[{name:"所属分厂",type:"filterselect",value:"org"},{name:"所属车间",type:"filterselect",value:"workshop"},{name:"安装地点",type:"filterselect",value:"install_location"},{name:"设备名称",type:"filterselect",value:"device_name"},{name:"运行状态",type:"filterselect",value:"device_status"},{name:"检验日期",type:"filterdate",value:"check_date"},{name:"再检日期",type:"filterdate",value:"next_check_date"}],show_filterinfo:[],filterparams:{}}},components:{Filterselect:_a,Filterdate:ma},mounted(){this.show_filterinfo=this.all_filterinfo.filter((e=>this.filterinfo.indexOf(e.name)>=0))},methods:{searchFunc(){this.$emit("searchFunc")},isObjectEmpty(e){return Object.keys(e).every((t=>null==e[t]||0==e[t].length))},selectvalFunc(e,t){this.filterparams[t]=e,console.log(this.isObjectEmpty(this.filterparams)),this.isObjectEmpty(this.filterparams)&&(this.filterparams={})}}},Da=Sa,Ra=(0,w.A)(Da,na,ca,!1,null,null,null),ka=Ra.exports,$a={props:["column","tabledata","operate"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["监测","不监测"],deviceKind2:["已锁","未锁"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rules_data:{},showsearch:!1,change_base:!1,loading:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:"",heightValue:"calc(100vh - 1.2rem)"}},methods:{confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},changeBasic(e){["所属分厂","所属车间","安装地点","设备名称","状态"].indexOf(e)>=0&&(this.change_base=!0)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules(["炉顶工作压力设定值（MPa）","规格（m3）"],this.newRow)}))},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},closeDialog(){this.addRowDialogVisible=!1},cancelImg(e){this.$emit("deleteImage",this.newRow[e]),this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.rules_data=this.$formatFormRules(["炉顶工作压力设定值（MPa）","规格（m3）"],this.newRow)})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},addRow(e){console.log(this.newRow),this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle}),this.change_base=!1}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})},validateNumber(e,t,a){const i=parseInt(t,10);i&&a()}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes(),this.$nextTick((()=>{this.heightValue="calc(100vh - 3.2rem)"}));const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},Ca=$a,xa=(0,w.A)(Ca,la,ra,!1,null,null,null),Ia=xa.exports,Aa={components:{BaseTable:Ia},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{},filter_params:{}}},methods:{deleteImage(e){console.log(e)},chooseReport(e){"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},reportInfo(e){let t=e.checkevalue.map((e=>e.ID)),a={deviceType:"01",saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.$refs.basetable.loading_report=!0,t.length&&(this.loading=!0,_e.A.reportDevice(a).then((e=>{console.log(e.data),2e3==e.data.code?this.$message.success("上报成功！"+e.data.message):this.$message.error("上报失败！"+e.data.message),this.loading=!1,this.$refs.basetable.loading_report=!1,this.getdata()})),console.log(a))},addinfo(e){delete e.rowinfo["key"],delete e.rowinfo["ID"],this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["炉顶工作压力"]="监测"==this.current_newinfo["炉顶工作压力"]?1:0,this.current_newinfo["炉顶放散阀联锁投入状态"]="已锁"==this.current_newinfo["炉顶放散阀联锁投入状态"]?1:0,this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3;let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag,this.editinfo(e,t)},async editinfo(e,t){this.$refs.basetable.loadingbtn=!0;let a,i={};if(t[0]["设备类型"]="高炉",console.log("base",t[1]),"编辑"==e.operate)i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},a=ye.A.updateTallbottle({...i});else{let e=await this.$getId();console.log(e),t[0]["getId"]=e,i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1]))},a=ye.A.writeTallbottle({...i})}console.log("info.operate ",i),a.then((t=>{console.log(t.data),200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(this.filter_params),this.$store.commit("changeDevice")})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn,this.$store.commit("changeDevice")}))},deleterow(e){this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata(this.filter_params))})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn}))},searchparams(e){this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},getdata(){this.$set(this.tabledata,"data",[]);let e={};this.$refs.basetable&&(this.$refs.basetable.loading=!0,this.$refs.basetable.showsearch&&(e=this.filter_params)),ye.A.readTallbottle(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})));let a=t.data.data.map((e=>e.系统ID));_e.A.listReportStatus({systemIds:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.systemId===t.系统ID));return{...t,...a||{}}}));console.log(a),this.$set(this.tabledata,"data",a),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata("")}},za=Aa,Oa=(0,w.A)(za,sa,oa,!1,null,null,null),Ta=Oa.exports,Va=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["edit","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},Pa=[],Fa=function(){var e=this,t=e._self._c;return t("div",[e.loading_report?t("img",{staticClass:"loading_report",attrs:{src:a(18788)}}):e._e(),t("el-row",{attrs:{type:"flex",justify:"space-between"}},[e.showSelect?e._e():t("el-col",{attrs:{span:4}},[t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加转炉信息")])],1),t("el-col",[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),e.showSelect?t("div",{staticStyle:{width:"fit-content"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{staticStyle:{display:"flex","justify-content":"end"},attrs:{span:20}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0}}})],1),t("div",{staticClass:"table-container",style:{height:e.heightValue}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:"100%"},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small",disabled:1==e.paginatedData.length},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,419384321)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(a,i){return"系统ID"!=a.label&&"ID"!=a.label?t("el-table-column",{key:i,attrs:{fit:"",prop:a.prop,label:a.label,sortable:a.sortable,width:"水冷氧枪监测指标"==a.prop||"水冷副枪监测指标"==a.prop?"280rem":""},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.editing?t("div",[t("el-input",{model:{value:i.row[a.prop],callback:function(t){e.$set(i.row,a.prop,t)},expression:"scope.row[column.prop]"}})],1):t("div",["水冷氧枪监测指标"==a.prop||"水冷副枪监测指标"==a.prop?t("span",{domProps:{innerHTML:e._s(i.row[a.prop].replaceAll("|","</br>"))}}):t("span",[e._v(" "+e._s(i.row[a.prop])+" ")])])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"转炉"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t},close:e.closeDialog}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.label?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.label}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"水冷氧枪监测指标"==a.prop?t("div",[t("el-checkbox",{attrs:{indeterminate:e.isIndeterminate1},on:{change:e.handleCheckAllChange1},model:{value:e.checkAll1,callback:function(t){e.checkAll1=t},expression:"checkAll1"}},[e._v("全选")]),e.newRow["水冷氧枪监测指标"]?t("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange1},model:{value:e.newRow["水冷氧枪监测指标"],callback:function(t){e.$set(e.newRow,"水冷氧枪监测指标",t)},expression:"newRow['水冷氧枪监测指标']"}},e._l(e.checkdata1,(function(a){return t("el-checkbox",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1):e._e()],1):e._e(),"水冷副枪监测指标"==a.prop?t("div",[t("el-checkbox",{attrs:{indeterminate:e.isIndeterminate2},on:{change:e.handleCheckAllChange2},model:{value:e.checkAll2,callback:function(t){e.checkAll2=t},expression:"checkAll2"}},[e._v("全选")]),e.newRow["水冷氧枪监测指标"]?t("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange2},model:{value:e.newRow["水冷副枪监测指标"],callback:function(t){e.$set(e.newRow,"水冷副枪监测指标",t)},expression:"newRow['水冷副枪监测指标']"}},e._l(e.checkdata2,(function(a){return t("el-checkbox",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1):e._e()],1):"水冷副枪监测指标"!=a.prop&&"水冷氧枪监测指标"!=a.prop&&"运行状态"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:function(t){e.addRowDialogVisible=!1}}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Na=[],ja={props:["column","tabledata","operate"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,checkAll1:!1,checkAll2:!1,checkedData1:[],checkedData2:[],checkdata:["在用","停用","报废"],checkdata1:["氧气压力","冷却水进水流量","冷却水进出水流量差","冷却水出水温度","氧气压力与氧枪自动升起联锁投入状态","冷却水进水流量与氧枪自动升起联锁投入状态","冷却水出水温度与氧枪自动升起联锁投入状态","进出水流量差与氧枪自动升起联锁投入状态","冷却水进出水流量差与炉体倾动联锁投入状态"],checkdata2:["冷却水进水流量","冷却水进出水流量差 ","冷却水出水温度 ","冷却水流量与副枪自动升起联锁投入状态","冷却水出水温度与副枪自动升起联锁投入状态","进出水流量差与副枪自动升起联锁投入状态","进出水流量差与炉体倾动联锁投入状态"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,operatetitle:"添加",isIndeterminate1:!0,isIndeterminate2:!0,rules_data:{},showsearch:!1,change_base:!1,loading:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:"",loading_report:!1,heightValue:"calc(100vh - 3.2rem)"}},methods:{confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},handleCheckAllChange1(e){this.newRow["水冷氧枪监测指标"]=e?this.checkdata1:[],this.isIndeterminate1=!1},handleCheckAllChange2(e){this.newRow["水冷副枪监测指标"]=e?this.checkdata2:[],this.isIndeterminate2=!1},handleCheckedCitiesChange1(e){let t=e.length;this.checkAll1=t===this.checkdata1.length,this.isIndeterminate1=t>0&&t<this.checkdata1.length},handleCheckedCitiesChange2(e){let t=e.length;this.checkAll2=t===this.checkdata2.length,this.isIndeterminate2=t>0&&t<this.checkdata2.length},changeBasic(e){["所属分厂","所属车间","安装地点","设备名称","状态"].indexOf(e)>=0&&(this.change_base=!0)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);console.log(e),this.$emit("searchparams",e)},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules(["规格（t）"],this.newRow,{"水冷副枪监测指标":{required:!1}})}))},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1},closeDialog(){this.addRowDialogVisible=!1},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=JSON.parse(JSON.stringify(e)),this.newRow["水冷氧枪监测指标"]=e["水冷氧枪监测指标"].split("|"),this.newRow["水冷副枪监测指标"]=e["水冷副枪监测指标"].split("|"),this.rules_data=this.$formatFormRules(["规格（t）"],this.newRow,{"水冷副枪监测指标":{required:!1}})})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{}),console.log(this.newRow),this.newRow["水冷氧枪监测指标"]=[],this.newRow["水冷副枪监测指标"]=[]}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes(),this.$nextTick((()=>{this.heightValue=this.showsearch?"calc(100vh - 3.8rem)":"calc(100vh - 3.2rem)"}));const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},Wa=ja,Ma=(0,w.A)(Wa,Fa,Na,!1,null,null,null),La=Ma.exports,Ea={components:{BaseTable:La},data(){return{tabledata:{columns:[],data:[]},current_newinfo:{},filter_params:{}}},methods:{chooseReport(e){"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},reportInfo(e){let t=e.checkevalue.map((e=>e.ID)),a={deviceType:"02",saveOrUpdate:"新增"==e.operate?1:2,ids:t};t.length&&(this.$refs.basetable.loading_report=!0,_e.A.reportDevice(a).then((e=>{console.log(e.data),2e3==e.data.code?this.$message.success("上报成功！"+e.data.message):this.$message.error("上报失败！"+e.data.message),this.$refs.basetable.loading_report=!1})),console.log(a))},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["水冷氧枪监测指标"]=e.rowinfo["水冷氧枪监测指标"].join("|"),this.current_newinfo["水冷副枪监测指标"]=e.rowinfo["水冷副枪监测指标"].join("|"),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3;let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag,this.editinfo(e,t)},async editinfo(e,t){this.$refs.basetable.loadingbtn=!0;let a,i={};if(t[0]["设备类型"]="转炉","编辑"==e.operate)i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},a=ye.A.updateRotatebottle({...i});else{let e=await this.$getId();console.log(e),t[0]["getId"]=e,i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1]))},console.log(i),a=ye.A.writeRotatebottle({...i})}console.log("info.operate ",i),a.then((t=>{200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(this.filter_params),this.$store.commit("changeDevice")})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn,this.$store.commit("changeDevice")}))},deleterow(e){this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata(this.filter_params))})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn}))},searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),ye.A.readRotatebottle(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})));let a=t.data.data.map((e=>e.系统ID));_e.A.listReportStatus({systemIds:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.systemId===t.系统ID));return{...t,...a||{}}}));console.log(a),this.$set(this.tabledata,"data",a),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata("")}},Ja=Ea,Ua=(0,w.A)(Ja,Va,Pa,!1,null,null,null),Ba=Ua.exports,qa=function(){var e=this,t=e._self._c;return t("div",{staticClass:"intor_list highlight",staticStyle:{padding:"0.3rem 0","overflow-y":"hidden"}},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788)}}):e._e(),t("span",{staticClass:"gas_info_title"},[e._v(" 选择分厂： ")]),t("el-select",{staticClass:"areaselect",attrs:{filterable:"",placeholder:"请选择"},on:{change:e.changePlant},model:{value:e.plant,callback:function(t){e.plant=t},expression:"plant"}},e._l(e.plantList,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1),t("span",{staticClass:"gas_info_title"},[e._v(" 选择分厂对应主机 ")]),e._v(" ： "),t("el-select",{staticClass:"areaselect",staticStyle:{"margin-bottom":"0.25rem"},attrs:{filterable:"",placeholder:"请选择"},on:{change:e.queryAlarmChannels},model:{value:e.hostId,callback:function(t){e.hostId=t},expression:"hostId"}},e._l(e.plant_child_options,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1),e.paginatedArray.length?t("el-row",{staticStyle:{height:"calc(100% - 0.9rem)","overflow-y":"auto"}},e._l(e.paginatedArray,(function(a,i){return t("el-col",{key:a.id,staticClass:"warninginfo",staticStyle:{"min-width":"156px"},attrs:{span:3}},["0"!=String(a.statuscode)?t("el-popconfirm",{staticClass:"confrimwarning",attrs:{placement:"top-start",title:"处理报警"},on:{confirm:function(t){return e.confirm(a)},cancel:e.cancel}},[t("div",{staticStyle:{cursor:"pointer"},attrs:{slot:"reference"},slot:"reference"},[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark","popper-class":"warning_tips",content:a.internalNo+"_"+a.channelName}},[t("div",{staticClass:"title-container"},[t("div",{staticClass:"title"},[e._v(e._s(a.internalNo))]),t("div",{staticClass:"title",attrs:{title:a.internalNo}},[e._v(e._s(a.channelName))])])]),t("div",{staticStyle:{display:"flex","justify-content":"space-between",height:"38px"}},[t("div",[t("div",[e._v("CO： "+e._s(e.formatValue(a)))]),t("div",[e._v(" 状      态： "),t("span",{domProps:{innerHTML:e._s(e.riskLevelHtml(a.statuscode,a.num))}})])]),t("div",[t("img",{class:{"warning-animation":"0"!=String(a.statuscode)},attrs:{src:e.getImageUrl(a),width:"30px"}})])])],1)]):e._e(),"0"!=String(a.statuscode)?t("div",[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.showmoreInfo(a)}}},[e._v("查看更多")])],1):e._e(),"0"==String(a.statuscode)?t("div",[t("el-tooltip",{staticClass:"item",attrs:{effect:"dark","popper-class":"warning_tips",content:a.internalNo+"_"+a.channelName}},[t("div",{staticClass:"title-container"},[t("div",{staticClass:"title"},[e._v(e._s(a.internalNo))]),t("div",{staticClass:"title",attrs:{title:a.internalNo}},[e._v(" "+e._s(a.channelName)+" ")])])]),t("div",{staticStyle:{display:"flex","justify-content":"space-between",height:"38px"}},[t("div",[t("div",[e._v("CO： "+e._s(e.formatValue(a)))]),t("div",{staticClass:"title"},[e._v(" 状      态： "),t("span",{domProps:{innerHTML:e._s(e.riskLevelHtml(String(a.statuscode),a.num))}})])]),t("div",[t("img",{class:{"warning-animation":"0"!=String(a.statuscode)},attrs:{src:e.getImageUrl(a),width:"30px"}})])]),t("div",[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.showmoreInfo(a)}}},[e._v("查看更多")])],1)],1):e._e()],1)})),1):e.loading?e._e():t("div",[t("span",{staticStyle:{color:"white","font-size":"0.3rem","margin-left":"0.3rem"}},[e._v("暂无数据")])]),t("el-col",[t("el-pagination",{staticClass:"e-pagin-gas",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.totalItems,layout:"total, prev, pager, next, jumper"},on:{"current-change":e.handleCurrentChange}})],1),t("el-dialog",{attrs:{modal:!1,title:"查看",visible:e.dialogshow,"custom-class":"warndialogshow",bodyStyle:{"padding-top":0},top:"0.6rem"},on:{"update:visible":function(t){e.dialogshow=t},close:e.closeChart}},[t("span",{staticStyle:{display:"block","margin-bottom":"0.3rem"},domProps:{innerHTML:e._s(e.showInfoFunc(e.curr_clickdata))}}),t("div",{staticStyle:{width:"100%"}},[e.dialogshow?t("chart",{ref:"chartCom",attrs:{"chart-id":"main","chart-data":e.chartData,curr_clickdata:e.curr_clickdata}}):e._e()],1)]),t("el-dialog",{staticClass:"feedback",attrs:{title:"处理报警",visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{domProps:{innerHTML:e._s(e.riskLevelHtml(e.columns.statuscode,e.columns.num))}}),t("div",{staticStyle:{margin:"0.2rem 0"}},[e._v(" "+e._s(e.columns.internalNo)+"_"+e._s(e.columns.channelName)+" ")]),t("div",[e._v("CO："+e._s(e.formatValue(e.columns)))]),t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top"}},e._l(e.feedbackInfo,(function(a){return t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},[t("el-input",{model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}})],1)})),1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow()}}},[e._v("确定")]),t("el-button",{on:{click:function(t){e.addRowDialogVisible=!1}}},[e._v("取消")])],1)],1)],1)},Xa=[];a(17642),a(58004),a(33853),a(45876),a(32475),a(15024),a(31698);function Ha(e){return(0,tt.Ay)({url:"/mes/watch/alarmhostsetup/query",method:"get",params:e})}function Ga(e){return(0,tt.Ay)({url:"/mes/watch/coalarmchannelsetup/query",method:"get",params:e})}function Ka(e){return(0,tt.Ay)({url:"/mes/watch/alarmwatch/read",method:"get",params:e})}var Za={data(){return{chartData:{xData:[],yData:[],seriesName:""},dialogshow:!1,currentPage:1,pageSize:32,array:[],queryParams:{pageNum:1,pageSize:1e4,plant:this.plant},componentKey:0,plantList:[],alarmHostList:[],plant_child_options:[],alarmChannelList:[],deviceParameterList:[],alarmDataMap:{},plant:"石灰厂",hostId:"",loading:!1,timerEnabled:!1,timer:void 0,curr_clickdata:{},addRowDialogVisible:!1,columns:[],feedbackInfo:[{label:"反馈信息",prop:"warnFeedback"},{label:"反馈处置人",prop:"responPerson"}],newRow:{warnFeedback:"",responPerson:"",alarmMeasures:""},loadingbtn:!1,timer_chart:null}},components:{chart:ut},computed:{totalItems(){return this.array.length},paginatedArray(){const e=(this.currentPage-1)*this.pageSize;return this.array.slice(e,e+this.pageSize)}},mounted(){this.getplantdata(),this.setTimer()},destroyed(){this.disableTimer()},methods:{async showmoreInfo(e){this.curr_clickdata=e,this.dialogshow=!0,this.disableTimer()},showInfoFunc(e){return`${e.internalNo}_${e.channelName}</br>${this.warningtype(e)}标准值：${e.normal?e.normal:"未设置"}；</br>低限值：${e.low?e.low:"未设置"}；低低限值：${e.lowlow?e.lowlow:"未设置"}；</br>高限值：${e.up?e.up:"未设置"}；高高限值：${e.upup?e.upup:"未设置"}；`},warningtype(e){let t=e.alarmValue;switch(!0){case-2==t:return'报警类型：<span class="yellow-warning">低低报</span></br>';case-1==t:return'报警类型：<span class="yellow-warning">低报</span></br>';case 1==t:return'报警类型：<span class="red-warning">高报</span></br>';case 2==t:return'报警类型：<span class="red-warning">高高报</span></br>';default:return""}},addRow(){},riskLevelHtml(e,t){if(e=String(e),t){if(7777==t)return'<span class="yellow-warning">通道备用</span>';if(9988==t)return'<span class="yellow-warning">故障</span>';switch(e){case"2":return'<span class="yellow-warning">黄色预警</span>';case"1":return'<span class="orange-warning">橙色预警</span>';case"3":return'<span class="red-warning">红色预警</span>';default:return"正常"}}else switch(e){case"2":return'<span class="yellow-warning">黄色预警</span>';case"1":return'<span class="orange-warning">橙色预警</span>';case"3":return'<span class="red-warning">红色预警</span>';default:return"正常"}},closeChart(){this.$refs.chartCom.disableTimerchart(),this.dialogshow=!1,this.setTimer()},confirm(e){this.columns=e},cancel(){},setTimer(){this.timer=setInterval(this.refreshWatchData,1e3),this.$once("hook:beforeDestory",(()=>{this.disableTimer()}))},disableTimer(){null!=this.timer&&(clearInterval(this.timer),this.timer=null)},async queryAlarmChannels(){if(this.hostId){var e={pageNum:1,pageSize:this.pageSize,hostId:this.hostId};this.array=[];let s=await Ga(e);console.log("resp",s),this.componentKey++,this.alarmChannelList=s.rows,this.paramIds=[],this.alarmDataMap={};for(var t=0;t<this.alarmChannelList.length;t++){var a=this.alarmChannelList[t].paramId,i={internalNo:this.alarmChannelList[t].internalNo,channelName:this.alarmChannelList[t].channelName,id:this.alarmChannelList[t].id,paramId:a,num:null,statuscode:0};let e=await st(a);e.data[0]&&(i.alarmValue=e.data[0].alarmValue,i.up=e.data[0].up,i.upup=e.data[0].upup,i.low=e.data[0].low,i.lowlow=e.data[0].lowlow,i.normal=e.data[0].normal),this.array.push(i),a&&!this.paramIds.includes(a)&&(this.alarmDataMap[a]=i,this.paramIds.length<255&&this.paramIds.push(a))}console.log("array",this.array),this.timerEnabled=!0,this.refreshWatchData()}},async getplantdata(){this.loading=!0,this.timerEnabled=!1;var e={pageNum:1,pageSize:1e4};let t=await Ha(e);if(200==t.code){if(this.alarmHostList=t.rows,this.plantList=[],this.alarmHostList)for(var a=0;a<this.alarmHostList.length;a++){var i=this.alarmHostList[a],s=i.plant;s&&(this.plant||(this.plant=s),this.plantList.includes(s)||this.plantList.push(s)),i.id&&!this.hostId&&(this.hostId=i.id)}this.plant_child_options=[];for(var o=0;o<this.alarmHostList.length;o++){i=this.alarmHostList[o];i.plant==this.plant&&this.plant_child_options.push(i)}if(console.log("plant_child_options",this.plant_child_options),!this.plant_child_options||this.plant_child_options.length<1)return;this.hostId=this.plant_child_options[0].id,this.queryAlarmChannels()}else this.$message({type:"warning",message:"登录已过期,自动重新登录",showClose:!0}),setTimeout((()=>{this.$router.push("/")}),2e3);this.loading=!1},changePlant(e){console.log("value",e),this.disableTimer(),this.plant_child_options=this.alarmHostList.filter((t=>t.plant==e)),console.log(this.plant_child_options),!this.plant_child_options||this.plant_child_options.length<1||this.plant_child_options.length&&(this.plant_child_options=this.plant_child_options.filter((e=>"炼钢厂5#主机"!=e.name&&"喷煤主机"!=e.name&&"供料主控室新主机"!=e.name&&"供料主控室旧主机"!=e.name&&"高炉主控室新增"!=e.name)),console.log("111",this.plant_child_options),this.hostId=this.plant_child_options[0].id,this.queryAlarmChannels())},async refreshWatchData(){if(!this.timerEnabled)return;var e=this.paramIds,t={paramIds:e,readChanged:!0,fromCache:!1};let a=await Ka(t);console.log("111",this.array);var i=a.rows;if(i=Array.from(new Set(a.rows.map((e=>e.paramId)))).map((e=>a.rows.find((t=>t.paramId===e)))),console.log(i),i)for(var s=0;s<i.length;s++){var o=i[s].paramId,l=i[s].value;i[s].timeStamp,i[s].lastUpdateTime;if(this.alarmDataMap[o]){var r=this.alarmDataMap[o];r=Object.assign(r,i[s]),this.array[s].num=l,this.array[s].statuscode=i[s].alarmState+""}}this.componentKey++},formatValue(e){return 0==e.num?"0.00":e.num?e.num.toFixed(2):""},getImageUrl(e){return"0"==String(e.statuscode)?a(18604):"1"==e.statuscode?a(60751):a(39472)},handleCurrentChange(e){this.currentPage=e}}},Qa=Za,Ya=(0,w.A)(Qa,qa,Xa,!1,null,null,null),ei=Ya.exports,ti=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788)}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["edit","delete","add"],gtType:e.gtType},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},ai=[],ii=function(){var e=this,t=e._self._c;return t("div",[t("el-row",{attrs:{type:"flex",justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"fit-content"}},[t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加煤气柜信息")])],1),t("el-col",[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),e.showSelect?t("div",{staticStyle:{width:"fit-content"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{staticStyle:{display:"flex","justify-content":"end"},attrs:{span:20}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0}}})],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,height:e.heightValue},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,3157869969)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(a,i){return"系统ID"!=a.label&&"ID"!=a.label?t("el-table-column",{key:i,attrs:{fit:"",prop:a.prop,label:a.label,sortable:a.sortable,width:"水冷氧枪监测指标"==a.prop?"410rem":""},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.editing?t("div",[t("el-input",{model:{value:i.row[a.prop],callback:function(t){e.$set(i.row,a.prop,t)},expression:"scope.row[column.prop]"}})],1):t("div",["煤气柜类型"==a.prop?t("span",[e._v(" "+e._s(e.formatShowData(i.row[a.prop]))+" ")]):"煤气柜类型"!=a.prop?t("span",[e._v(" "+e._s(i.row[a.prop])+" ")]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"煤气柜"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t},close:e.closeDialog}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"formNamedata",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.label?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.label}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"煤气柜类型"==a.prop?t("div",[t("el-radio-group",{on:{change:e.handleCheckedCitiesChange1},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.gtType,(function(a){return t("el-radio",{key:a.value,attrs:{label:a.value}},[e._v(e._s(a.label))])})),1)],1):"煤气柜类型"!=a.prop&&"运行状态"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("formNamedata")}}},[e._v("保存")]),t("el-button",{on:{click:function(t){e.addRowDialogVisible=!1}}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem",showClose:!1},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},si=[],oi={props:["column","tabledata","operate","gtType"],components:{Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,checkAll1:!1,checkAll2:!1,checkedData1:"",checkedData2:[],checkdata:["在用","停用","报废"],checkdata1:["高炉煤气","转炉煤气","焦炉煤气","其他"],isIndeterminate1:!0,isIndeterminate2:!0,operatetitle:"添加",rules_data:{},showsearch:!1,change_base:!1,loading:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:"",heightValue:"calc(100vh - 1.2rem)"}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){},methods:{confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},formatShowData(e){if(this.gtType.find((t=>t.value==e)))return this.gtType.find((t=>t.value==e)).label},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},changeBasic(e){["所属分厂","所属车间","安装地点","设备名称","状态"].indexOf(e)>=0&&(this.change_base=!0)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);console.log(e),this.$emit("searchparams",e)},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules(["规格（t）"],this.newRow)}))},closeDialog(){this.addRowDialogVisible=!1},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1},handleCheckAllChange1(e){this.checkedData1=e?this.checkdata1:[],this.isIndeterminate1=!1},handleCheckAllChange2(e){this.checkedData2=e?this.checkdata2:[],this.isIndeterminate2=!1},handleCheckedCitiesChange1(e){let t=e.length;this.checkAll1=t===this.checkdata1.length,this.isIndeterminate1=t>0&&t<this.checkdata1.length},handleCheckedCitiesChange2(e){console.log(e);let t=e.length;this.checkAll2=t===this.checkdata2.length,this.isIndeterminate2=t>0&&t<this.checkdata2.length},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.newRow=JSON.parse(JSON.stringify(e)),this.operatetitle="编辑"},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=JSON.parse(JSON.stringify(e)),this.rules_data=this.$formatFormRules(["规格（m3）"],this.newRow)})),this.operatetitle="编辑"},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}}},li=oi,ri=(0,w.A)(li,ii,si,!1,null,null,null),ni=ri.exports,ci={components:{BaseTable:ni},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{},filter_params:{},gtType:["高炉煤气","转炉煤气","焦炉煤气","其他"]}},methods:{chooseReport(e){"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},reportInfo(e){let t=e.checkevalue.map((e=>e.ID)),a={deviceType:"07",saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.$refs.basetable.loading_report=!0,t.length&&(this.loading=!0,_e.A.reportDevice(a).then((e=>{console.log(e.data),2e3==e.data.code?this.$message.success("上报成功！"+e.data.message):this.$message.error("上报失败！"+e.data.message),this.loading=!1,this.$refs.basetable.loading_report=!1})),console.log(a))},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3;let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag,this.editinfo(e,t)},async editinfo(e,t){this.$refs.basetable.loadingbtn=!0;let a,i={};if(t[0]["设备类型"]="煤气柜","编辑"==e.operate)i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},a=ye.A.updateGasbox({...i});else{let e=await this.$getId();console.log(t[0]),console.log(t[1]),t[0]["getId"]=e,i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1]))},a=ye.A.writeGasbox({...i})}console.log("info.operate ",i),a.then((t=>{200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(this.filter_params),this.$store.commit("changeDevice")})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$store.commit("changeDevice")}))},deleterow(e){console.log("删除",e),delete e.rowinfo["检验日期预报警状态"],this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata())})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1}))},searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),ye.A.readGasbox(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$refs.basetable&&(this.$refs.basetable.loading=!0);let a=t.data.data.map((e=>e.系统ID));_e.A.listReportStatus({systemIds:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.systemId===t.系统ID));return{...t,...a||{}}}));console.log(a),this.$set(this.tabledata,"data",a),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata(""),this.gtType=this.gtType.map(((e,t)=>({label:e,value:(t+1).toString()})))}},di=ci,hi=(0,w.A)(di,ti,ai,!1,null,null,null),pi=hi.exports,gi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788)}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["edit","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},ui=[],mi=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{type:"flex",justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"fit-content"}},[t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加信息")])],1),t("el-col",[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),e.showSelect?t("div",{staticStyle:{width:"fit-content"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{staticStyle:{display:"flex","justify-content":"end"},attrs:{span:20}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0}}})],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:"calc(100vh - 3.2rem)"},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,3157869969)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用/报废证明"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"检验报告上传"!=i.prop&&"停用/报废证明"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(s.row[i.prop].replace("T00:00:00","")))]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"连铸机"})}}},[e._v("导出数据")])],1),t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t},close:e.closeDialog}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.label&&"检验日期预报警状态"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):"运行状态"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},fi=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],wi={props:["column","tabledata","operate"],components:{Uploadocom:Ae},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["记录","不记录"],deviceKind2:["已锁","未锁"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rules_data:{},showsearch:!1,loading:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:""}},components:{Filtercom:ka},methods:{confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.rules_data=this.$formatFormRules([],this.newRow,{})})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules([],this.newRow,{})}))},closeDialog(){this.addRowDialogVisible=!1},addRow(e){console.log(this.newRow),this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},bi=wi,vi=(0,w.A)(bi,mi,fi,!1,null,null,null),yi=vi.exports,_i={components:{BaseTable:yi},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{},filter_params:{}}},methods:{chooseReport(e){"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},reportInfo(e){let t=e.checkevalue.map((e=>e.ID)),a={deviceType:"10",saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.$refs.basetable.loading_report=!0,t.length&&(this.loading=!0,_e.A.reportDevice(a).then((e=>{console.log(e.data),2e3==e.data.code?this.$message.success("上报成功！"+e.data.message):this.$message.error("上报失败！"+e.data.message),this.loading=!1,this.$refs.basetable.loading_report=!1})),console.log(a))},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3;let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag,this.editinfo(e,t)},async editinfo(e,t){this.$refs.basetable.loadingbtn=!0;let a,i={};if(t[0]["设备类型"]="连铸机","编辑"==e.operate)i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},a=ye.A.updateContinuous({...i});else{let e=await this.$getId();console.log(t[0]),console.log(t[1]),t[0]["getId"]=e,i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1]))},a=ye.A.writeContinuous({...i})}console.log("info.operate ",i),a.then((t=>{200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(this.filter_params),this.$store.commit("changeDevice")})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$store.commit("changeDevice")}))},deleterow(e){console.log("删除",e),delete e.rowinfo["检验日期预报警状态"],this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata())})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),ye.A.readContinuous(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$refs.basetable&&(this.$refs.basetable.loading=!0);let a=t.data.data.map((e=>e.系统ID));_e.A.listReportStatus({systemIds:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.systemId===t.系统ID));return{...t,...a||{}}}));console.log(a),this.$set(this.tabledata,"data",a),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata("")}},Si=_i,Di=(0,w.A)(Si,gi,ui,!1,null,null,null),Ri=Di.exports,ki=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"loadgif"}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["","delete","add"],cranetype:e.cranetype,craneFunctiontype:e.craneFunctiontype},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},$i=[],Ci=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"fit-content"}},[t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加信息")])],1),t("el-col",{staticStyle:{width:"fit-content"}},[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),e.showSelect?t("div",{staticStyle:{width:"5rem"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{attrs:{span:24}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态","检验日期","再检日期"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0,e.heightValue="calc(100vh - 3.8rem)"}}})],1),t("div",{staticClass:"table-container",style:{height:e.heightValue}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:"100%"},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,3157869969)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明"==i.prop||"报废证明"==i.prop||"图片描述"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验报告上传"!=i.prop&&"停用证明"!=i.prop&&"报废证明"!=i.prop&&"图片描述"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",["起重机品种"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop],"cranetype"))+" ")]):e._e(),"起重机类型"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop],"craneFunctiontype"))+" ")]):e._e(),"起重机类型"!=i.prop&&"起重机品种"!=i.prop?t("span",["检验类型"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop],"deviceKind2"))+" ")]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"吊运熔融金属起重机"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a,i){return"系统ID"!=a.label&&"ID"!=a.label&&"检验日期预报警状态"!=a.prop&&"停用证明"!=a.prop&&"报废证明"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"起重机品种"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.cranetype,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"起重机类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.craneFunctiontype,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"检验类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},attrs:{disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind2,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"检验报告上传"==a.prop?t("div",[""!==e.newRow[a.prop]||e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[e.newRow[a.prop]&&"添加"!=e.operatetitle?e._e():t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"起重机品种"!=a.prop&&"起重机类型"!=a.prop&&"检验报告上传"!=a.prop&&"运行状态"!=a.prop&&"报废证明"!=a.prop&&"停用证明"!=a.prop&&"检验类型"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"备注"==a.prop&&"编辑"==e.operatetitle?t("div",{staticStyle:{"font-size":"0.25rem","font-weight":"bold","margin-top":"0.4rem",color:"#007bff"}},[e._v(" 以下信息请至 企业日常管理数据页面 进行编辑 ")]):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},xi=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],Ii={props:["column","tabledata","operate","cranetype","craneFunctiontype"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind2:[{label:"定期检验",value:"1"},{label:"定期检定或校准",value:"2"},{label:"定期探伤",value:"3"}],deviceKind3:["炼铁铸铁车间吊运熔融金属起重机","炼钢车间冶金铸造起重机","其他"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rules_data:{},showsearch:!1,loading:!1,check_datas:["检验类型","检验结论","存在问题","检验单位","检验报告上传","检验日期","再检日期","报废证明","停用证明"],showSelect:!1,showSelectvalue:[],pre_currentPage:1,heightValue:"calc(100vh - 3.2rem)",messageinfo:""}},methods:{formatShowData(e,t){if(this[t].find((t=>t.value==e)))return this[t].find((t=>t.value==e)).label},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.rules_data=this.$formatFormRules([],this.newRow,{})})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},rulesCreate(){let e={};return this.check_datas.map((t=>e[t]={required:!1})),e},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.newRow["运行状态"]="在用",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules([],this.newRow,{})}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes(),this.$nextTick((()=>{this.heightValue=this.showsearch?"calc(100vh - 3.8rem)":"calc(100vh - 3.2rem)"}));const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},Ai=Ii,zi=(0,w.A)(Ai,Ci,xi,!1,null,null,null),Oi=zi.exports,Ti={components:{BaseTable:Oi},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{},filter_params:{},cranetype:["冶金桥式起重机","电动单梁起重机","电动葫芦桥式起重机","其他"],craneFunctiontype:["炼铁铸铁车间吊运熔融金属起重机","炼钢车间冶金铸造起重机","其他"]}},methods:{chooseReport(e){"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},async reportfuncimginfo(e){let t=e.checkevalue.map((e=>e["检验报告上传"]));for(const i of t)try{let e=await this.$reportimginfo(i,"4");e.data&&2e3!=e.data.code&&this.$message.error("检验报告上报失败")}catch(a){console.error(`上报失败: ${a.message}`)}},reportInfo(e){let t=e.checkevalue.map((e=>e.ID)),a={deviceType:"11",saveOrUpdate:"新增"==e.operate?1:2,ids:t};t.length&&(this.loading=!0,_e.A.reportDevice(a).then((t=>{console.log(t.data),2e3==t.data.code?this.$message.success("上报成功！"+t.data.message):this.$message.error("上报失败！"+t.data.message),this.reportfuncimginfo(e),this.loading=!1})),console.log(a))},searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3;let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,delete t[1].报废证明,delete t[1].停用证明,delete t[1].检验日期预报警状态,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag;let a=this.$assignValues("吊运熔融",t[1]);a[1]["检验日期"]=a[1]["检验日期"]?a[1]["检验日期"]:"",a[1]["再检日期"]=a[1]["再检日期"]?a[1]["再检日期"]:"",console.log(t[0]),console.log(a[0]),console.log(a[1]),this.editinfo(e,t,a)},async editinfo(e,t,a){this.$refs.basetable.loadingbtn=!0;let i,s={};if(t[0]["设备类型"]="吊运熔融金属起重机","编辑"==e.operate)s={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(a[0])),system_id:e.rowinfo.系统ID},i=ye.A.updateHangmachine({...s});else{let e=await this.$getId(),o=await this.$getId();console.log(t[0]),console.log(t[1]),t[0]["getId"]=e,a[1]["getId"]=o,s={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(a[0])),regular_check_data:JSON.stringify(Object.values(a[1]))},i=ye.A.writeHangmachine({...s})}console.log("info.operate ",s),i.then((t=>{200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(this.filter_params)})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},deleterow(e){console.log("删除",e),delete e.rowinfo["检验日期预报警状态"],console.log(e.rowinfo.ID),this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata())})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},openAddRowDialog(){this.$refs.basetable.addRowDialogVisible=!0,this.$nextTick((()=>{this.$refs.basetable.initialform()}))},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),ye.A.readHangmachine(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),"200"==t.data.code&&t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})));let a=t.data.data.map((e=>e.系统ID));_e.A.listReportStatus({systemIds:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.systemId===t.系统ID));return{...t,...a||{}}}));console.log(a),this.$set(this.tabledata,"data",a),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata(),this.cranetype=this.cranetype.map(((e,t)=>({label:e,value:(t+1).toString()}))),this.craneFunctiontype=this.craneFunctiontype.map(((e,t)=>({label:e,value:(t+1).toString()})))}},Vi=Ti,Pi=(0,w.A)(Vi,ki,$i,!1,null,null,null),Fi=Pi.exports,Ni=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["","delete","add"],tankType:e.tankType},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},ji=[],Wi=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.2rem"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加信息")]),t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),e.showSelect?t("div",{staticStyle:{width:"fit-content"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e(),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{attrs:{span:24}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态","检验日期","再检日期"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0,e.heightValue="calc(100vh - 4.4rem)"}}})],1),t("div",{staticClass:"table-container",style:{height:e.heightValue}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:"100%"},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,3157869969)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明"==i.prop||"报废证明"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"检验报告上传"!=i.prop&&"报废证明"!=i.prop&&"停用证明"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",["罐体设备类别"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop],"tankType"))+" ")]):t("span",["检验类型"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop],"deviceKind2"))+" ")]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])])])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"熔融金属罐体"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a,i){return"系统ID"!=a.label&&"ID"!=a.label&&"检验日期预报警状态"!=a.prop&&"停用证明"!=a.prop&&"报废证明"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"罐体设备类别"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.tankType,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"检验类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},attrs:{disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind2,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"检验报告上传"==a.prop?t("div",[""!==e.newRow[a.prop]||e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[e.newRow[a.prop]&&"添加"!=e.operatetitle?e._e():t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"罐体设备类别"!=a.prop&&"检验报告上传"!=a.prop&&"运行状态"!=a.prop&&"报废证明"!=a.prop&&"停用证明"!=a.prop&&"检验类型"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"备注"==a.prop&&"编辑"==e.operatetitle?t("div",{staticStyle:{"font-size":"0.25rem","font-weight":"bold","margin-top":"0.4rem",color:"#007bff"}},[e._v(" 以下信息请至 企业日常管理数据页面 进行编辑 ")]):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Mi=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],Li={props:["column","tabledata","operate","tankType"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["钢水罐","铁水罐","中间罐","渣罐"],deviceKind2:[{label:"定期检验",value:"1"},{label:"定期检定或校准",value:"2"},{label:"定期探伤",value:"3"}],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rules_data:{},showsearch:!1,loading:!1,check_datas:["检验类型","检验结论","存在问题","检验单位","检验报告上传","检验日期","再检日期","报废证明","停用证明"],showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:"",heightValue:"calc(100vh - 3.2rem)"}},methods:{formatShowData(e,t){if(this[t].find((t=>t.value==e)))return this[t].find((t=>t.value==e)).label},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.rules_data=this.$formatFormRules(["耳轴数量（个）","额定容量（t）"],this.newRow)})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},rulesCreate(){let e={};return this.check_datas.map((t=>e[t]={required:!1})),e},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules(["耳轴数量（个）","额定容量（t）"],this.newRow)}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes(),this.$nextTick((()=>{this.heightValue=this.showsearch?"calc(100vh - 3.8rem)":"calc(100vh - 3.2rem)"}));const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},Ei=Li,Ji=(0,w.A)(Ei,Wi,Mi,!1,null,null,null),Ui=Ji.exports,Bi={components:{BaseTable:Ui},data(){return{tabledata:{columns:[],data:[]},loading:!0,current_newinfo:{},filter_params:{},tankType:["钢水罐","铁水罐","中间罐","渣罐"]}},methods:{chooseReport(e){"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},async reportfuncimginfo(e){let t=e.checkevalue.map((e=>e["检验报告上传"]));for(const i of t)try{let e=await this.$reportimginfo(i,"4");e.data&&2e3!=e.data.code&&this.$message.error("检验报告上报失败")}catch(a){console.error(`上报失败: ${a.message}`)}},reportInfo(e){let t=e.checkevalue.map((e=>e.ID)),a={deviceType:"12",saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.$refs.basetable.loading_report=!0,t.length&&(this.loading=!0,_e.A.reportDevice(a).then((t=>{console.log(t.data),2e3==t.data.code?this.$message.success("上报成功！"+t.data.message):this.$message.error("上报失败！"+t.data.message),this.reportfuncimginfo(e),this.loading=!1,this.$refs.basetable.loading_report=!1})),console.log(a))},searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3;let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,delete t[1].报废证明,delete t[1].停用证明,delete t[1].检验日期预报警状态,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag;let a=this.$assignValues("金属熔融",t[1]);a[1]["检验日期"]=a[1]["检验日期"]?a[1]["检验日期"]+" 00:00:00":"",a[1]["再检日期"]=a[1]["再检日期"]?a[1]["再检日期"]+" 00:00:00":"",this.editinfo(e,t,a)},async editinfo(e,t,a){this.$refs.basetable.loadingbtn=!0;let i,s={};if(t[0]["设备类型"]="熔融金属罐体","编辑"==e.operate)s={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(a[0])),regular_check_data:JSON.stringify(Object.values(a[1])),system_id:e.rowinfo.系统ID},i=ye.A.updatemoltentaltank({...s});else{let e=await this.$getId(),o=await this.$getId();console.log(t[0]),console.log(t[1]),t[0]["getId"]=e,a[1]["getId"]=o,s={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(a[0])),regular_check_data:JSON.stringify(Object.values(a[1]))},i=ye.A.writemoltentaltank({...s})}i.then((t=>{200==t.data.code?(this.$message({message:e.operate+"成功",type:"success"}),this.$refs.basetable.addRowDialogVisible=!1):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.getdata(this.filter_params)})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$store.commit("changeDevice")}))},deleterow(e){console.log("删除",e),delete e.rowinfo["检验日期预报警状态"],this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata())})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),ye.A.readmoltentaltank(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),"200"==t.data.code&&t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$refs.basetable&&(this.$refs.basetable.loading=!0);let a=t.data.data.map((e=>e.系统ID));_e.A.listReportStatus({systemIds:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.systemId===t.系统ID));return{...t,...a||{}}}));console.log(a),this.$set(this.tabledata,"data",a),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata(),this.tankType=this.tankType.map(((e,t)=>({label:e,value:(t+1).toString()})))}},qi=Bi,Xi=(0,w.A)(qi,Ni,ji,!1,null,null,null),Hi=Xi.exports,Gi=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788)}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["edit","delete","add"],gpdShutoffType:e.gpdShutoffType,gpdGoggleType:e.gpdGoggleType,gpdGoggleDrivemode:e.gpdGoggleDrivemode},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},Ki=[],Zi=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{type:"flex",justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"fit-content"}},[t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加信息")])],1),t("el-col",[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),e.showSelect?t("div",{staticStyle:{width:"fit-content"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{staticStyle:{display:"flex","justify-content":"end"},attrs:{span:20}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0}}})],1),t("div",{staticClass:"table-container",style:{height:e.heightValue}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:"100%"},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"90rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,3157869969)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(a,i){return"系统ID"!=a.label&&"ID"!=a.label?t("el-table-column",{key:i,attrs:{fit:"",prop:a.prop,label:a.label,sortable:a.sortable},scopedSlots:e._u([{key:"default",fn:function(i){return[i.row.editing?e._e():t("div",["报废材料"==a.prop?t("div",{on:{click:function(t){return e.showbigimg(i.row[a.prop])}}},[i.row[a.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:i.row[a.prop]}}):t("span",[e._v("未上传")])]):"检验报告上传"!=a.prop&&"报废证明"!=a.prop?t("span",[a.prop.indexOf("日期")>=0?t("span",[e._v(e._s(i.row[a.prop].replace("T00:00:00","")))]):t("span",["切断阀类型"==a.prop?t("span",[e._v(" "+e._s(e.formatShowData(i.row[a.prop],"gpdShutoffType"))+" ")]):e._e(),"眼镜阀类型"==a.prop?t("span",[e._v(" "+e._s(e.formatShowData(i.row[a.prop],"gpdGoggleType"))+" ")]):e._e(),"眼镜阀驱动方式"==a.prop?t("span",[e._v(" "+e._s(e.formatShowData(i.row[a.prop],"gpdGoggleDrivemode"))+" ")]):"切断阀类型"!=a.prop&&"眼镜阀类型"!=a.prop&&"眼镜阀驱动方式"!=a.prop?t("span",[e._v(" "+e._s(i.row[a.prop])+" ")]):e._e()])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"煤气设施（管道）眼镜阀组合式隔断装置"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.label&&"检验日期预报警状态"!=a.prop&&"报废证明"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"切断阀类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.gpdShutoffType,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"眼镜阀类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.gpdGoggleType,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"眼镜阀驱动方式"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.gpdGoggleDrivemode,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"切断阀类型"!=a.prop&&"报废证明"!=a.prop&&"运行状态"!=a.prop&&"眼镜阀类型"!=a.prop&&"眼镜阀驱动方式"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Qi=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],Yi={props:["column","tabledata","operate","gpdShutoffType","gpdGoggleType","gpdGoggleDrivemode"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["蝶阀","闸阀","球阀","无"],deviceKind2:["扇形","敞开式","封闭式"],deviceKind3:["电动","液压","气动"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rules_data:{},showsearch:!1,change_base:!1,loading:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,heightValue:"calc(100vh - 3.2rem)",messageinfo:""}},methods:{formatShowData(e,t){if(this[t].find((t=>t.value==e)))return this[t].find((t=>t.value==e)).label},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);console.log(e),this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=JSON.parse(JSON.stringify(e)),this.rules_data=this.$formatFormRules([],this.newRow,{})})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules([],this.newRow,{})}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},es=Yi,ts=(0,w.A)(es,Zi,Qi,!1,null,null,null),as=ts.exports,is={components:{BaseTable:as},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{},filter_params:{},gpdShutoffType:["蝶阀","闸阀","球阀","其他"],gpdGoggleType:["扇形","敞开式","全封闭式","无"],gpdGoggleDrivemode:["电动","液压","气动"]}},methods:{chooseReport(e){"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},reportInfo(e){let t=e.checkevalue.map((e=>e.ID)),a={deviceType:"08",saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.loading=!0,t.length&&(this.loading=!0,_e.A.reportDevice(a).then((e=>{console.log(e.data),2e3==e.data.code?this.$message.success("上报成功！"+e.data.message):this.$message.error("上报失败！"+e.data.message),this.loading=!1})),console.log(a))},addinfo(e){delete e.rowinfo["key"],this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3,console.log("asas",this.current_newinfo);let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].报废证明,delete t[1].ID,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag,console.log(t),this.editinfo(e,t)},async editinfo(e,t){this.$refs.basetable.loadingbtn=!0;let a,i={};if(t[0]["设备类型"]="煤气设施（管道）眼镜阀组合式隔断装置","编辑"==e.operate)i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},a=ye.A.updateGaspartitiondevice({...i});else{let e=await this.$getId();console.log(t[0]),console.log(t[1]),t[0]["getId"]=e,i={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(t[1]))},a=ye.A.writeGaspartitiondevice({...i})}console.log("info.operate ",i),a.then((t=>{console.log(t.data),200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(this.filter_params),this.$store.commit("changeDevice")})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$store.commit("changeDevice")}))},deleterow(e){this.$refs.basetable.loadingbtn,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata(this.filter_params))})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn}))},searchparams(e){this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),ye.A.readGaspartitiondevice(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})));let a=t.data.data.map((e=>e.系统ID));_e.A.listReportStatus({systemIds:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.systemId===t.系统ID));return{...t,...a||{}}}));console.log(a),this.$set(this.tabledata,"data",a),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).cath((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata(""),this.gpdShutoffType=this.gpdShutoffType.map(((e,t)=>({label:e,value:(t+1).toString()}))),this.gpdGoggleType=this.gpdGoggleType.map(((e,t)=>({label:e,value:(t+1).toString()}))),this.gpdGoggleDrivemode=this.gpdGoggleDrivemode.map(((e,t)=>({label:e,value:(t+1).toString()})))}},ss=is,os=(0,w.A)(ss,Gi,Ki,!1,null,null,null),ls=os.exports,rs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"loadgif"}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,ini_columns:e.tabledata.ini_columns,tabledata:e.tabledata.data,operate:["","delete","add"],gdStructure:e.gdStructure},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},ns=[],cs=function(){var e=this,t=e._self._c;return t("div",[t("el-row",{attrs:{type:"flex",justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"2rem"}},[t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加信息")])],1),t("el-col",[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),e.showSelect?t("div",{staticStyle:{width:"fit-content"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{staticStyle:{display:"flex","justify-content":"end"},attrs:{span:20}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0}}})],1),t("div",{staticClass:"table-container",style:{height:e.heightValue}},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,height:"100%"},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"90rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,3157869969)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验/校准报告（标签）"==i.prop||"报废证明"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验/校准日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验/校准日期预报警状态"!=i.prop&&"检验/校准报告（标签）"!=i.prop&&"报废证明"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(s.row[i.prop].replace("T00:00:00","")))]):t("span",["结构类型"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop],"gdStructure"))+" ")]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])])]):e._e()])]}}],null,!0)},e._l(i.children,(function(a,s){return"水封高度"==i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:a.prop,label:a.label,sortable:a.sortable},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row["水封高度"+a.prop])+" ")]}}],null,!0)}):e._e()})),1):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"正压煤气管道水封式煤气排水器"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem",showClose:!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.ini_columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.label&&"水封高度mmH20"!=a.prop&&"报废证明"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.label}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"结构类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.gdStructure,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"检验/校准报告（标签）"==a.prop||"报废证明"==a.prop?t("div",[""==e.newRow[a.prop]?t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}}):t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])])],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"水封高度kPa"==a.prop?t("div",[t("el-input",{staticStyle:{width:"3rem"},attrs:{placeholder:"请输入水封高度（单位kPa）"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}),e._v(" （单位：kPa 1kPa=102mmH20） "),t("div",[e._v(" 对应mmH20值："),t("span",{staticStyle:{"font-weight":"bold",color:"white"}},[e._v(" "+e._s((102*e.newRow["水封高度kPa"]).toFixed(0))+" ")])])],1):e._e(),"水封高度mmH20"==a.prop?t("div",[e._v(" "+e._s((102*e.newRow["水封高度kPa"]).toFixed(0))+" ")]):"结构类型"!=a.prop&&"检验/校准报告（标签）"!=a.prop&&"运行状态"!=a.prop&&"报废证明"!=a.prop&&"水封高度kPa"!=a.prop&&"水封高度mmH20"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},ds=[],hs={props:["column","tabledata","operate","ini_columns","gdStructure"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["立式","卧式"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rulesNumber:{"腔室数量":[{required:!0,message:"请输入一个数字",trigger:"change"},{validator:this.validateNumber,trigger:"change"}]},otherdata:{"水封高度mmH20":""},rules_data:{},showsearch:!1,loading:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,heightValue:"calc(100vh - 3.2rem)",messageinfo:""}},methods:{formatShowData(e,t){if(this[t].find((t=>t.value==e)))return this[t].find((t=>t.value==e)).label},showSelectFunc(e){this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,this.$nextTick((()=>{this.$forceUpdate()}))},confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);console.log(e),this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},validateNumber(e,t,a){const i=parseInt(t,10);!i||i<1||i>12?a(new Error("请输入 1 到 12 之间的数字")):a()},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=JSON.parse(JSON.stringify(e)),this.rules_data=this.$formatFormRules(["水封高度kPa"],this.newRow,{}),this.rules_data["腔室数量"]=[{required:!0,message:"必填项",trigger:"change"},{validator:this.validateNumber,trigger:"change"}],this.rules_data["水封高度kPa"]=[{required:!0,message:"必填项",trigger:"change"},{pattern:/^(\d+(\.\d*)?|\.\d+)$/,message:"请输入一个数字",trigger:"change"}]})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules(["水封高度kPa"],this.newRow,{}),this.rules_data["腔室数量"]=[{required:!0,message:"必填项",trigger:"change"},{validator:this.validateNumber,trigger:"change"}],this.rules_data["水封高度kPa"]=[{required:!0,message:"必填项",trigger:"change"},{pattern:/^(\d+(\.\d*)?|\.\d+)$/,message:"请输入一个数字",trigger:"change"}]}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}},computed:{paginatedData(){this.columns=this.column?JSON.parse(JSON.stringify(this.column)):[],this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes(),this.ini_columns&&(this.newRow=this.ini_columns.reduce(((e,t)=>(e[t.prop]="",e)),{}));const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},ps=hs,gs=(0,w.A)(ps,cs,ds,!1,null,null,null),us=gs.exports,ms={components:{BaseTable:us},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{},filter_params:{},gdStructure:["立式","卧式"]}},methods:{chooseReport(e){"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},reportInfo(e){let t=e.checkevalue.map((e=>e.ID)),a={deviceType:"09",saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.loading=!0,t.length&&(this.loading=!0,_e.A.reportDevice(a).then((e=>{console.log(e.data),2e3==e.data.code?(this.$message.success("上报成功！"+e.data.message),this.$refs.basetable.showSelectvalue=[]):this.$message.error("上报失败！"+e.data.message),this.loading=!1})),console.log(a))},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["水封高度mmH20"]=(102*e.rowinfo["水封高度kPa"]).toFixed(0),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3,console.log("asas",this.current_newinfo);let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,delete t[1].报废证明,delete t[1].水封高度,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag;let a={"水封高度mmH20":"","水封高度kPa":"","结构类型":"","腔室数量":"","备注":""};for(let i in a)t[1].hasOwnProperty(i)&&(console.log(i),a[i]=t[1][i]);this.editinfo(e,t,a)},async editinfo(e,t,a){this.$refs.basetable.loadingbtn=!0;let i,s={};if(t[0]["设备类型"]="正压煤气管道水封式煤气排水器","编辑"==e.operate)s={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(a)),system_id:e.rowinfo.系统ID},i=ye.A.updateGasdrainer({...s});else{let e=await this.$getId();console.log(t[0]),console.log(t[1]),t[0]["getId"]=e,s={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(a))},i=ye.A.writeGasdrainer({...s})}console.log("info.operate ",s),i.then((t=>{console.log(t.data),200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(this.filter_params),this.$store.commit("changeDevice")})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn,this.$store.commit("changeDevice")}))},deleterow(e){this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata(this.filter_params))})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn}))},searchparams(e){this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),ye.A.readGasdrainer(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.ini_columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>e.indexOf("水封高度")>=0?{prop:"水封高度",label:"水封高度",children:[{prop:"mmH20",label:"mmH20"},{prop:"kPa",label:"kPa"}]}:{prop:e,label:e}));const a=new Map;this.tabledata.columns=this.tabledata.columns.filter((e=>!a.has(e.label)&&a.set(e.label,1)));let i=t.data.data.map((e=>e.系统ID));_e.A.listReportStatus({systemIds:i}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.systemId===t.系统ID));return{...t,...a||{}}}));console.log(a),this.$set(this.tabledata,"data",a),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata(),this.gdStructure=this.gdStructure.map(((e,t)=>({label:e,value:(t+1).toString()})))}},fs=ms,ws=(0,w.A)(fs,rs,ns,!1,null,null,null),bs=ws.exports,vs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"loadgif"}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},ys=[],_s=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{type:"flex",justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"fit-content"}},[t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加信息")])],1),t("el-col",[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),e.showSelect?t("div",{staticStyle:{width:"fit-content"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{staticStyle:{display:"flex","justify-content":"end"},attrs:{span:20}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0}}})],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:e.showsearch?"calc(100vh - 3.8rem)":"calc(100vh - 3.2rem)"},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,3157869969)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{prop:i.prop,label:i.label,sortable:i.sortable,minwidth:"120rem"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明"==i.prop||"报废证明"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"检验报告上传"!=i.prop&&"停用证明"!=i.prop&&"报废证明"!=i.prop?t("span",[i.prop.indexOf("日期")>=0&&s.row[i.prop]?t("span",[e._v(e._s(s.row[i.prop].replace("T00:00:00","")))]):t("span",["位置类型"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop],"position_type"))+" ")]):e._e(),"检验类型"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop],"deviceKind"))+" ")]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"固定式一氧化碳报警器"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem",showClose:!1,"close-on-click-modal":!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.label&&"检验日期预报警状态"!=a.prop&&"系统ID"!=a.label&&"停用证明"!=a.label&&"报废证明"!=a.label?t("el-form-item",{key:a.prop,attrs:{label:"位置类型"!=a.prop?a.label:"位置类型编码",prop:a.label}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"检验类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},attrs:{disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),"位置类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},attrs:{filterable:!0,disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.position_type,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),"检验报告上传"==a.prop||"停用证明"==a.prop||"报废证明"==a.prop?t("div",[""!==e.newRow[a.prop]||e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[e.newRow[a.prop]&&"添加"!=e.operatetitle?e._e():t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd",disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"检验类型"!=a.prop&&"位置类型"!=a.prop&&"检验报告上传"!=a.prop&&"运行状态"!=a.prop&&"停用证明"!=a.prop&&"报废证明"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{disabled:e.check_datas.indexOf(a.prop)>=0&&"编辑"==e.operatetitle,placeholder:"请输入"+a.label},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"备注"==a.prop&&"编辑"==e.operatetitle?t("div",{staticStyle:{"font-size":"0.25rem","font-weight":"bold","margin-top":"0.4rem",color:"#007bff"}},[e._v(" 以下信息请至 企业日常管理数据页面 进行编辑 ")]):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1),t("el-dialog",{attrs:{title:"位置类型编码",visible:e.tabledialog,modal:!1,top:"0.8rem",width:"9.5rem"},on:{"update:visible":function(t){e.tabledialog=t}}},[t("img",{staticStyle:{width:"9rem"},attrs:{src:a(4930)}})])],1):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,"page-sizes":e.pageSizes,total:e.total,layout:"total, prev, pager, next, sizes"},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Ss=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],Ds={props:["column","tabledata","operate"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:[{label:"A类（定期校验）",value:"1"},{label:"B类（定期校准）",value:"2"}],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rulesNumber:{number:[{required:!0,message:"请输入一个数字",trigger:"blur"},{validator:this.validateNumber,trigger:"blur"}]},rules_data:{},showsearch:!1,loading:!1,check_datas:["检验类型","检验结论","存在问题","检验单位","检验报告上传","检验日期","再检日期","报废证明","停用证明"],showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:"",tabledialog:!1,position_type:[{label:"会议室",value:"1001"},{label:"活动室",value:"1002"},{label:"休息室",value:"1003"},{label:"操作室",value:"1004"},{label:"化验室",value:"1005"},{label:"交接班室",value:"1006"},{label:"更衣室",value:"1007"},{label:"焦炉地下室，加热炉地下室、退火炉地下室、煤气柜进出口管道地下室",value:"2001"},{label:"加压机房",value:"2002"},{label:"烘烤器",value:"2003"},{label:"预热器",value:"2004"},{label:"高炉风口及以上各层平台（炉顶大方孔以上各层平台除外）",value:"2005"},{label:"高炉炉身平台",value:"2006"},{label:"高炉炉顶液压站",value:"2007"},{label:"高炉炉顶封闭式油泵间",value:"2008"},{label:"高炉炉顶封闭式工具间",value:"2009"},{label:"热风炉煤气自动切断阀操作平台",value:"2010"},{label:"喷煤干燥炉",value:"2011"},{label:"煤粉制备间",value:"2012"},{label:"煤气发电设施间（含 TRT 透平机隔音罩）",value:"2013"},{label:"煤气除尘器卸灰平台",value:"2014"},{label:"转炉炉口以上各层平台",value:"2015"},{label:"抽气机房",value:"2016"},{label:"煤气加热炉炉区",value:"2017"},{label:"煤气热处理炉炉区",value:"2018"},{label:"煤气柜活塞上部",value:"2019"},{label:"烧结球团主抽风机室",value:"2020"},{label:"烧结点火炉附近",value:"2021"},{label:"球团竖炉点火器附近",value:"2022"},{label:"球团回转窑点火器附近",value:"2023"},{label:"排水器房",value:"2024"},{label:"煤气预热炉炉区",value:"2025"},{label:"真空精炼装置的水封池",value:"2026"},{label:"机械真空泵房",value:"2027"},{label:"无",value:"无"}]}},methods:{formatShowData(e,t){if(this[t].find((t=>t.value==e)))return this[t].find((t=>t.value==e)).label},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:JSON.parse(JSON.stringify(this.showSelectvalue)),operate:this.messageinfo})}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},validateNumber(e,t,a){const i=parseInt(t,10);!i||i<1||i>12?a(new Error("请输入 1 到 12 之间的数字")):a()},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.rules_data=this.$formatFormRules(["量程PPM"],this.newRow,{})})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.newRow["运行状态"]="在用",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules(["量程PPM"],this.newRow,{})}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes(),this.formatRow();const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},Rs=Ds,ks=(0,w.A)(Rs,_s,Ss,!1,null,null,null),$s=ks.exports,Cs={components:{BaseTable:$s},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{},filter_params:{}}},methods:{chooseReport(e){"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},async reportfuncimginfo(e){let t=e.checkevalue.map((e=>e["检验报告上传"]));for(const i of t)try{let e=await this.$reportimginfo(i,"4");e.data&&2e3!=e.data.code&&this.$message.error("检验报告上报失败")}catch(a){console.error(`上报失败: ${a.message}`)}},reportInfo(e){let t=e.checkevalue.map((e=>e.ID)),a={deviceType:"13",saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.loading=!0,t.length&&(this.loading=!0,_e.A.reportDevice(a).then((t=>{console.log(t.data),2e3==t.data.code?this.$message.success("上报成功！"+t.data.message):this.$message.error("上报失败！"+t.data.message),this.reportfuncimginfo(e),this.loading=!1})),console.log(a))},searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3;let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,delete t[1].报废证明,delete t[1].停用证明,delete t[1].检验日期预报警状态,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag;let a=this.$assignValues("一氧化碳报警器",t[1]);a[1]["检验日期"]=a[1]["检验日期"]?a[1]["检验日期"]:"",a[1]["再检日期"]=a[1]["再检日期"]?a[1]["再检日期"]:"",console.log(t[0]),console.log(a[0]),console.log(a[1]),this.editinfo(e,t,a)},async editinfo(e,t,a){this.$refs.basetable.loadingbtn=!0;let i,s={};if(t[0]["设备类型"]="固定式一氧化碳报警器","编辑"==e.operate)s={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(a[0])),regular_check_data:JSON.stringify(Object.values(a[1])),system_id:e.rowinfo.系统ID},i=ye.A.updateCoalarm({...s});else{let e=await this.$getId(),o=await this.$getId();console.log(t[0]),console.log(t[1]),t[0]["getId"]=e,a[1]["getId"]=o,s={dimension_data:JSON.stringify(Object.values(t[0])),data:JSON.stringify(Object.values(a[0])),regular_check_data:JSON.stringify(Object.values(a[1]))},i=ye.A.writeCoalarm({...s})}console.log("info.operate ",s),i.then((t=>{200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(this.filter_params)})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},deleterow(e){console.log("删除",e),delete e.rowinfo["检验日期预报警状态"],console.log(e.rowinfo.ID),this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata(this.filter_params))})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},openAddRowDialog(){this.$refs.basetable.addRowDialogVisible=!0,this.$nextTick((()=>{this.$refs.basetable.initialform()}))},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),ye.A.readCoalarm(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),"200"==t.data.code&&t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})));let a=t.data.data.map((e=>e.系统ID));_e.A.listReportStatus({systemIds:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.systemId===t.系统ID));return{...t,...a||{}}}));console.log(a),this.$set(this.tabledata,"data",a),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata()}},xs=Cs,Is=(0,w.A)(xs,vs,ys,!1,null,null,null),As=Is.exports,zs=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams}}),t("div",{staticClass:"echarts-foot"})],1)},Os=[],Ts=function(){var e=this,t=e._self._c;return t("div",[t("el-row",{attrs:{type:"flex",justify:"end"}}),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,height:e.heightvalue}},[e.operate[0]||e.operate[1]?t("el-table-column",{attrs:{label:"操作",minWidth:"100rem"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticStyle:{"font-size":"0.175rem","margin-top":"-0.1rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,2421084819)}):e._e(),e._l(e.columns.slice(0,7),(function(a,i){return"系统ID"!=a.label&&"ID"!=a.label?t("el-table-column",{key:i,attrs:{fit:"",prop:a.prop,label:a.label,sortable:a.sortable},scopedSlots:e._u([{key:"default",fn:function(i,s){return[t("span",[e._v(" "+e._s(i.row[a.prop])+" ")])]}}],null,!0)}):e._e()})),t("el-table-column",{key:"熔融金属紧急排放和应急储存设施配置",attrs:{fit:"",prop:"熔融金属紧急排放和应急储存设施配置",label:"熔融金属紧急排放和应急储存设施配置"}},[t("el-table-column",{attrs:{prop:"中间罐溢流坑（槽）",label:"中间罐溢流坑（槽）"}},[t("el-table-column",{attrs:{prop:"中间罐溢流坑（槽）数量（个）",label:"数量（个）"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{class:a.row["中间罐溢流坑（槽）数量（个）图片"]?"specialCell":""},[e._v(" "+e._s(a.row["中间罐溢流坑（槽）数量（个）"])+" ")]),e._l(String(a.row["中间罐溢流坑（槽）数量（个）图片"]).split("|"),(function(i){return a.row["中间罐溢流坑（槽）数量（个）图片"]?t("img",{key:i,staticStyle:{width:"1rem","margin-bottom":"0.1rem"},attrs:{src:i},on:{click:function(t){return e.showbigimg(i)}}}):e._e()}))]}}])})],1),t("el-table-column",{attrs:{prop:"漏钢回转溜槽",label:"漏钢回转溜槽"}},[t("el-table-column",{attrs:{prop:"漏钢回转溜槽数量（个）",label:"数量（个）"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{class:a.row["漏钢回转溜槽数量（个）图片"]?"specialCell":""},[e._v(" "+e._s(a.row["漏钢回转溜槽数量（个）"])+" ")]),e._l(String(a.row["漏钢回转溜槽数量（个）图片"]).split("|"),(function(i){return a.row["漏钢回转溜槽数量（个）图片"]?t("img",{key:i,staticStyle:{width:"1rem","margin-bottom":"0.1rem"},attrs:{src:i},on:{click:function(t){return e.showbigimg(i)}}}):e._e()}))]}}])})],1),t("el-table-column",{attrs:{prop:"事故钢水罐配置",label:"事故钢水罐配置"}},[t("el-table-column",{attrs:{prop:"事故钢水罐配置有效容积（m3）",label:"有效容积（m3）"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{class:a.row["事故钢水罐配置有效容积（m3）图片"]?"specialCell":""},[e._v(" "+e._s(a.row["事故钢水罐配置有效容积（m3）"])+" ")]),e._l(String(a.row["事故钢水罐配置有效容积（m3）图片"]).split("|"),(function(i){return a.row["事故钢水罐配置有效容积（m3）图片"]?t("img",{key:i,staticStyle:{width:"1rem","margin-bottom":"0.1rem"},attrs:{src:i},on:{click:function(t){return e.showbigimg(i)}}}):e._e()}))]}}])}),t("el-table-column",{attrs:{prop:"事故钢水罐配置额定盛装量（t）",label:"额定盛装量（t）"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{class:a.row["事故钢水罐配置额定盛装量（t）图片"]?"specialCell":""},[e._v(" "+e._s(a.row["事故钢水罐配置额定盛装量（t）"])+" ")]),e._l(String(a.row["事故钢水罐配置额定盛装量（t）图片"]).split("|"),(function(i){return a.row["事故钢水罐配置额定盛装量（t）图片"]?t("img",{key:i,staticStyle:{width:"1rem","margin-bottom":"0.1rem"},attrs:{src:i},on:{click:function(t){return e.showbigimg(i)}}}):e._e()}))]}}])})],1),t("el-table-column",{attrs:{prop:"中间罐漏钢坑（槽）",label:"中间罐漏钢坑（槽）"}},[t("el-table-column",{attrs:{prop:"中间罐漏钢坑（槽）数量（个）",label:"数量（个）"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{class:a.row["中间罐漏钢坑（槽）数量（个）图片"]?"specialCell":""},[e._v(" "+e._s(a.row["中间罐漏钢坑（槽）数量（个）"])+" ")]),e._l(String(a.row["中间罐漏钢坑（槽）数量（个）图片"]).split("|"),(function(i){return a.row["中间罐漏钢坑（槽）数量（个）图片"]?t("img",{key:i,staticStyle:{width:"1rem","margin-bottom":"0.1rem"},attrs:{src:i},on:{click:function(t){return e.showbigimg(i)}}}):e._e()}))]}}])}),t("el-table-column",{attrs:{prop:"中间罐漏钢坑（槽）有效容积（m3）",label:"有效容积（m3）"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{class:a.row["中间罐漏钢坑（槽）有效容积（m3）图片"]?"specialCell":""},[e._v(" "+e._s(a.row["中间罐漏钢坑（槽）有效容积（m3）"])+" ")]),e._l(String(a.row["中间罐漏钢坑（槽）有效容积（m3）图片"]).split("|"),(function(i){return a.row["中间罐漏钢坑（槽）有效容积（m3）图片"]?t("img",{key:i,staticStyle:{width:"1rem","margin-bottom":"0.1rem"},attrs:{src:i},on:{click:function(t){return e.showbigimg(i)}}}):e._e()}))]}}])}),t("el-table-column",{attrs:{prop:"中间罐漏钢坑（槽）额定盛装量（t）",label:"额定盛装量（t）"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{class:a.row["中间罐漏钢坑（槽）额定盛装量（t）图片"]?"specialCell":""},[e._v(" "+e._s(a.row["中间罐漏钢坑（槽）额定盛装量（t）"])+" ")]),e._l(String(a.row["中间罐漏钢坑（槽）额定盛装量（t）图片"]).split("|"),(function(i){return a.row["中间罐漏钢坑（槽）额定盛装量（t）图片"]?t("img",{key:i,staticStyle:{width:"1rem","margin-bottom":"0.1rem"},attrs:{src:i},on:{click:function(t){return e.showbigimg(i)}}}):e._e()}))]}}])})],1)],1)],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"炼钢（连铸）生产过程熔融金属紧急排放和应急储存设施"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem",showClose:!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.label&&"检验/校准日期预报警状态"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.label}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"检验/校准类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),a.prop.indexOf("图片")>=0?t("div",[t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2,filelistdata:e.newRow[a.prop]?e.newRow[a.prop]:[]},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}}),t("div",e._l(e.newRow[a.prop],(function(i){return t("div",{staticStyle:{width:"1rem",float:"left","margin-right":"0.1rem"}},[e.newRow[a.prop].length?t("img",{key:i,staticStyle:{width:"1rem",height:"1rem",margin:"0.1rem 0.1rem 0 0"},attrs:{src:i},on:{click:function(t){return e.showbigimg(i)}}}):e._e(),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop,i)}}},[e._v("取消")])])])})),0)],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):a.prop.indexOf("图片")<0&&"运行状态"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc},on:{click:function(t){return e.showbigimg(e.imgs)}}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Vs=[],Ps=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{display:"inline-block"}},[t("el-upload",{staticStyle:{display:"inline-block"},attrs:{action:e.uploadUrl,name:"file","on-success":e.handleSuccess,"on-error":e.handleError,"before-upload":e.beforeUpload,"show-file-list":!1}},[t("i",{staticClass:"el-icon-upload2 download"}),e.loading?t("img",{staticClass:"loadgif",staticStyle:{width:"0.3rem"},attrs:{src:a(18788),id:"show_loading2"}}):e._e(),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(" 只能上传jpg/png/jpeg文件，且不超过500kb ")])])],1)},Fs=[],Ns={props:["uploadAction","showloading2","filelistdata"],data(){return{actionAddress:"",ifAction:!1,uploadUrl:"",filelist:[],loading:!1}},methods:{handleSuccess(e){document.getElementById(this.showloading2).style.display="none",console.log(e),"200"==e.code?(this.$message({type:"success",message:"上传成功"}),this.filelist.push(e.url),this.$emit("imageshow",this.filelist)):"File with the same name already exists"==e.msg&&(this.$message({dangerouslyUseHTMLString:!0,message:"有重复文件名存在!请更改文件名重新上传！",duration:0,showClose:!0,type:"warning"}),this.ifAction=!1),this.loading=!1},async beforeUpload(e){console.log(e.size/1024/1024/1024*1e6),this.loading=!0,this.uploadUrl="";var t=new Array;t=e.name.split(".");const a="png"===t[t.length-1],i="jpg"===t[t.length-1],s="jpeg"===t[t.length-1],o=e.size/1024/1024/1024*1e6;if(console.log(o),a||i||s){if(!(o>500)){await this.$confirm("确定上传文件？","提示",{distinguishCancelAndClose:!0,confirmButtonText:"上传",cancelButtonText:"取消"}).then((()=>(this.uploadUrl=this.uploadAction,this.ifAction=!0,!0))).catch((()=>!1));return a||i}this.$message({message:"文件大于500kb！",type:"warning"})}else this.$message({message:"上传模板只能是png、jpg格式!",type:"warning"}),this.ifAction=!1},handleError(e){console.log(e),console.log(this.showloading2x),e&&String(e).indexOf("<!DOCTYPE html>")<0&&this.$message({message:"上传失败",type:"warning",duration:0,showClose:!0}),document.getElementById(this.showloading2).style.display="none",this.ifAction=!1}},mounted(){this.filelist=this.filelistdata?JSON.parse(JSON.stringify(this.filelistdata)):[]},computed:{files(){return this.filelistdata}},watch:{files(){this.filelist=this.filelistdata?JSON.parse(JSON.stringify(this.filelistdata)):[]}}},js=Ns,Ws=(0,w.A)(js,Ps,Fs,!1,null,null,null),Ms=Ws.exports,Ls=a(99955),Es={props:["column","tabledata","operate"],components:{Uploadocom:Ms,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["定期检验","定期校准"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rulesNumber:{number:[{required:!0,message:"请输入一个数字",trigger:"blur"},{validator:this.validateNumber,trigger:"blur"}]},heightvalue:"",rules_data:{},showsearch:!1,change_base:!1,loading:!1,check_datas:["所属分厂","所属车间","设备名称","企业内部编号","安装地点","运行状态","设备编码"],write_flag:!1}},methods:{searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},showcellimg(e,t){this.$set(this.paginatedData[e.$index],"imgsource",e.row[t]),this.$set(e.row,"imgsource",e.row[t]),console.log(this.paginatedData[e.$index]),this.$forceUpdate()},validateNumber(e,t,a){const i=parseInt(t,10);!i||i<1||i>12?a(new Error("请输入 1 到 12 之间的数字")):a()},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e,t){this.newRow[e]=this.newRow[e].filter((e=>e!=t))},imageshowFunc(e,t){this.newRow[t]=e,console.log("图",this.newRow[t])},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.currentPage=e,this.pre_currentPage=e},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用"}))},editRow(e){this.addRowDialogVisible=!0,this.write_flag=!1,console.log(e);let t=(0,Ls.aJ)(void 0,e),a=JSON.parse(JSON.stringify(t[1]));delete a.系统ID,this.write_flag=(0,Ls.ZF)(a),this.$nextTick((()=>{this.newRow=JSON.parse(JSON.stringify(e));for(let t in e)t.indexOf("图片")>=0&&(this.newRow[t]=e[t]?e[t].split("|"):[]);this.operatetitle="编辑"}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle,write_flag:this.write_flag})}))},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]=t.prop.indexOf("图片")>=0?[]:"",e)),{})}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const e=(this.currentPage-1)*this.pageSize;return setTimeout((()=>{this.heightvalue="calc(100vh - 3.2rem)"}),2e3),this.tableData.slice(e,e+this.pageSize)}},mounted(){this.rules_data=this.$formatFormRules(["中间罐溢流坑（槽）数量（个）","中间罐溢流坑（槽）数量（个）","漏钢回转溜槽数量（个）","事故钢水罐配置有效容积（m3）","事故钢水罐配置额定盛装量（t）","中间罐漏钢坑（槽）数量（个）","中间罐漏钢坑（槽）有效容积（m3）","中间罐漏钢坑（槽）额定盛装量（t）"],this.newRow,{"中间罐溢流坑（槽）数量（个）图片":{required:!1},"中间罐溢流坑（槽）数量（个）图片":{required:!1},"漏钢回转溜槽数量（个）图片":{required:!1},"事故钢水罐配置有效容积（m3）图片":{required:!1},"事故钢水罐配置额定盛装量（t）图片":{required:!1},"中间罐漏钢坑（槽）数量（个）图片":{required:!1},"中间罐漏钢坑（槽）有效容积（m3）图片":{required:!1},"中间罐漏钢坑（槽）额定盛装量（t）图片":{required:!1}})}},Js=Es,Us=(0,w.A)(Js,Ts,Vs,!1,null,null,null),Bs=Us.exports,qs={components:{BaseTable:Bs},data(){return{tabledata:{columns:[],data:[]},loading:!0,current_newinfo:{},filter_params:{}}},methods:{searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3;let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,console.log(t[1]);for(let a in t[1])a.indexOf("图片")>=0&&(t[1][a]=t[1][a]?t[1][a].join("|"):"");this.editinfo(e,t,e.write_flag)},editinfo(e,t,a){this.$refs.basetable.loadingbtn=!0;let i,s={};a?(s={data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},i=ye.A.writeEmergencyfac({...s})):(s={data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},i=ye.A.updateEmergencyfac({...s})),console.log("info.operate ",s),i.then((t=>{200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.write_flag=!1,this.getdata(this.filter_params)})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.write_flag=!1}))},deleterow(e){console.log("删除",e),delete e.rowinfo["检验日期预报警状态"],console.log(e.rowinfo.ID),this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata())})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},openAddRowDialog(){this.$refs.basetable.addRowDialogVisible=!0,this.$nextTick((()=>{this.$refs.basetable.initialform()}))},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),e={device_name:["3#方坯连铸机","1#方坯连铸机","2#方坯连铸机","板坯连铸机"]},ye.A.readEmergencyfac(e?{filter:JSON.stringify({...e})}:"").then((t=>{console.log(t.data.data),"200"==t.data.code&&t.data.data[0]&&(e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$set(this.tabledata,"data",t.data.data)),this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata()}},Xs=qs,Hs=(0,w.A)(Xs,zs,Os,!1,null,null,null),Gs=Hs.exports,Ks=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams}}),t("div",{staticClass:"echarts-foot"})],1)},Zs=[],Qs=function(){var e=this,t=e._self._c;return t("div",[t("el-row",{attrs:{type:"flex",justify:"end"}}),e._m(0),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:"calc(100vh - 3.2rem)"}},[e.operate[0]||e.operate[1]?t("el-table-column",{attrs:{label:"操作",minWidth:"100rem"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,3054568933)}):e._e(),e._l(e.columns.slice(0,8),(function(a,i){return"系统ID"!=a.label&&"ID"!=a.label?t("el-table-column",{key:i,attrs:{fit:"",prop:a.prop,label:a.label,sortable:a.sortable},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(" "+e._s(i.row[a.prop])+" ")])]}}],null,!0)}):e._e()})),t("el-table-column",{key:"高炉炉顶放散阀",attrs:{fit:"",prop:"高炉炉顶放散阀",label:"高炉炉顶放散阀"}},e._l(e.columns.slice(8),(function(a,i){return t("el-table-column",{key:i,attrs:{fit:"",prop:a.prop,label:a.label,sortable:a.sortable},scopedSlots:e._u([{key:"default",fn:function(i){return[t("span",[e._v(" "+e._s(i.row[a.prop])+" ")])]}}],null,!0)})})),1)],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"高炉生产过程炉顶放散阀联锁放散压力设定"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem",showClose:!1},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.label&&"检验/校准日期预报警状态"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.label}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"检验/校准类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),"检验/校准报告（标签）"==a.prop||"停用证明资料"==a.prop?t("div",[""==e.newRow[a.prop]?t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}}):t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])])],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"检验/校准类型"!=a.prop&&"检验/校准报告（标签）"!=a.prop&&"运行状态"!=a.prop&&"停用证明资料"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Ys=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],eo={props:["column","tabledata","operate"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["定期检验","定期校准"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rulesNumber:{number:[{required:!0,message:"请输入一个数字",trigger:"blur"},{validator:this.validateNumber,trigger:"blur"}]},rules_data:{},showsearch:!1,change_base:!1,loading:!1,check_datas:["所属分厂","所属车间","设备名称","企业内部编号","安装地点","运行状态","设备编码"],write_flag:!1}},methods:{searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},validateNumber(e,t,a){const i=parseInt(t,10);!i||i<1||i>12?a(new Error("请输入 1 到 12 之间的数字")):a()},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.currentPage=e,this.pre_currentPage=e},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.write_flag=!1,console.log(e);let t=(0,Ls.aJ)(void 0,e),a=JSON.parse(JSON.stringify(t[1]));delete a.系统ID,this.write_flag=(0,Ls.ZF)(a),this.$nextTick((()=>{this.newRow=JSON.parse(JSON.stringify(e));for(let t in e)t.indexOf("图片")>=0&&(this.newRow[t]=e[t]?e[t].split("|"):[]);this.operatetitle="编辑"}))},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},openAddRowDialog(){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用"}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle,write_flag:this.write_flag})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const e=(this.currentPage-1)*this.pageSize;return setTimeout((()=>{this.heightvalue="calc(100vh - 3.2rem)"}),2e3),this.tableData.slice(e,e+this.pageSize)}},mounted(){}},to=eo,ao=(0,w.A)(to,Qs,Ys,!1,null,null,null),io=ao.exports,so={components:{BaseTable:io},data(){return{tabledata:{columns:[],data:[]},loading:!0,current_newinfo:{},filter_params:{}}},methods:{searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata({...e})},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3,console.log("1223",this.current_newinfo);let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,this.editinfo(e,t,e.write_flag)},editinfo(e,t,a){this.$refs.basetable.loadingbtn=!0;let i,s={};a?(s={data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},i=ye.A.writeReliefset({...s})):(s={data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},i=ye.A.updateReliefset({...s})),console.log("info.operate ",s),i.then((t=>{200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.write_flag=!1,this.getdata(this.filter_params)})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.write_flag=!1}))},deleterow(e){console.log("删除",e),delete e.rowinfo["检验日期预报警状态"],console.log(e.rowinfo.ID),this.$refs.basetable.loadingbtn=!0,ye.A.deleteDeviceinfo({system_id:e.rowinfo.系统ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata())})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},openAddRowDialog(){this.$refs.basetable.addRowDialogVisible=!0,this.$nextTick((()=>{this.$refs.basetable.initialform()}))},getdata(e){this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0),e={device_name:["2#高炉","1#高炉"]},ye.A.readReliefset(e?{filter:JSON.stringify({...e})}:"").then((t=>{console.log(t.data.data),"200"==t.data.code&&t.data.data[0]&&(e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$set(this.tabledata,"data",t.data.data)),this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata()}},oo=so,lo=(0,w.A)(oo,Ks,Zs,!1,null,null,null),ro=lo.exports,no=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"loadgif"}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},co=[],ho=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"2rem"}}),t("el-col",{attrs:{span:18}},[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary"},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),t("span",{staticStyle:{color:"white"}},[e._v("仅满足以下条件的数据可上报：1、已经新增上报成功的设备 2、已经进行点检操作过的设备")]),e.showSelect?t("div",{staticStyle:{width:"5rem"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{attrs:{span:24}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态","检验日期","再检日期"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0,e.heightValue="calc(100vh - 3.8rem)"}}})],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:(e.showsearch,"calc(100vh - 3.3rem)")},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",width:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"deletbtn",staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small",disabled:null==a.row["ID"]},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small",disabled:null==a.row["ID"]},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")]),t("br"),t("el-button",{staticStyle:{"font-size":"0.175rem","margin-left":"0",color:"#00c93b"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.openAddRowDialog(a.row)}}},[e._v(" 点检 ")]),t("el-button",{staticStyle:{"font-size":"0.175rem",color:"rgb(212 158 78)"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.viewhistory(a.row)}}},[e._v(" 历史 ")])]}}],null,!1,331200930)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.column,(function(i,s){return"系统ID"!=i.label&&"设备编码"!=i.label&&"点检事项"!=i.label&&"点检序号"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明"==i.prop||"报废证明"==i.prop||"图片描述"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"停用证明"!=i.prop&&"报废证明"!=i.prop&&"图片描述"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"点检记录"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem"},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a,i){return"ID"!=a.label&&"系统ID"!=a.label&&"检验日期预报警状态"!=a.prop&&"停用证明"!=a.label&&"报废证明"!=a.label&&"点检事项"!=a.label&&"点检序号"!=a.label&&"设备编码"!=a.label?t("el-form-item",{key:a.prop,attrs:{label:"问题描述"!=a.label?a.label:"异常"==e.newRow["点检结果"]?"问题描述":"",prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"点检标准"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),"点检结果"==a.prop?t("el-select",{staticStyle:{width:"8rem"},on:{change:e.changeStatus},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind2,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),"图片描述"==a.prop?t("div",[e.newRow[a.prop]?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"运行状态"!=a.prop&&"图片描述"!=a.prop&&"点检标准"!=a.prop&&"点检结果"!=a.prop&&"问题描述"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"异常"==e.newRow["点检结果"]&&"问题描述"==a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),t("el-dialog",{attrs:{modal:!1,visible:e.his_visible,title:"本设备历史数据",fullscreen:"","custom-class":"historydialog"},on:{"update:visible":function(t){e.his_visible=t}}},[e.his_visible?t("historyDialog",{ref:"history",attrs:{current_info:e.newRow}}):e._e()],1)],1)},po=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],go=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{type:e.showsearch?"":"flex",justify:"end"}}),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.tabledata.data,"cell-class-name":e.getCellClassName,height:(e.showsearch,"calc(100vh - 3.3rem)")}},[t("el-table-column",{attrs:{label:"操作",minWidth:"100rem"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}])}),e._l(e.tabledata.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable,"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明"==i.prop||"报废证明"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"图片描述"!=i.prop&&"报废证明"!=i.prop&&"停用证明"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]}}],null,!0)}):e._e()}))],2)],1),t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem"},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.tabledata.columns,(function(a,i){return"ID"!=a.label&&"系统ID"!=a.label&&"检验日期预报警状态"!=a.prop&&"停用证明"!=a.label&&"报废证明"!=a.label?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"起重机品种"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),"图片描述"==a.prop?t("div",[e.newRow[a.prop]?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"运行状态"!=a.prop&&"图片描述"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"备注"==a.prop&&"编辑"==e.operatetitle?t("div",{staticStyle:{"font-size":"0.25rem","font-weight":"bold","margin-top":"0.4rem",color:"#007bff"}},[e._v(" 以下信息请至 企业日常管理数据页面 进行编辑 ")]):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},uo=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],mo={props:["current_info"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["通用桥式起重机","冶金桥式起重机","电动单梁起重机","电动葫芦桥式起重机"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加设备点检记录",rules_data:{"点检日期":[{required:!0,message:"不能为空",trigger:"change"}],"再检日期":[{required:!0,message:"不能为空",trigger:"change"}]},showsearch:!1,loading:!1,check_datas:["所属分厂","所属车间","设备名称","企业内部编号","安装地点","运行状态","设备编码"],his_visible:!1,tabledata:{data:[],columns:[]}}},methods:{viewhistory(e){this.his_visible=!0,this.newRow=Object.assign({},e)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.getdata(e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加设备点检记录",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e)})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},deleteRow(e){ye.A.deleteCheckout({system_id:e.系统ID,record_id:e.ID}).then((e=>{console.log(e.data),200==e.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.addRowDialogVisible=!1,this.confirmDeleteDialogVisible=!1,this.getdata()})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"})}))},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},rulesCreate(){let e={};return this.check_datas.map((t=>e[t]={required:!1})),e},openAddRowDialog(e){this.addRowDialogVisible=!0,this.operatetitle="添加设备点检记录",this.$nextTick((()=>{this.formatRow(),this.newRow=Object.assign({},e),this.newRow["运行状态"]="在用"}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;{let e=JSON.parse(JSON.stringify(this.newRow)),t=this.$assignValues(void 0,e);delete t[1].系统ID,delete t[1].ID,delete t[1].报废证明,delete t[1].停用证明,delete t[1].检验日期预报警状态,delete t[1].设备编码;let a={record_id:this.newRow.ID,system_id:this.newRow.系统ID,check_data:JSON.stringify(Object.values(t[1]))};ye.A.updateCheckout({...a}).then((e=>{200==e.data.code?(this.$message({message:"编辑成功",type:"success"}),this.loadingbtn=!1,this.addRowDialogVisible=!1,this.getdata()):this.$message({message:"失败稍后重试！",type:"error"})}))}}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})},getdata(){this.$set(this.tabledata,"data",[]),this.loading=!0,ye.A.OnedeviceCheckout({system_id:this.current_info.系统ID}).then((e=>{"200"==e.data.code&&e.data.data[0]&&(this.tabledata.columns=Object.keys(e.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$set(this.tabledata,"data",e.data.data)),this.loading=!1}))}},computed:{paginatedData(){const e=(this.currentPage-1)*this.pageSize;return this.tabledata.data.slice(e,e+this.pageSize)}},mounted(){this.getdata()}},fo=mo,wo=(0,w.A)(fo,go,uo,!1,null,null,null),bo=wo.exports,vo={props:["column","tabledata","operate"],components:{Uploadocom:Ae,Filtercom:ka,historyDialog:bo},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["回转溜槽内部应无杂物、无堵塞现象","回转溜槽内部应保持干燥","回转溜槽前端应在事故钢水罐(坑、槽) 上方，应能满足事故钢水顺利流入"],deviceKind2:["正常","异常"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加设备点检记录",rules_data:{},showsearch:!1,loading:!1,check_datas:["所属分厂","所属车间","设备名称","企业内部编号","安装地点","运行状态","设备编码"],his_visible:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:""}},methods:{distinctValues(e){const t=new Set;return this.tableData.forEach((a=>{a[e]&&t.add(a[e])})),Array.from(t).map((e=>({text:e,value:e})))},changeStatus(e){"异常"==e?(this.columns=[],this.rules_data["点检结果"]=[{required:!0,message:"请选择点检结果",trigger:"change"},{validator:(e,t,a)=>{"异常"===t?this.newRow["问题描述"]&&""!==this.newRow["问题描述"].trim()?a():a(new Error("当 '点检结果' 为 异常 时，问题描述 字段必须存在且非空！")):a()},trigger:"change"}],this.columns=JSON.parse(JSON.stringify(this.column)),this.rules_data["问题描述"]=[{required:!0,message:"请输入问题描述",trigger:"blur"}]):this.rules_data["问题描述"]=[{required:!1,message:"请输入问题描述",trigger:"blur"}]},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},viewhistory(e){this.his_visible=!0,this.newRow=Object.assign({},e)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加设备点检记录",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.rules_data=this.$formatFormRules([],this.newRow,{})})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},rulesCreate(){let e={};return this.check_datas.map((t=>e[t]={required:!1})),e},openAddRowDialog(e){this.addRowDialogVisible=!0,this.operatetitle="添加设备点检记录",this.$nextTick((()=>{this.formatRow(),this.newRow=Object.assign({},e);let t=["点检日期","点检序号","点检事项","点检标准","点检结果","问题描述","图片描述","再检日期"];for(let e=0;e<t.length;e++)this.newRow[t[e]]="";this.newRow["运行状态"]="在用",this.newRow["点检结果"]="正常",this.rules_data=this.$formatFormRules([],this.newRow,{}),console.log(this.rules_data)}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}},computed:{paginatedData(){this.columns=JSON.parse(JSON.stringify(this.column));let e=JSON.parse(JSON.stringify(this.tabledata));this.tableData=e.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const t=(this.currentPage-1)*this.pageSize;return this.tableData.slice(t,t+this.pageSize)}},mounted(){}},yo=vo,_o=(0,w.A)(yo,ho,po,!1,null,null,null),So=_o.exports,Do={components:{BaseTable:So},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{}}},methods:{chooseReport(e){this.tabledata.data=this.tabledata.data.filter((e=>"1"==e.base_addFlag&&null!=e.ID)),console.log(this.tabledata.data),"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata())},async reportfuncimginfo(e){let t=e.checkevalue.map((e=>e["图片描述"]));for(const i of t)try{let e=await this.$reportimginfo(i,"3");console.log(e),e.data&&2e3!=e.data.code&&this.$message.error("图片描述上报失败")}catch(a){console.error(`上报失败: ${a.message}`)}},reportInfo(e){console.log(e);let t=e.checkevalue.map((e=>e.ID)),a={saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.$refs.basetable.loading_report=!0,t.length&&(this.loading=!0,_e.A.checkreportDevice(a).then((t=>{if(200==t.data.code){let e=[],a=[],i=[];t.data.data.map((t=>{console.log(t);let s=2e3===t.supervisionCheckRecordDetailMessage.code&&2e3===t.supervisionCheckRecordMessage.code||t.supervisionCheckRecordDetailMessage.message.includes("表中数据已存在")||t.supervisionCheckRecordMessage.message.includes("表中数据已存在");e.push(s),s&&a.push(t),2e3!==t.supervisionCheckRecordDetailMessage.code&&2e3!==t.supervisionCheckRecordMessage.code?i.push(t):t.supervisionCheckRecordDetailMessage.message.includes("表中数据已存在")||t.supervisionCheckRecordMessage.message.includes("表中数据已存在")||i.push(t)})),console.log(e),console.log(i),e.includes(!1)?(i&&this.$message({type:"error",dangerouslyUseHTMLString:!0,message:`<div style="height:fit-content;max-height:320px;">以下数据上报失败！<br>${i.map((e=>`<div>ID:${e.id}_错误信息${2e3==e.supervisionCheckRecordDetailMessage.code?"":e.supervisionCheckRecordDetailMessage.message}_${2e3==e.supervisionCheckRecordMessage.code?"":e.supervisionCheckRecordMessage.message}</div>`)).join("")}</div>`,showClose:!0,duration:0}),a.length&&this.$message({type:"success",dangerouslyUseHTMLString:!0,offset:200,message:`以下数据上报成功！<br>${a.map((e=>`<div>ID:${e.id}</div>`)).join("")}`,showClose:!0,duration:0})):this.$message.success("所有记录上报成功！"),this.$refs.basetable.showSelectvalue=[]}else this.$message.error("上报失败！"+t.data.message);this.reportfuncimginfo(e),this.loading=!1,this.$refs.basetable.loading_report=!1})),console.log(a))},searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata()},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3,"回转溜槽内部应无杂物、无堵塞现象"==this.current_newinfo["点检标准"]?(this.current_newinfo["点检事项"]="0101",this.current_newinfo["点检序号"]="1"):"回转溜槽内部应保持干燥"==this.current_newinfo["点检标准"]?(this.current_newinfo["点检事项"]="0102",this.current_newinfo["点检序号"]="2"):"回转溜槽前端应在事故钢水罐(坑、槽) 上方，应能满足事故钢水顺利流入"==this.current_newinfo["点检标准"]&&(this.current_newinfo["点检事项"]="0103",this.current_newinfo["点检序号"]="3");let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,delete t[1].id,delete t[1].报废证明,delete t[1].停用证明,delete t[1].检验日期预报警状态,delete t[1].设备编码,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag,delete t[1].base_addFlag,delete t[1].base_updateFlag,delete t[1].点检结果,console.log(t[1]),this.editinfo(e,t)},async editinfo(e,t){this.$refs.basetable.loadingbtn=!0;let a,i={};if("编辑"==e.operate)i={record_id:this.current_newinfo.ID,system_id:this.current_newinfo.系统ID,check_data:JSON.stringify(Object.values(t[1]))},a=ye.A.updateCheckout({...i});else if("添加设备点检记录"==e.operate){let e=await this.$getId(),s=await this.$getId();t[1]["getId"]=e,t[1]["getId2"]=s,console.log(t[0]),console.log(t[1]),i={system_id:this.current_newinfo.系统ID,check_data:JSON.stringify(Object.values(t[1]))},a=ye.A.writeCheckout({...i})}console.log("info.operate ",i),a.then((t=>{200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata()})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},deleterow(e){console.log("删除",e),delete e.rowinfo["检验/校准日期预报警状态"],ye.A.deleteCheckout({system_id:e.rowinfo.系统ID,record_id:e.rowinfo.ID}).then((e=>{console.log(e.data),200==e.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata()})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"})}))},openAddRowDialog(){this.$refs.basetable.addRowDialogVisible=!0,this.$nextTick((()=>{this.$refs.basetable.initialform()}))},normalizeData(e,t){return e.map((e=>{let a={...t};for(let t in e)e.hasOwnProperty(t)&&(a[t]=e[t]);return a["点检结果"]=e["问题描述"]?"异常":"正常",a}))},getdata(){let e={};this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0,this.$refs.basetable.showsearch&&(e=this.filter_params)),ye.A.readCheckout(e?{filter:JSON.stringify({...e})}:"").then((t=>{let a={ID:null,"系统ID":"","所属分厂":"","所属车间":"","设备名称":"","企业内部编号":"","安装地点":"","运行状态":"","点检日期":"","点检序号":"","点检事项":"","点检标准":"","点检结果":"正常","问题描述":"","图片描述":"","再检日期":"","检验日期预报警状态":"","停用证明":null,"报废证明":null};if("200"==t.data.code&&t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))));let i=t.data.data.map((e=>e.ID)),s=t.data.data.map((e=>e.系统ID));_e.A.idscheckReportStatus({ids:i}).then((e=>{const i=t.data.data.map((t=>{const a=e.data.data.find((e=>e.id===t.ID));return{...t,...a||{}}}));_e.A.listReportStatus({systemIds:s}).then((e=>{let s=e.data.data.map((e=>({systemId:e.systemId,base_addFlag:e.addFlag,base_updateFlag:e.updateFlag})));const o=i.map((e=>{const t=s.find((t=>t.systemId===e.系统ID));return{...e,...t||{}}}));let l=this.normalizeData(o,a),r=this.normalizeData(t.data.data.slice(0,1),a);this.$set(this.tabledata,"data",l),console.log(l),this.tabledata.columns=Object.keys(r[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata()}},Ro=Do,ko=(0,w.A)(Ro,no,co,!1,null,null,null),$o=ko.exports,Co=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"loadgif"}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},xo=[],Io=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"2rem"}}),t("el-col",{attrs:{span:18}},[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary"},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),t("span",{staticStyle:{color:"white"}},[e._v("仅满足以下条件的数据可上报：1、已经新增上报成功的设备 2、已经进行检验操作过的设备")]),e.showSelect?t("div",{staticStyle:{width:"5rem"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{attrs:{span:24}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态","检验日期","再检日期"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0,e.heightValue="calc(100vh - 3.8rem)"}}})],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:(e.showsearch,"calc(100vh - 3.3rem)")},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",width:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticClass:"deletbtn",staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small",disabled:null==a.row["ID"]},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small",disabled:null==a.row["ID"]},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")]),t("br"),t("el-button",{staticStyle:{"font-size":"0.175rem","margin-left":"0",color:"#00c93b"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.openAddRowDialog(a.row)}}},[e._v(" 检验 ")]),t("el-button",{staticStyle:{"font-size":"0.175rem",color:"rgb(212 158 78)"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.viewhistory(a.row)}}},[e._v(" 历史 ")])]}}],null,!1,923560919)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(i,s){return"系统ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable,sortable:"true"},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明"==i.prop||"报废证明"==i.prop||"检验报告"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"停用证明"!=i.prop&&"报废证明"!=i.prop&&"检验报告"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",["检验类型"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop],"deviceKind"))+" ")]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"点检记录"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem"},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a,i){return"ID"!=a.label&&"系统ID"!=a.label&&"检验日期预报警状态"!=a.prop&&"停用证明"!=a.label&&"报废证明"!=a.label?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"检验类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e.label,attrs:{label:e.label,value:e.value}})})),1):e._e(),"检验报告"==a.prop?t("div",[e.newRow[a.prop]?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"运行状态"!=a.prop&&"检验报告"!=a.prop&&"检验类型"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),t("el-dialog",{attrs:{modal:!1,visible:e.his_visible,title:"本设备历史数据",fullscreen:"","custom-class":"historydialog"},on:{"update:visible":function(t){e.his_visible=t}}},[e.his_visible?t("historyDialog",{ref:"history",attrs:{current_info:e.newRow}}):e._e()],1)],1)},Ao=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],zo=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{type:e.showsearch?"":"flex",justify:"end"}}),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.tabledata.data,"cell-class-name":e.getCellClassName,height:(e.showsearch,"calc(100vh - 3.3rem)")}},[t("el-table-column",{attrs:{label:"操作",minWidth:"100rem"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}])}),e._l(e.tabledata.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable,"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明"==i.prop||"报废证明"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验报告"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]&&["jpg","png","jpeg"].indexOf(s.row[i.prop].split(".")[s.row[i.prop].split(".").length-1])>=0?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):e._e(),s.row[i.prop]&&["mov","avi","mkv"].indexOf(s.row[i.prop].split(".")[s.row[i.prop].split(".").length-1])>=0?t("video",{staticClass:"video-player",staticStyle:{height:"0.5rem",width:"0.5rem%"},attrs:{controls:""},domProps:{muted:!0}},[t("source",{attrs:{src:s.row[i.prop],type:"video/mp4"}}),e._v(" Your browser does not support the video tag. ")]):s.row[i.prop]?e._e():t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"停用证明"!=i.prop&&"报废证明"!=i.prop&&"检验报告"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]}}],null,!0)}):e._e()}))],2)],1),t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem"},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.tabledata.columns,(function(a,i){return"ID"!=a.label&&"系统ID"!=a.label&&"检验日期预报警状态"!=a.prop&&"停用证明"!=a.label&&"报废证明"!=a.label?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"检验类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),"检验报告"==a.prop?t("div",[e.newRow[a.prop]?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"运行状态"!=a.prop&&"检验报告"!=a.prop&&"检验类型"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"备注"==a.prop&&"编辑"==e.operatetitle?t("div",{staticStyle:{"font-size":"0.25rem","font-weight":"bold","margin-top":"0.4rem",color:"#007bff"}},[e._v(" 以下信息请至 企业日常管理数据页面 进行编辑 ")]):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Oo=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],To={props:["current_info"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["定期检验","定期探伤","A类（定期校验）","B类（定期校准）"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加设备点检记录",rules_data:{"检验日期":[{required:!0,message:"不能为空",trigger:"change"}],"再检验日期":[{required:!0,message:"不能为空",trigger:"change"}]},showsearch:!1,loading:!1,check_datas:["所属分厂","所属车间","设备名称","企业内部编号","安装地点","运行状态","设备编码"],his_visible:!1,tabledata:{data:[],columns:[]}}},methods:{viewhistory(e){this.his_visible=!0,this.newRow=Object.assign({},e)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.getdata(e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加设备点检记录",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e)})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},deleteRow(e){ye.A.deleteRegularcheck({system_id:e.系统ID,record_id:e.ID}).then((e=>{console.log(e.data),200==e.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.addRowDialogVisible=!1,this.confirmDeleteDialogVisible=!1,this.getdata()})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"})}))},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},rulesCreate(){let e={};return this.check_datas.map((t=>e[t]={required:!1})),e},openAddRowDialog(e){this.addRowDialogVisible=!0,this.operatetitle="添加设备点检记录",this.$nextTick((()=>{this.formatRow(),this.newRow=Object.assign({},e),this.newRow["运行状态"]="在用"}))},addRow(e){this.loadingbtn=!0,this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),this.loadingbtn=!1,!1;{let e=JSON.parse(JSON.stringify(this.newRow)),t=this.$assignValues(void 0,e);delete t[1].系统ID,delete t[1].ID,delete t[1].报废证明,delete t[1].停用证明,delete t[1].检验日期预报警状态,delete t[1].设备编码;let a={record_id:this.newRow.ID,system_id:this.newRow.系统ID,regula_check_data:JSON.stringify(Object.values(t[1]))};ye.A.updateRegularcheck({...a}).then((e=>{200==e.data.code?(this.$message({message:"编辑成功",type:"success"}),this.loadingbtn=!1,this.addRowDialogVisible=!1,this.getdata()):this.$message({message:"失败稍后重试！",type:"error"}),this.loadingbtn=!1}))}}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})},getdata(){this.$set(this.tabledata,"data",[]),this.loading=!0,ye.A.OnedeviceRegularcheck({system_id:this.current_info.系统ID}).then((e=>{"200"==e.data.code&&e.data.data[0]&&(this.tabledata.columns=Object.keys(e.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$set(this.tabledata,"data",e.data.data)),this.loading=!1}))}},computed:{paginatedData(){const e=(this.currentPage-1)*this.pageSize;return this.tabledata.data.slice(e,e+this.pageSize)}},mounted(){this.getdata()}},Vo=To,Po=(0,w.A)(Vo,zo,Oo,!1,null,null,null),Fo=Po.exports,No={props:["column","tabledata","operate"],components:{Uploadocom:Ae,Filtercom:ka,historyDialog:Fo},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加设备校验记录",deviceKind:[{label:"定期检验",value:"1"},{label:"定期检定或校准",value:"2"},{label:"定期探伤",value:"3"}],rules_data:{"检验日期":[{required:!0,message:"不能为空",trigger:"change"}],"再检验日期":[{required:!0,message:"不能为空",trigger:"change"}]},showsearch:!1,loading:!1,check_datas:["所属分厂","所属车间","设备名称","企业内部编号","安装地点","运行状态","设备编码"],his_visible:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:""}},methods:{formatShowData(e,t){if(this[t].find((t=>t.value==e)))return this[t].find((t=>t.value==e)).label},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},viewhistory(e){this.his_visible=!0,this.newRow=Object.assign({},e)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加设备校验记录",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e)})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},rulesCreate(){let e={};return this.check_datas.map((t=>e[t]={required:!1})),e},openAddRowDialog(e){this.addRowDialogVisible=!0,this.operatetitle="添加设备校验记录",this.$nextTick((()=>{this.formatRow(),this.newRow=Object.assign({},e),this.rules_data=this.$formatFormRules([],this.newRow,{}),this.newRow["运行状态"]="在用";let t=["检验日期","检验类型","检验结论","存在问题","再检验日期","检验单位","检验报告"];for(let e=0;e<t.length;e++)this.newRow[t[e]]=""}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},jo=No,Wo=(0,w.A)(jo,Io,Ao,!1,null,null,null),Mo=Wo.exports,Lo={components:{BaseTable:Mo},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{}}},methods:{chooseReport(e){this.tabledata.data=this.tabledata.data.filter((e=>"1"==e.base_addFlag&&null!=e.ID)),"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},async reportfuncimginfo(e){let t=e.checkevalue.map((e=>e["检验报告"]));for(const i of t)try{let e=await this.$reportimginfo(i,"4");e.data&&2e3!=e.data.code&&this.$message.error("检验报告上报失败")}catch(a){console.error(`上报失败: ${a.message}`)}},reportInfo(e){console.log(e);let t=e.checkevalue.map((e=>e.ID)),a={saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.$refs.basetable.loading_report=!0,t.length&&(this.loading=!0,_e.A.reugularcheckreportDevice(a).then((t=>{if(200==t.data.code){let e=[],a=[],i=[];t.data.data.map((t=>{console.log(t);let s=2e3===t.supervisionCheckRecordMessage.code||t.supervisionCheckRecordMessage.message.includes("表中数据已存在");e.push(s),s&&a.push(t),2e3==t.supervisionCheckRecordMessage.code&&t.supervisionCheckRecordMessage.message.includes("表中数据已存在")||i.push(t)})),e.includes(!1)?(this.$message({type:"error",dangerouslyUseHTMLString:!0,message:`<div style="height:fit-content;max-height:320px;">以下数据上报失败！<br>${i.map((e=>`<div>ID:${e.id}_错误信息${2e3==e.supervisionCheckRecordMessage.code?"":e.supervisionCheckRecordMessage.message}</div>`)).join("")}</div>`,showClose:!0,duration:0}),a.length&&this.$message({type:"success",dangerouslyUseHTMLString:!0,offset:200,message:`以下数据上报成功！<br>${a.map((e=>`<div>ID:${e.id}</div>`)).join("")}`,showClose:!0,duration:0})):this.$message.success("所有记录上报成功！"),this.$refs.basetable.showSelectvalue=[]}else this.$message.error("上报失败！"+t.data.message);this.reportfuncimginfo(e),this.loading=!1,this.$refs.basetable.loading_report=!1})),console.log(a))},searchparams(e){console.log(e),this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata()},addinfo(e){this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),this.current_newinfo["运行状态"]="在用"==this.current_newinfo["运行状态"]?1:"停用"==this.current_newinfo["运行状态"]?2:3;let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].系统ID,delete t[1].ID,delete t[1].id,delete t[1].报废证明,delete t[1].停用证明,delete t[1].检验日期预报警状态,delete t[1].设备编码,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag,delete t[1].base_addFlag,delete t[1].base_updateFlag,console.log(t[1]),this.editinfo(e,t)},async editinfo(e,t){this.$refs.basetable.loadingbtn=!0;let a,i={};if("编辑"==e.operate)i={record_id:this.current_newinfo.ID,system_id:this.current_newinfo.系统ID,regula_check_data:JSON.stringify(Object.values(t[1]))},a=ye.A.updateRegularcheck({...i});else if("添加设备校验记录"==e.operate){let e=await this.$getId();t[1]["getId"]=e,i={system_id:this.current_newinfo.系统ID,regula_check_data:JSON.stringify(Object.values(t[1]))},a=ye.A.writeRegularcheck({...i})}console.log("info.operate ",i),a.then((t=>{200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata()})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1}))},deleterow(e){console.log("删除",e),delete e.rowinfo["检验/校准日期预报警状态"],ye.A.deleteRegularcheck({system_id:e.rowinfo.系统ID,record_id:e.rowinfo.ID}).then((e=>{console.log(e.data),200==e.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata()})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"})}))},openAddRowDialog(){this.$refs.basetable.addRowDialogVisible=!0,this.$nextTick((()=>{this.$refs.basetable.initialform()}))},getdata(){let e={};this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0,this.$refs.basetable.showsearch&&(e=this.filter_params)),ye.A.readRegularcheck(e?{filter:JSON.stringify({...e})}:"").then((t=>{if("200"==t.data.code&&t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$refs.basetable&&(this.$refs.basetable.loading=!0);let a=t.data.data.map((e=>e.ID)),i=t.data.data.map((e=>e.系统ID));_e.A.idsregularcheckReportStatus({ids:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.id===t.ID));return{...t,...a||{}}}));_e.A.listReportStatus({systemIds:i}).then((e=>{let t=e.data.data.map((e=>({systemId:e.systemId,base_addFlag:e.addFlag,base_updateFlag:e.updateFlag})));const i=a.map((e=>{const a=t.find((t=>t.systemId===e.系统ID));return{...e,...a||{}}}));console.log("mergedTabledata2",i),this.$set(this.tabledata,"data",i),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata()}},Eo=Lo,Jo=(0,w.A)(Eo,Co,xo,!1,null,null,null),Uo=Jo.exports,Bo=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788)}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["edit","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},qo=[],Xo=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"2rem"}}),t("el-col",{attrs:{span:12}},[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary"},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),t("span",{staticStyle:{color:"white"}},[e._v("仅满足以下条件的数据可上报：1、已经新增上报成功的设备 2、已经进行停用操作过的设备")]),e.showSelect?t("div",{staticStyle:{width:"5rem"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{attrs:{span:24}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态","检验日期","再检日期"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0,e.heightValue="calc(100vh - 3.8rem)"}}})],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:(e.showsearch,"calc(100vh - 3.3rem)")},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"100rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["停用"==a.row["运行状态"]?t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small",disabled:null==a.row["ID"]},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")]):e._e(),t("el-button",{style:{"font-size":"0.175rem","margin-right":"在用"!=a.row["运行状态"]?"0rem":"0.125rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.modifyStatus(a.row)}}},["在用"==a.row["运行状态"]?t("span",{staticStyle:{color:"yellow"}},[e._v("停用")]):e._e(),"停用"==a.row["运行状态"]?t("span",{staticStyle:{color:"#1dc51d"}},[e._v("恢复在用")]):e._e()]),t("el-button",{staticStyle:{"font-size":"0.175rem",color:"rgb(212 158 78)","margin-left":"0"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.viewhistory(a.row)}}},[e._v(" 历史 ")])]}}],null,!1,3250932947)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明资料"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"检验报告上传"!=i.prop&&"停用证明资料"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",["停用类型"==i.prop?t("span",[e._v(" "+e._s(e.formatShowData(s.row[i.prop]))+" ")]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"设备停用记录"})}}},[e._v("导出数据")])],1),t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{close:e.closeDialog}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"停用类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"检验报告上传"==a.prop||"停用证明资料"==a.prop?t("div",[e.newRow[a.prop]?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):"停用类型"!=a.prop&&"炉顶放散阀联锁投入状态"!=a.prop&&"运行状态"!=a.prop&&a.prop.indexOf("日期")<0?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)<0},on:{change:function(t){return e.changeBasic(a.prop)}},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.closeDialog}},[e._v("取消")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),t("el-dialog",{attrs:{modal:!1,visible:e.his_visible,title:"本设备停用历史数据",fullscreen:"","custom-class":"historydialog"},on:{"update:visible":function(t){e.his_visible=t}}},[e.his_visible?t("historyDialog",{ref:"history",attrs:{current_info:e.newRow}}):e._e()],1)],1)},Ho=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],Go=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{type:e.showsearch?"":"flex",justify:"end"}}),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.tabledata.data,"cell-class-name":e.getCellClassName,height:(e.showsearch,"calc(100vh - 3.3rem)")}},e._l(e.tabledata.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable,"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明"==i.prop||"停用证明资料"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"图片描述"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]&&["jpg","png","jpeg"].indexOf(s.row[i.prop].split(".")[s.row[i.prop].split(".").length-1])>=0?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):e._e(),s.row[i.prop]&&["mov","avi","mkv"].indexOf(s.row[i.prop].split(".")[s.row[i.prop].split(".").length-1])>=0?t("video",{staticClass:"video-player",staticStyle:{height:"0.5rem",width:"0.5rem%"},attrs:{controls:""},domProps:{muted:!0}},[t("source",{attrs:{src:s.row[i.prop],type:"video/mp4"}}),e._v(" Your browser does not support the video tag. ")]):s.row[i.prop]?e._e():t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"停用证明资料"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]}}],null,!0)}):e._e()})),1)],1),t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem"},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.tabledata.columns,(function(a,i){return"ID"!=a.label&&"系统ID"!=a.label&&"检验日期预报警状态"!=a.prop&&"停用证明"!=a.label&&"停用证明资料"!=a.label?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"运行状态"!=a.prop&&"图片描述"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Ko=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],Zo={props:["current_info"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["通用桥式起重机","冶金桥式起重机","电动单梁起重机","电动葫芦桥式起重机"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加设备点检记录",rules_data:{},showsearch:!1,loading:!1,check_datas:["所属分厂","所属车间","设备名称","企业内部编号","安装地点","运行状态","设备编码"],his_visible:!1,tabledata:{data:[],columns:[]}}},methods:{viewhistory(e){this.his_visible=!0,this.newRow=Object.assign({},e)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.getdata(e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加设备点检记录",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e)})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},deleteRow(e){ye.A.deleteStopwork({system_id:e.系统ID,record_id:e.ID}).then((e=>{console.log(e.data),200==e.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.addRowDialogVisible=!1,this.confirmDeleteDialogVisible=!1,this.getdata()})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"})}))},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},rulesCreate(){let e={};return this.check_datas.map((t=>e[t]={required:!1})),e},openAddRowDialog(e){this.addRowDialogVisible=!0,this.operatetitle="添加设备点检记录",this.$nextTick((()=>{this.formatRow(),this.newRow=Object.assign({},e),this.newRow["运行状态"]="在用"}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;{let e=JSON.parse(JSON.stringify(this.newRow)),t=this.$assignValues(void 0,e);delete t[1].系统ID,delete t[1].ID,delete t[1].停用证明,delete t[1].检验日期预报警状态,delete t[1].设备编码;let a={record_id:this.newRow.ID,system_id:this.newRow.系统ID,stopwork_data:JSON.stringify(Object.values(t[1]))};ye.A.updateStopwork({...a}).then((e=>{200==e.data.code?(this.$message({message:"编辑成功",type:"success"}),this.loadingbtn=!1,this.addRowDialogVisible=!1,this.getdata()):this.$message({message:"失败稍后重试！",type:"error"})}))}}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})},getdata(){this.$set(this.tabledata,"data",[]),this.loadingbtn=!0,this.loading=!0,ye.A.OnedeviceStopcheck({system_id:this.current_info.系统ID}).then((e=>{"200"==e.data.code&&e.data.data[0]&&(this.tabledata.columns=Object.keys(e.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$set(this.tabledata,"data",e.data.data)),this.loadingbtn=!1,this.loading=!1})).catch((e=>{this.loading=!1,this.loadingbtn=!1}))}},computed:{paginatedData(){const e=(this.currentPage-1)*this.pageSize;return this.tabledata.data.slice(e,e+this.pageSize)}},mounted(){this.getdata()}},Qo=Zo,Yo=(0,w.A)(Qo,Go,Ko,!1,null,null,null),el=Yo.exports,tl={props:["column","tabledata","operate","historyDialog"],components:{Uploadocom:Ae,Filtercom:ka,historyDialog:el},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:[{label:"正常计划停用",value:"1"},{label:"非计划临时停用",value:"2"}],deviceKind2:["已锁","未锁"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rules_data:{},showsearch:!1,change_base:!1,loading:!1,loading_status:!1,check_datas:["停用日期","停用类型","停用说明","停用证明资料","备注","运行状态"],his_visible:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:""}},methods:{formatShowData(e){return this.deviceKind.find((t=>t.value==e))?this.deviceKind.find((t=>t.value==e)).label:e},showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},viewhistory(e){this.his_visible=!0,this.newRow=Object.assign({},e)},modifyStatus(e){"在用"==e["运行状态"]?(this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.newRow["运行状态"]="停用",this.rules_data=this.$formatFormRules([],this.newRow,{}),this.operatetitle="添加停用信息"}))):"停用"==e["运行状态"]&&(this.newRow=JSON.parse(JSON.stringify(e)),this.$emit("deleterow",{rowinfo:this.newRow,operate:"恢复在用"}))},changeBasic(e){["所属分厂","所属车间","安装地点","设备名称","状态"].indexOf(e)>=0&&(this.change_base=!0)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules([],this.newRow,{})}))},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},closeDialog(){this.addRowDialogVisible=!1},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.rules_data=this.$formatFormRules([],this.newRow,{})})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.tableData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},addRow(e){console.log(this.newRow),this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle}),this.change_base=!1}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})},validateNumber(e,t,a){const i=parseInt(t,10);i&&a()}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},al=tl,il=(0,w.A)(al,Xo,Ho,!1,null,null,null),sl=il.exports,ol={components:{BaseTable:sl},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{},filter_params:{}}},methods:{chooseReport(e){this.tabledata.data=this.tabledata.data.filter((e=>"1"==e.base_addFlag&&null!=e.ID)),"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},async reportfuncimginfo(e){let t=e.checkevalue.map((e=>e["停用证明资料"]));for(const i of t)try{let e=await this.$reportimginfo(i,"5");e.data&&2e3!=e.data.code&&this.$message.error("停用证明资料上报失败")}catch(a){console.error(`上报失败: ${a.message}`)}},reportInfo(e){console.log(e);let t=e.checkevalue.map((e=>e.ID)),a={saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.$refs.basetable.loading_report=!0,t.length&&(this.loading=!0,_e.A.stopreportDevice(a).then((t=>{if(200==t.data.code){let e=[],a=[],i=[];t.data.data.map((t=>{console.log(t);let s=2e3===t.stopworkRecordMessage.code||t.stopworkRecordMessage.message.includes("表中数据已存在");e.push(s),s&&a.push(t),2e3==t.stopworkRecordMessage.code&&t.stopworkRecordMessage.message.includes("表中数据已存在")||i.push(t)})),e.includes(!1)?(this.$message({type:"error",dangerouslyUseHTMLString:!0,message:`<div style="height:fit-content;max-height:320px;">以下数据上报失败！<br>${i.map((e=>`<div>ID:${e.id}_错误信息${2e3==e.stopworkRecordMessage.code?"":e.stopworkRecordMessage.message}</div>`)).join("")}</div>`,showClose:!0,duration:0}),a.length&&this.$message({type:"success",dangerouslyUseHTMLString:!0,offset:200,message:`以下数据上报成功！<br>${a.map((e=>`<div>ID:${e.id}</div>`)).join("")}`,showClose:!0,duration:0})):this.$message.success("所有记录上报成功！"),this.$refs.basetable.showSelectvalue=[]}else this.$message.error("上报失败！"+t.data.message);this.reportfuncimginfo(e),this.loading=!1,this.$refs.basetable.loading_report=!1})),console.log(a))},addinfo(e){delete e.rowinfo["key"],this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo));let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].ID,delete t[1].id,delete t[1].系统ID,delete t[1].设备编码,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag,delete t[1].base_addFlag,delete t[1].base_updateFlag,console.log(t[1]),this.editinfo(e,t)},async editinfo(e,t){this.$refs.basetable.loadingbtn=!0;let a,i={};if("编辑"==e.operate)i={stopwork_data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID,record_id:e.rowinfo.ID},a=ye.A.updateStopwork({...i});else if("添加停用信息"==e.operate){let s=await this.$getId();console.log(t[0]),console.log(t[1]),t[1]["getId"]=s,i={stopwork_data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},a=ye.A.writeStopwork({...i})}console.log("info.operate ",i),a.then((t=>{console.log(t.data),200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(),this.$store.commit("changeDevice")})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn,this.$store.commit("changeDevice")}))},deleterow(e){ye.A.deleteStopwork({system_id:e.rowinfo.系统ID,record_id:e.rowinfo.ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"操作成功",type:"success"}):this.$message({message:"操作失败稍后重试！",type:"error"}),this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata())})).catch((e=>{this.$message({message:"操作失败稍后重试！",type:"error"})}))},searchparams(e){this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata()},getdata(){let e={};this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0,this.$refs.basetable.showsearch&&(e=this.filter_params)),ye.A.readStopwork(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$refs.basetable&&(this.$refs.basetable.loading=!0);let a=t.data.data.map((e=>e.ID)),i=t.data.data.map((e=>e.系统ID));_e.A.idsstopReportStatus({ids:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.id===t.ID));return{...t,...a||{}}}));_e.A.listReportStatus({systemIds:i}).then((e=>{let t=e.data.data.map((e=>({systemId:e.systemId,base_addFlag:e.addFlag,base_updateFlag:e.updateFlag})));const i=a.map((e=>{const a=t.find((t=>t.systemId===e.系统ID));return{...e,...a||{}}}));console.log("mergedTabledata",i),this.$set(this.tabledata,"data",i),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata("")}},ll=ol,rl=(0,w.A)(ll,Bo,qo,!1,null,null,null),nl=rl.exports,cl=function(){var e=this,t=e._self._c;return t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"loadgif"}}):e._e(),t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["edit","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow,searchparams:e.searchparams,reportInfo:e.reportInfo,chooseReport:e.chooseReport}}),t("div",{staticClass:"echarts-foot"})],1)},dl=[],hl=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{justify:"space-between"}},[e.showSelect?e._e():t("el-col",{staticStyle:{width:"2rem"}}),t("el-col",{attrs:{span:18}},[t("el-popconfirm",{attrs:{"confirm-button-text":"新增上报","cancel-button-text":"修改上报",icon:"el-icon-info",title:"选择上报类型","cancel-button-type":"primary",disabled:e.loading},on:{confirm:function(t){return e.showSelectFunc("新增")},cancel:function(t){return e.showSelectFunc("修改")}}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{slot:"reference",type:"primary",disabled:e.loading},slot:"reference"},[t("span",[e._v("上报")])])],1),t("span",{staticStyle:{color:"white"}},[e._v("仅满足以下条件的数据可上报：1、已经新增上报成功的设备 2、已经进行报废操作过的设备")]),e.showSelect?t("div",{staticStyle:{width:"5rem"}},[e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem"},attrs:{type:"text"},on:{click:e.confirmSelectFunc}},[t("span",[e._v("确认")])]):e._e(),e.showSelect?t("el-button",{staticClass:"plusicon",staticStyle:{"margin-right":"0.1rem",color:"grey"},attrs:{type:"text"},on:{click:function(t){return e.showSelectFunc("取消")}}},[t("span",[e._v("取消")])]):e._e(),t("span",{staticClass:"report_msg"},[e._v("以下为可 "),t("span",{staticStyle:{"font-weight":"bold"}},[e._v(" "+e._s(e.messageinfo)+"上报 ")]),e._v("数据")])],1):e._e()],1),e.showsearch||e.showSelect?e.showSelect?e._e():t("el-col",{attrs:{span:24}},[t("filtercom",{ref:"filtercom",attrs:{filterinfo:["所属分厂","所属车间","设备名称","安装地点","运行状态","检验日期","再检日期"]},on:{searchFunc:e.searchFunc}})],1):t("el-button",{staticClass:"plusicon",staticStyle:{float:"right"},attrs:{type:"primary",icon:"el-icon-search",title:"筛选"},on:{click:function(t){e.showsearch=!0,e.heightValue="calc(100vh - 3.8rem)"}}})],1),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],key:e.showSelect,ref:"multipleTable",staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:(e.showsearch,"calc(100vh - 3.3rem)")},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"100rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["报废"==a.row["运行状态"]?t("el-button",{style:{"font-size":"0.175rem","margin-right":"在用"!=a.row["运行状态"]?"0rem":"0.125rem"},attrs:{type:"text",size:"small",disabled:null==a.row["ID"]},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")]):e._e(),t("el-button",{style:{"font-size":"0.175rem","margin-right":"在用"!=a.row["运行状态"]?"0rem":"0.125rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.modifyStatus(a.row)}}},["在用"==a.row["运行状态"]?t("span",{staticStyle:{color:"yellow"}},[e._v("报废")]):e._e(),"报废"==a.row["运行状态"]?t("span",{staticStyle:{color:"#1dc51d"}},[e._v("恢复在用")]):e._e()]),t("el-button",{staticStyle:{"font-size":"0.175rem",color:"rgb(212 158 78)","margin-left":"0"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.viewhistory(a.row)}}},[e._v(" 历史 ")])]}}],null,!1,516085167)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),t("el-table-column",{attrs:{label:"上报状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(1==t.row["addFlag"]?"已上报":"未上报")+" ")]}}])}),e._l(e.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"报废证明资料"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"检验报告上传"!=i.prop&&"报废证明资料"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"设备报废记录"})}}},[e._v("导出数据")])],1),t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem","close-on-click-modal":!1},on:{close:e.closeDialog}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:""},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"停用类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"检验报告上传"==a.prop||"报废证明资料"==a.prop?t("div",[e.newRow[a.prop]?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):"停用类型"!=a.prop&&"炉顶放散阀联锁投入状态"!=a.prop&&"运行状态"!=a.prop&&a.prop.indexOf("日期")<0?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)<0},on:{change:function(t){return e.changeBasic(a.prop)}},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.closeDialog}},[e._v("取消")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e(),t("el-dialog",{attrs:{modal:!1,visible:e.his_visible,title:"本设备报废历史数据",fullscreen:"","custom-class":"historydialog"},on:{"update:visible":function(t){e.his_visible=t}}},[e.his_visible?t("historyDialog",{ref:"history",attrs:{current_info:e.newRow}}):e._e()],1)],1)},pl=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],gl=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{type:e.showsearch?"":"flex",justify:"end"}}),t("div",{staticClass:"table-container"},[t("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.tabledata.data,"cell-class-name":e.getCellClassName,height:(e.showsearch,"calc(100vh - 3.3rem)")}},e._l(e.tabledata.columns,(function(i,s){return"系统ID"!=i.label&&"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable,"show-overflow-tooltip":!0},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用证明"==i.prop||"报废证明资料"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"报废证明资料"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(String(s.row[i.prop]).replace("T00:00:00","")))]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]}}],null,!0)}):e._e()})),1)],1),t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem"},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.tabledata.columns,(function(a,i){return"ID"!=a.label&&"系统ID"!=a.label&&"检验日期预报警状态"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["运行状态"==a.prop?t("div",[t("el-radio-group",{attrs:{disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"起重机品种"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),"报废证明资料"==a.prop?t("div",[e.newRow[a.prop]?t("div",{staticStyle:{width:"1rem"}},[t("img",{staticStyle:{width:"1rem",height:"1rem"},attrs:{src:e.newRow[a.prop]}}),t("div",{staticStyle:{width:"1rem"}},[t("span",{staticStyle:{color:"#247cc3",cursor:"pointer"},on:{click:function(t){return e.cancelImg(a.prop)}}},[e._v("取消")])])]):t("Uploadocom",{ref:"uploadocom",refInFor:!0,attrs:{uploadAction:"/api/function/upload",showloading2:e.showloading2},on:{upload:e.listenUpload,imageshow:t=>e.imageshowFunc(t,a.prop)}})],1):e._e(),a.prop.indexOf("日期")>=0?t("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):"运行状态"!=a.prop&&"报废证明资料"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label,disabled:e.check_datas.indexOf(a.prop)>=0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},ul=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],ml={props:["current_info"],components:{Uploadocom:Ae,Filtercom:ka},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["通用桥式起重机","冶金桥式起重机","电动单梁起重机","电动葫芦桥式起重机"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加设备点检记录",rules_data:{},showsearch:!1,loading:!1,check_datas:["所属分厂","所属车间","设备名称","企业内部编号","安装地点","运行状态","设备编码"],his_visible:!1,tabledata:{data:[],columns:[]}}},methods:{viewhistory(e){this.his_visible=!0,this.newRow=Object.assign({},e)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.getdata(e)},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加设备点检记录",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.rules_data={"报废日期":[{required:!0,message:"不能为空",trigger:"change"}]}})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},deleteRow(e){ye.A.deleteScrapwork({system_id:e.系统ID,record_id:e.ID}).then((e=>{console.log(e.data),200==e.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.addRowDialogVisible=!1,this.confirmDeleteDialogVisible=!1,this.getdata()})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"})}))},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},rulesCreate(){let e={};return this.check_datas.map((t=>e[t]={required:!1})),e},openAddRowDialog(e){this.addRowDialogVisible=!0,this.operatetitle="添加设备点检记录",this.$nextTick((()=>{this.formatRow(),this.newRow=Object.assign({},e),this.newRow["运行状态"]="在用"}))},addRow(e){this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;{let e=JSON.parse(JSON.stringify(this.newRow)),t=this.$assignValues(void 0,e);delete t[1].系统ID,delete t[1].ID,delete t[1].停用证明,delete t[1].检验日期预报警状态,delete t[1].设备编码;let a={record_id:this.newRow.ID,system_id:this.newRow.系统ID,scrap_data:JSON.stringify(Object.values(t[1]))};ye.A.updateScrapwork({...a}).then((e=>{200==e.data.code?(this.$message({message:"编辑成功",type:"success"}),this.loadingbtn=!1,this.addRowDialogVisible=!1,this.getdata()):this.$message({message:"失败稍后重试！",type:"error"})}))}}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})},getdata(){this.$set(this.tabledata,"data",[]),this.loading=!0,ye.A.OnedeviceScrapwork({system_id:this.current_info.系统ID}).then((e=>{"200"==e.data.code&&e.data.data[0]&&(this.tabledata.columns=Object.keys(e.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$set(this.tabledata,"data",e.data.data)),this.loading=!1}))}},computed:{paginatedData(){const e=(this.currentPage-1)*this.pageSize;return this.tabledata.data.slice(e,e+this.pageSize)}},mounted(){this.getdata()}},fl=ml,wl=(0,w.A)(fl,gl,ul,!1,null,null,null),bl=wl.exports,vl={props:["column","tabledata","operate","historyDialog"],components:{Uploadocom:Ae,Filtercom:ka,historyDialog:bl},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:[{label:"正常计划停用",value:1},{label:"非计划临时停用",value:2}],deviceKind2:["已锁","未锁"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkdata1:["在用","停用","报废"],checkedData1:"",operatetitle:"添加",rules_data:{},showsearch:!1,change_base:!1,loading:!1,loading_status:!1,check_datas:["报废日期","停用类型","报废说明","报废证明资料","备注","运行状态"],his_visible:!1,showSelect:!1,showSelectvalue:[],pre_currentPage:1,messageinfo:""}},methods:{showSelectFunc(e){this.currentPage=1,this.messageinfo=e,this.$emit("chooseReport",e),this.showSelect=!this.showSelect,"取消"==e&&(this.showSelectvalue=[]),this.$nextTick((()=>{this.$forceUpdate()}))},confirmSelectFunc(e){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e.status&&this.$emit("reportInfo",{checkevalue:this.showSelectvalue,operate:this.messageinfo})}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},viewhistory(e){this.his_visible=!0,this.newRow=Object.assign({},e)},modifyStatus(e){this.newRow=JSON.parse(JSON.stringify(e)),"在用"==e["运行状态"]?(this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e);let t=["报废日期","报废证明资料","备注"];for(let e=0;e<t.length;e++)this.newRow[t[e]]="";this.newRow["运行状态"]="报废",this.rules_data=this.$formatFormRules([],this.newRow,{}),this.operatetitle="添加报废信息"}))):"报废"==e["运行状态"]&&this.$emit("deleterow",{rowinfo:this.newRow,operate:"恢复在用"})},changeBasic(e){["所属分厂","所属车间","安装地点","设备名称","状态"].indexOf(e)>=0&&(this.change_base=!0)},searchFunc(){let e=Object.assign({},this.$refs.filtercom.filterparams);this.$emit("searchparams",e)},openAddRowDialog(){this.addRowDialogVisible=!0,this.operatetitle="添加",this.$nextTick((()=>{this.formatRow(),this.newRow["运行状态"]="在用",this.rules_data=this.$formatFormRules([],this.newRow,{})}))},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},closeDialog(){this.addRowDialogVisible=!1},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.newRow=Object.assign({},e),this.rules_data=this.$formatFormRules([],this.newRow,{})})),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.tableData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},addRow(e){console.log(this.newRow),this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle}),this.change_base=!1}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{})},validateNumber(e,t,a){const i=parseInt(t,10);i&&a()}},computed:{paginatedData(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes();const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){}},yl=vl,_l=(0,w.A)(yl,hl,pl,!1,null,null,null),Sl=_l.exports,Dl={components:{BaseTable:Sl},data(){return{tabledata:{columns:[],data:[]},loading:!1,current_newinfo:{},filter_params:{}}},methods:{chooseReport(e){this.tabledata.data=this.tabledata.data.filter((e=>"1"==e.base_addFlag&&null!=e.ID)),"新增"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"==e.addFlag))),"修改"==e&&(this.tabledata.data=this.tabledata.data.filter((e=>"0"!=e.addFlag))),"取消"==e&&(this.$refs.basetable.showsearch=!1,this.getdata()),console.log(this.tabledata.data)},async reportfuncimginfo(e){let t=e.checkevalue.map((e=>e["报废证明资料"]));for(const i of t)try{let e=await this.$reportimginfo(i,"6");e.data&&2e3!=e.data.code&&this.$message.error("报废证明资料上报失败")}catch(a){console.error(`上报失败: ${a.message}`)}},reportInfo(e){console.log(e);let t=e.checkevalue.map((e=>e.ID)),a={saveOrUpdate:"新增"==e.operate?1:2,ids:t};this.$refs.basetable.loading_report=!0,t.length&&(this.loading=!0,_e.A.scrabreportDevice(a).then((t=>{if(200==t.data.code){let e=[],a=[],i=[];t.data.data.map((t=>{console.log(t);let s=2e3===t.deviceScrapRecord.code||t.deviceScrapRecord.message.includes("表中数据已存在");e.push(s),s&&a.push(t),2e3!=t.deviceScrapRecord.code&&i.push(t)})),e.includes(!1)?(this.$message({type:"error",dangerouslyUseHTMLString:!0,message:`<div style="height:fit-content;max-height:320px;">以下数据上报失败！<br>${i.map((e=>`<div>ID:${e.id}_错误信息${2e3==e.deviceScrapRecord.code?"":e.deviceScrapRecord.message}</div>`)).join("")}</div>`,showClose:!0,duration:0}),a.length&&this.$message({type:"success",dangerouslyUseHTMLString:!0,offset:200,message:`以下数据上报成功！<br>${a.map((e=>`<div>ID:${e.id}</div>`)).join("")}`,showClose:!0,duration:0})):this.$message.success("所有记录上报成功！"),this.$refs.basetable.showSelectvalue=[]}else this.$message.error("上报失败！"+t.data.message);this.reportfuncimginfo(e),this.loading=!1,this.$refs.basetable.loading_report=!1})),console.log(a))},addinfo(e){delete e.rowinfo["key"],this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo));let t=this.$assignValues(void 0,this.current_newinfo);delete t[1].ID,delete t[1].id,delete t[1].系统ID,delete t[1].设备编码,delete t[1].systemId,delete t[1].updateFlag,delete t[1].addFlag,delete t[1].base_addFlag,delete t[1].base_updateFlag,this.editinfo(e,t)},async editinfo(e,t){this.$refs.basetable.loadingbtn=!0;let a,i={};if("编辑"==e.operate)i={scrap_data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID,record_id:e.rowinfo.ID},a=ye.A.updateScrapwork({...i});else if("添加报废信息"==e.operate){let s=await this.$getId();console.log(t[0]),console.log(t[1]),t[1]["getId"]=s,i={scrap_data:JSON.stringify(Object.values(t[1])),system_id:e.rowinfo.系统ID},a=ye.A.writeScrapwork({...i})}console.log("info.operate ",i),a.then((t=>{console.log(t.data),200==t.data.code?this.$message({message:"修改成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata(),this.$store.commit("changeDevice")})).catch((e=>{this.$message({message:"修改失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$store.commit("changeDevice")}))},deleterow(e){ye.A.deleteScrapwork({system_id:e.rowinfo.系统ID,record_id:e.rowinfo.ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"操作成功",type:"success"}):this.$message({message:"操作失败稍后重试！",type:"error"}),this.$refs.basetable.addRowDialogVisible=!1,this.$refs.basetable.confirmDeleteDialogVisible=!1,this.getdata())})).catch((e=>{this.$message({message:"操作失败稍后重试！",type:"error"})}))},searchparams(e){this.filter_params=JSON.parse(JSON.stringify(e)),this.getdata()},getdata(){let e={};this.$set(this.tabledata,"data",[]),this.$refs.basetable&&(this.$refs.basetable.loading=!0,this.$refs.basetable.showsearch&&(e=this.filter_params)),ye.A.readScrapwork(e?{filter:JSON.stringify({...e})}:"").then((t=>{if(console.log(t.data.data),t.data.data[0]){e||(this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e})))),this.tabledata.columns=Object.keys(t.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.$refs.basetable&&(this.$refs.basetable.loading=!0);let a=t.data.data.map((e=>e.ID)),i=t.data.data.map((e=>e.系统ID));_e.A.idsscrabReportStatus({ids:a}).then((e=>{const a=t.data.data.map((t=>{const a=e.data.data.find((e=>e.id===t.ID));return{...t,...a||{}}}));_e.A.listReportStatus({systemIds:i}).then((e=>{let t=e.data.data.map((e=>({systemId:e.systemId,base_addFlag:e.addFlag,base_updateFlag:e.updateFlag})));const i=a.map((e=>{const a=t.find((t=>t.systemId===e.系统ID));return{...e,...a||{}}}));console.log("mergedTabledata",i),this.$set(this.tabledata,"data",i),this.$refs.basetable&&(this.$refs.basetable.loading=!1,this.$refs.basetable.showSelect&&this.chooseReport(this.$refs.basetable.messageinfo))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))})).catch((e=>{this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}else this.$refs.basetable&&(this.$refs.basetable.loading=!1)}))}},mounted(){this.getdata("")}},Rl=Dl,kl=(0,w.A)(Rl,cl,dl,!1,null,null,null),$l=kl.exports,Cl=function(){var e=this,t=e._self._c;return t("div",{staticClass:"introdunction"},[t("div",{staticClass:"deviceinfocontainer intor_list highlight"},[e.loading?t("img",{staticClass:"loadgif",attrs:{src:a(18788)}}):e._e(),e.tabledata.columns.length&&!e.loading?t("BaseTable",{ref:"basetable",attrs:{column:e.tabledata.columns,tabledata:e.tabledata.data,operate:["edit","delete","add"]},on:{addinfo:e.addinfo,deleterow:e.deleterow}}):e._e(),t("div",{staticClass:"echarts-foot"})],1)])},xl=[],Il=function(){var e=this,t=e._self._c;return t("div",[e._m(0),t("el-row",{attrs:{type:"flex"}},[e.showSelect?e._e():t("el-button",{staticClass:"plusicon",attrs:{type:"primary",icon:"el-icon-plus"},on:{click:e.openAddRowDialog}},[e._v("添加信息")])],1),t("div",{staticClass:"table-container"},[t("el-table",{key:e.showSelect,staticStyle:{width:"100%",background:"transparent"},attrs:{bordered:"","row-class-name":"rowstyle",data:e.paginatedData,"cell-class-name":e.getCellClassName,height:"calc(100vh - 3.2rem)"},on:{"selection-change":e.handleSelectionChange}},[e.showSelect?e._e():t("el-table-column",{attrs:{label:"操作",minWidth:"110rem"},scopedSlots:e._u([{key:"default",fn:function(a){return["delete"==e.operate[1]?t("el-button",{staticStyle:{color:"red","font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.confirmDeleteRow(a.row)}}},[e._v(" 删除 ")]):e._e(),t("el-button",{staticStyle:{"font-size":"0.175rem"},attrs:{type:"text",size:"small"},on:{click:function(t){return e.editRow(a.row)}}},[e._v(" 编辑 ")])]}}],null,!1,3157869969)}),e.showSelect?t("el-table-column",{attrs:{type:"selection",width:"55"}}):e._e(),e._l(e.columns,(function(i,s){return"ID"!=i.label?t("el-table-column",{key:s,attrs:{fit:"",prop:i.prop,label:i.label,sortable:i.sortable},scopedSlots:e._u([{key:"default",fn:function(s){return[s.row.editing?e._e():t("div",["检验报告上传"==i.prop||"停用/报废证明"==i.prop?t("div",{on:{click:function(t){return e.showbigimg(s.row[i.prop])}}},[s.row[i.prop]?t("img",{staticStyle:{width:"0.5rem"},attrs:{src:s.row[i.prop]}}):t("span",[e._v("未上传")])]):e._e(),"检验日期预报警状态"==i.prop?t("div",[t("img",{staticClass:"lightimage",style:"grey"!=s.row[i.prop]?"":"filter: grayscale(100%)",attrs:{src:"grey"!=s.row[i.prop]?a(84300)(`./${s.row[i.prop]}light.png`):a(18604)}})]):"检验日期预报警状态"!=i.prop&&"检验报告上传"!=i.prop&&"停用/报废证明"!=i.prop?t("span",[i.prop.indexOf("日期")>=0?t("span",[e._v(e._s(s.row[i.prop].replace("T00:00:00","")))]):t("span",[e._v(" "+e._s(s.row[i.prop])+" ")])]):e._e()])]}}],null,!0)}):e._e()}))],2),t("el-button",{staticClass:"plusicon",attrs:{type:"primary",size:"small"},on:{click:function(t){return e.$downloadExcel({tableData:e.tabledata,title:"企业自动化建设"})}}},[e._v("导出数据")])],1),"add"==e.operate[2]?t("el-dialog",{attrs:{title:e.operatetitle,visible:e.addRowDialogVisible,modal:!1,top:"0.8rem"},on:{"update:visible":function(t){e.addRowDialogVisible=t}}},[t("div",{staticClass:"dialog-content"},[t("el-form",{ref:"newRow",attrs:{model:e.newRow,"label-position":"top",rules:e.rules_data}},e._l(e.columns,(function(a){return"系统ID"!=a.label&&"ID"!=a.prop?t("el-form-item",{key:a.prop,attrs:{label:a.label,prop:a.prop}},["状态"==a.prop?t("div",[t("el-radio-group",{model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"类型"==a.prop?t("el-select",{staticStyle:{width:"8rem"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.deviceKind,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1):e._e(),a.prop.indexOf("时间")>=0?t("el-date-picker",{attrs:{type:"year",placeholder:"选择时间","value-format":"yyyy"},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e(),"传输方式"==a.prop?t("div",[t("el-radio-group",{model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}},e._l(e.checkdata1,(function(a){return t("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(a))])})),1)],1):e._e(),"是否有配套系统"==a.prop?t("el-switch",{attrs:{"active-text":"是","inactive-text":"否","active-value":1,"inactive-value":0},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):a.prop.indexOf("时间")<0&&"传输方式"!=a.prop&&"类型"!=a.prop?t("el-input",{staticStyle:{width:"8rem"},attrs:{placeholder:"请输入"+a.label},model:{value:e.newRow[a.prop],callback:function(t){e.$set(e.newRow,a.prop,t)},expression:"newRow[column.prop]"}}):e._e()],1):e._e()})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{type:"primary",loading:e.loadingbtn},on:{click:function(t){return e.addRow("newRow")}}},[e._v("保存")]),t("el-button",{on:{click:e.resetform}},[e._v("取消")])],1)]):e._e(),t("el-dialog",{attrs:{modal:!1,title:"确认删除",visible:e.confirmDeleteDialogVisible,width:"5rem"},on:{"update:visible":function(t){e.confirmDeleteDialogVisible=t},close:e.cancelDelete}},[t("span",[e._v("您确定要删除本行？")]),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{on:{click:e.cancelDelete}},[e._v("取消")]),t("el-button",{attrs:{type:"danger"},on:{click:function(t){return e.deleteRow(e.confirmedRow)}}},[e._v("确认删除")])],1)]),t("el-dialog",{attrs:{modal:!1,title:"文件查看",visible:e.imgdialog,"custom-class":"imgdialog",top:"1rem"},on:{"update:visible":function(t){e.imgdialog=t},close:function(t){e.imgdialog=!1}}},[t("div",{staticStyle:{width:"100%"}},[t("img",{staticStyle:{width:"100%"},attrs:{src:e.currimgsrc}})])]),e.tableData.length>e.pageSize?t("el-pagination",{ref:"pangination_n",staticClass:"el-pagin",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.total,layout:"total, prev, pager, next, sizes","page-sizes":e.pageSizes},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}):e._e()],1)},Al=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"machineTable"},[t("img",{staticClass:"loadgif",attrs:{src:a(18788),id:"show_loading2"}}),t("p",[e._v("正在上传报告。。。")])])}],zl={props:["column","tabledata","operate"],components:{Uploadocom:Ae},data(){return{tableData:[],currentPage:1,pageSize:10,pageSizes:[],total:0,columns:[],addRowDialogVisible:!1,newRow:{},confirmDeleteDialogVisible:!1,confirmedRow:null,value:"",loadingbtn:!1,deviceKind:["高炉","转炉","AOD精炼炉","LF精炼炉","VOD精炼炉","CAS精炼炉","IR精炼炉","RH精炼炉","电弧炉","Consteel炼钢炉","一氧化碳浓度报警器"],showloading2:"show_loading2",imgdialog:!1,currimgsrc:!1,checkedData1:"",operatetitle:"添加",rules_data:{},checkdata1:["可通过TCP/IP输出数据","可通过OPC通讯方式被读取","可通过Modbus输出数据"],showSelect:!1,showSelectvalue:[],pre_currentPage:1}},methods:{confirmSelectFunc(){this.$functionConfrim(this.showSelectvalue).then((e=>{console.log(e),"yes"==e&&this.$refs.multipleTable.clearSelection()}))},showSelectFunc(){this.showSelect=!this.showSelect,this.$nextTick((()=>{this.$forceUpdate()}))},handleSelectionChange(e){console.log(e),this.showSelectvalue=e},setPageSizes(){const e=this.tableData.length;this.pageSizes=[];for(let t=10;t<=e;t+=10)this.pageSizes.push(t);0===this.pageSizes.length&&this.pageSizes.push(10)},resetform(){this.addRowDialogVisible=!1,this.operatetitle="添加",this.initialform()},initialform(){this.$refs.newRow.resetFields()},cancelImg(e){this.newRow[e]=""},imageshowFunc(e,t){this.newRow[t]=e},showbigimg(e){this.imgdialog=!0,this.currimgsrc=e},listenUpload(){},handleCurrentChange(e){this.showSelectvalue.length?this.$alert("当前页尚有未完成的上报信息，请先完成上报功能","提示",{confirmButtonText:"确定",type:"warning"}).then((()=>{this.$nextTick((()=>{this.currentPage=this.pre_currentPage,this.$refs.pangination_n.internalCurrentPage=this.currentPage,this.$forceUpdate()}))})):(this.currentPage=e,this.pre_currentPage=e)},handleSizeChange(e){this.pageSize=e},viewDetails(e){console.log("查看详情:",e)},editRow(e){this.addRowDialogVisible=!0,this.newRow=JSON.parse(JSON.stringify(e)),console.log(e),console.log("是"==e["是否有配套系统"]?1:0),this.newRow["是否有配套系统"]="是"==e["是否有配套系统"]?1:0,console.log(this.newRow),this.operatetitle="编辑"},saveRow(e){e.editing=!1,console.log("保存行:",e)},confirmDeleteRow(e){1==this.paginatedData.length?this.$message({type:"warning",message:"只剩一条数据无法删除！",showClose:!0}):(this.confirmDeleteDialogVisible=!0,this.confirmedRow=e)},cancelDelete(){this.confirmDeleteDialogVisible=!1,this.confirmedRow=null},deleteRow(e){console.log(e),this.$emit("deleterow",{rowinfo:e,operate:"删除"})},openAddRowDialog(){this.addRowDialogVisible=!0,this.$nextTick((()=>{this.formatRow(),this.initialform()}))},addRow(e){console.log(this.newRow),this.$refs[e].validate((e=>{if(!e)return this.$message({message:"请完成所有必填项！",type:"error"}),!1;this.$emit("addinfo",{rowinfo:this.newRow,operate:this.operatetitle})}))},getCellClassName({row:e,column:t,rowIndex:a,columnIndex:i}){return"橙色预警"===e.age&&2===i?"orange-warning":""},formatRow(){this.newRow=this.columns.reduce(((e,t)=>(e[t.prop]="",e)),{}),this.newRow["是否有配套系统"]="0"}},computed:{paginatedData(){const e=(this.currentPage-1)*this.pageSize;return this.tableData.slice(e,e+this.pageSize)}},mounted(){this.columns=this.column,this.tableData=this.tabledata.map((e=>({...e}))),this.total=this.tableData.length,this.setPageSizes(),this.formatRow(),this.rules_data=this.$formatFormRules([],this.newRow,{"其他情况说明":{required:!1}})}},Ol=zl,Tl=(0,w.A)(Ol,Il,Al,!1,null,null,null),Vl=Tl.exports,Pl={components:{BaseTable:Vl},data(){return{tabledata:{columns:[],data:[]},loading:!0,current_newinfo:{}}},methods:{addinfo(e){console.log(e),delete e.rowinfo["key"],this.current_newinfo=JSON.parse(JSON.stringify(e.rowinfo)),"添加"==e.operate?this.addnewdata(e):"编辑"==e.operate&&this.deleterow(e)},addnewdata(e){let t=Object.values(this.current_newinfo).slice(1).join(",");this.$refs.basetable.loadingbtn=!0,console.log("添加数据",t),ye.A.writeAutocompanyInfo({data:t}).then((t=>{console.log(t.data),200==t.data.code?this.$message({message:e.operate+"成功",type:"success"}):this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn=!1,this.$refs.basetable.addRowDialogVisible=!1,this.getdata()})).catch((t=>{this.$message({message:e.operate+"失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn}))},deleterow(e){console.log("删除",e),console.log(e.rowinfo.ID);Object.values(e.rowinfo).slice(1).join(",");this.$refs.basetable.loadingbtn,ye.A.deleteAutocompanyInfo({id:e.rowinfo.ID}).then((t=>{console.log(t.data),"编辑"==e.operate?this.addnewdata(e):(200==t.data.code?this.$message({message:"删除成功",type:"success"}):this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn,this.$refs.basetable.addRowDialogVisible=!1,this.getdata())})).catch((e=>{this.$message({message:"删除失败稍后重试！",type:"error"}),this.$refs.basetable.loadingbtn}))},openAddRowDialog(){this.$refs.basetable.addRowDialogVisible=!0,this.$nextTick((()=>{this.$refs.basetable.formatRow(),this.$refs.basetable.initialform()}))},getdata(){this.tabledata={columns:[],data:[]},this.loading=!0,ye.A.autocompanyInfo().then((e=>{console.log(e.data.data),e.data.data[0]?(this.tabledata.columns=Object.keys(e.data.data[0]).filter((e=>"key"!=e)).map(((e,t)=>({prop:e,label:e}))),this.tabledata.data=e.data.data):this.$message({message:"查询列表为空",type:"success"}),this.loading=!1}))}},mounted(){this.getdata()}},Fl=Pl,Nl=(0,w.A)(Fl,Cl,xl,!1,null,null,null),jl=Nl.exports,Wl=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"0px",color:"white","overflow-y":"auto","overflow-x":"hidden",height:"calc(100% - 0px)","background-color":"black","padding-bottom":"1rem"}},[t("el-row",{staticStyle:{padding:"0px",height:"100%",color:"#6cc9d3",margin:"0px 0"},attrs:{type:"flex"}},[t("el-col",{staticClass:"title highlight",attrs:{span:14}},[t("h1",[e._v("煤气柜参数")]),t("watchlist",{attrs:{deviceType:e.deviceType,widthval:[15,3]}})],1),t("el-col",{attrs:{span:10}},[t("img",{staticClass:"highbottle-image",attrs:{src:a(701),alt:"High Bottle Image"}})])],1),t("div",{staticClass:"echarts-foot"})],1)},Ml=[],Ll={components:{watchlist:vt},data(){return{deviceType:"07"}}},El=Ll,Jl=(0,w.A)(El,Wl,Ml,!1,null,"a4546d46",null),Ul=Jl.exports,Bl=function(){var e=this,t=e._self._c;return t("div",{staticStyle:{"padding-top":"0px",color:"white",height:"100%"}},[t("el-row",{staticClass:"highlight-corner highlight",staticStyle:{padding:"0px",height:"100%",color:"#6cc9d3",margin:"0px 0.1rem"},attrs:{type:"flex"}},[t("el-col",{staticClass:"title highlight",attrs:{span:12}},[t("h1",[e._v("液氧储槽参数")]),t("watchlist",{attrs:{deviceType:e.deviceType,widthval:[11,5]}})],1),t("el-col",{staticClass:"back_device",staticStyle:{background:"black",position:"relative"},attrs:{span:12}},[t("img",{staticClass:"highbottle-image",attrs:{src:a(40140),alt:"High Bottle Image"}})]),t("div",{staticClass:"echarts-foot"})],1)],1)},ql=[],Xl={components:{watchlist:vt},data(){return{deviceType:"14"}}},Hl=Xl,Gl=(0,w.A)(Hl,Bl,ql,!1,null,"62b964fc",null),Kl=Gl.exports,Zl=function(){var e=this,t=e._self._c;return t("div",{staticClass:"base_list highlight introduction",staticStyle:{"padding-top":"20px",padding:"10px","margin-top":"0.25rem"}},[e.iChannelIDList.length?t("allSplit",{attrs:{loginIp:"200.150.100.252",port:"80",username:"admin",password:"ZG20241019",iChannelIDList:e.iChannelIDList}}):e._e(),t("div",{staticStyle:{width:"50%","text-align":"center",position:"fixed",bottom:"0.1rem"}},[t("Navbar")],1)],1)},Ql=[],Yl=a(34829),er=a(25882),tr=function(){var e=this,t=e._self._c;return t("div",{staticClass:"video_wrapper_box",attrs:{id:e.pluginId}})},ar=[],ir={props:{loginIp:{type:String,default:"200.150.100.252"},port:{type:String,default:"80"},username:{type:String,default:"admin"},password:{type:String,default:"ZG20241019"},iChannelIDIndex:{type:Number,default:1},iChannelIDList:{type:Array}},watch:{iChannelIDList:{deep:!0,immediate:!0,handler(e,t){if(e){this.iChannelIDIndexList=e;const t=this.iChannelIDIndexList.length/2;this.iWndowType=t%1===0?t:Math.ceil(t),console.log(" this.iChannelIDIndexList:",this.iChannelIDIndexList)}}}},data(){return{pluginId:"video_"+this.generateUUID(),channelsList:[],currChannels:{},iDevicePort:"",iRtspPort:"",szDeviceIdentify:"",iWndowType:1,g_iWndIndex:0,iChannelIDIndexList:[]}},methods:{initVideoCtrl(){var e=WebVideoCtrl.I_CheckPluginInstall();if(-1===e)return alert("您还未安装过插件，双击开发包目录里的WebComponentsKit.exe安装！"),!1;WebVideoCtrl.I_InitPlugin({bWndFull:!0,iPackageType:2,iWndowType:this.iWndowType,bNoPlugin:!0,cbSelWnd:e=>{this.g_iWndIndex=parseInt(C()(e).find("SelectWnd").eq(0).text(),10),console.log("窗口ID-当前选择的窗口编号：",this.g_iWndIndex)},cbInitPluginComplete:()=>{WebVideoCtrl.I_InsertOBJECTPlugin(this.pluginId).then((()=>{if(console.log("嵌入插件"),this.$nextTick((()=>{this.changeWndNum(this.iWndowType),this.clickLogin()})),-1===WebVideoCtrl.I_CheckPluginVersion())return alert("检测到新的插件版本，双击开发包目录里的WebComponentsKit.exe升级！"),!1}),(()=>{let e="插件初始化失败，请确认是否已安装插件；如果未安装，请双击开发包目录里的HCWebSDKPlugin.exe安装！";this.$message.error(e),console.log(e),this.loading=!1}))}})},changeWndNum(e){e=parseInt(e,10),WebVideoCtrl.I_ChangeWndNum(e)},clickLogin(){if(""===this.loginIp||""===this.port)return;this.szDeviceIdentify=this.loginIp+"_"+this.port,console.log("登录所需参数",this.loginIp,1,this.port,this.username,this.password);const e=WebVideoCtrl.I_Login(this.loginIp,1,this.port,this.username,this.password,{success:e=>{console.log(" 登录成功！",e),setTimeout((()=>{this.getChannelInfo(),this.getDevicePort()}),10),setTimeout((()=>{this.setIChannelID()}),1e3)},error:(e,t)=>{console.log(" 登录失败！",e,t)}});-1===e&&(console.log(this.szDeviceIdentify+" 已登录过！"),this.setIChannelID())},setIChannelID(){if(0===this.channelsList.length)return!1;console.log("开始设置通道");this.iChannelIDIndexList.map(((e,t)=>{console.log(e,t,"通道编号和窗口编号"),setTimeout((()=>{this.g_iWndIndex=t,this.clickStartRealPlay(e,t)}),200*t)}))},clickStartRealPlay(e,t){if(console.log("开始预览"),!this.channelsList.length)return console.log("通道信息获取异常！"),!1;if(!this.iRtspPort)return console.log("RTSP端口获取异常！"),!1;const a=WebVideoCtrl.I_GetWindowStatus(this.g_iWndIndex),i=()=>{if(console.log("预览参数iRtspPort:"+this.iRtspPort),console.log("预览参数-通道列表:"+JSON.stringify(this.channelsList)),console.log("预览参数-通道号iChannelID:"+ChannelMergerNode),this.channelsList.length<=this.iChannelIDIndex)return console.log("当前通道长度小于传入的通道索引",this.channelsList.length,this.iChannelIDIndex),!1;WebVideoCtrl.I_StartRealPlay(this.szDeviceIdentify,{iRtspPort:this.iRtspPort,iStreamType:2,iChannelID:e,bZeroChannel:!1,iWndIndex:t,success:()=>{console.log("开始预览成功")},error:(e,t)=>{403===e?console.log("设备不支持Websocket取流！"):console.log("开始预览失败！"),console.log("预览失败",e+" "+t)}})};null!==a?(console.log("已经在播放了，先停止！"),console.log("停止窗口编号："+this.g_iWndIndex),WebVideoCtrl.I_Stop({iWndIndex:this.g_iWndIndex,success:()=>{console.log("停止成功，开始播放！"),i()},error:()=>{console.log("停止播放异常！")}})):(console.log("开始播放！"),i())},getChannelInfo(){if(this.channelsList=[],""===this.szDeviceIdentify)return!1;WebVideoCtrl.I_GetDigitalChannelInfo(this.szDeviceIdentify,{async:!1,success:e=>{var t=C()(e).find("InputProxyChannelStatus");console.log(t);const a=this;return C().each(t,(function(e){const t=C()(this).find("id").eq(0).text();let i=C()(this).find("name").eq(0).text();const s=C()(this).find("online").eq(0).text();if("false"===s)return!0;""===i&&(i="IPCamera "+(e<9?"0"+(e+1):e+1)),a.channelsList.push({id:t,name:i,bZero:!1})})),console.log(this.szDeviceIdentify+" 获取数字通道成功！"),!0},error:(e,t)=>(console.log(this.szDeviceIdentify+" 获取数字通道失败！",e,t),!1)})},async getDevicePort(){if(""===this.szDeviceIdentify)return!1;const e=await WebVideoCtrl.I_GetDevicePort(this.szDeviceIdentify);return null!=e?(this.iDevicePort=e.iDevicePort,this.iRtspPort=e.iRtspPort,console.log(this.szDeviceIdentify),console.log(e),console.log(JSON.stringify(e)+" 获取端口成功！"),!0):(console.log(JSON.stringify(e)+" 获取端口失败！"),!1)},async clickLogout(){console.log(this.loginIp+"_"+this.port+" "),console.log(this.szDeviceIdentify),WebVideoCtrl.I_Logout(this.szDeviceIdentify).then((()=>{console.log("退出成功"),WebVideoCtrl.I_DestroyPlugin(this.szDeviceIdentify)}),(()=>{console.log("退出失败！")}))},generateUUID(){let e=(new Date).getTime(),t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{let a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:3&a|8).toString(16)}));return t}},mounted(){setTimeout((()=>{this.initVideoCtrl()}),200)},beforeDestroy(){this.clickLogout()}},sr=ir,or=(0,w.A)(sr,tr,ar,!1,null,"7e8eed4c",null),lr=or.exports,rr={components:{Navbar:r.A,allSplit:lr},data(){return{cameras:[],camerasInfo:[],curr_area_video:{},loading:!1,iChannelIDList:[]}},methods:{async getVideoinfo(e){if(e){this.curr_area_video=JSON.parse(e);for(const e of this.curr_area_video.children){const a=e.path.split("/");if(a.length>0){const e=a[a.length-1];try{const t=await(0,Yl.AX)({pageNum1:1,pageSize:1e4,siteId:e});if(200!=t.code)return this.$message({type:"warning",message:"登录已过期,自动重新登录",showClose:!0}),setTimeout((()=>{this.$router.push("/")}),2e3),!1;this.updateVideoDvices(t.rows)}catch(t){console.error(`查询 video device 失败: ${t.message}`)}}}this.cameras.find((e=>console.log(e.hkData.nvrAddress))),this.cameras=this.filterData(this.cameras),console.log("aaaa",this.cameras),console.log("vvv",this.loginIp),this.cameras.map(((e,t)=>{e.loadingtime=3500*t,this.iChannelIDList.push(e.hkData.channelID)})),this.camerasInfo=JSON.parse(JSON.stringify(this.cameras))}else console.error("curr_videoinfo 为空")},filterData(e){const t=e.reduce(((e,t)=>(e.has(t.hkData.channelID)||e.set(t.hkData.channelID,t),e)),new Map),a=Array.from(t.values());return a},updateVideoDvices(e){let t={};e.forEach(((e,a)=>{const i=e.name,s=e.parameterString,o=e.protocol;t={id:e.id+"",siteId:e.siteId};try{const e=JSON.parse(s);if(e)if(t.protocol=o,"hkvideo"===o){const a=(0,er.I)(e);t.hkData=a,console.log("camera",t)}else if("rtsp"===o){const a=(0,er.O)(e);t.rtspData=a}this.cameras.push(t)}catch(l){console.warn(`parse video device ${i} 参数字符串出错: ${l.message}`)}}))}},mounted(){},watch:{curr_videoinfo:{handler(e){e&&(this.cameras=[],this.camerasInfo=[],this.iChannelIDList=[],this.getVideoinfo(e))},immediate:!0,deep:!0}},computed:{curr_videoinfo(){return this.$store.state.curr_videoinfo}}},nr=rr,cr=(0,w.A)(nr,Zl,Ql,!1,null,null,null),dr=cr.exports,hr=function(){var e=this,t=e._self._c;return t("div",{staticClass:"base_list highlight",staticStyle:{padding:"20px","overflow-y":"hidden","margin-top":"0.25rem",height:"calc(100% - 0.9rem)"}},[t("div",[t("el-date-picker",{staticStyle:{"margin-left":"3px",width:"5rem"},attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","append-to-body":!1},on:{change:e.getTimeRange},model:{value:e.timeRange,callback:function(t){e.timeRange=t},expression:"timeRange"}}),t("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(t){return e.clickRecordSearch()}}},[e._v("搜索")])],1),t("el-row",{staticClass:"videoListwarning"},e._l(e.paginatedArray,(function(a,i){return t("el-col",{key:a.url+i,staticClass:"warninglist",attrs:{span:4},nativeOn:{click:function(t){return e.showWarninginfo(a)}}},[t("el-card",{attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[t("img",{staticStyle:{height:"2rem"},attrs:{src:"https://5b0988e595225.cdn.sohucs.com/images/20180206/e0cda08a97574f098f06dccfc51e7821.jpeg"}}),t("div",{staticStyle:{padding:"14px",color:"white"}},[t("span",[e._v(" "+e._s(a.drawContent[0].text))]),t("div",{staticClass:"bottom clearfix"},[t("time",{staticClass:"time",staticStyle:{color:"grey"}},[e._v(e._s(a.createdAt))])])])])],1)})),1),t("el-col",[t("el-pagination",{staticClass:"e-pagin-gas",attrs:{"current-page":e.currentPage,"page-size":e.pageSize,total:e.totalItems,layout:"total, prev, pager, next, jumper"},on:{"current-change":e.handleCurrentChange}})],1),t("div",{staticStyle:{width:"50%","text-align":"center",position:"fixed",bottom:"0.1rem"}},[t("Navbar")],1),t("div",{staticClass:"echarts-foot"}),e.dialogshow?t("el-dialog",{attrs:{modal:!1,title:"报警详情",visible:e.dialogshow,width:"900px","custom-class":"warndialogshow",bodyStyle:{"padding-top":0,"min-height":"300px"},top:"0.6rem"},on:{"update:visible":function(t){e.dialogshow=t},close:e.closeChart}},[t("div",{staticStyle:{width:"100%"}},[t("videowarnmodal")],1)]):e._e()],1)},pr=[],gr=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{height:"7rem"}},[t("el-row",[t("el-col",{attrs:{span:8}},[t("div",[e._v("摄像头id："+e._s(e.singedata.cameraId))]),t("div",[e._v(" 摄像头信息："+e._s(e.singedata.cameraName)+" ")]),t("div",[e._v(" 报警信息： "+e._s(e.singedata.cameraDeviceGroup)+"_"+e._s(e.singedata.algorithmName)+" ")]),t("img",{staticClass:"hover-zoom",staticStyle:{width:"100%","margin-top":"0.5rem"},attrs:{src:e.singedata.alarmUrl}})]),e.loading?e._e():t("el-col",{attrs:{span:12,offset:1}},[t("hkvideo",{staticStyle:{height:"400px",width:"500px"},attrs:{data:e.camera,newId:"dialog01"}})],1)],1)],1)},ur=[],mr=a(98145),fr={data(){return{singedata:{},loading:!1,camera:{}}},components:{hkvideo:mr.A},methods:{parseRtspUrl(){let e=this.singedata.cameraUrl;try{const t=/^rtsp:\/\/(?<userName>[^:]+):(?<passWord>[^@]+)@(?<nvrAddress>[^:/]+)(?::(?<rtspPort>\d+))?\/Streaming\/Channels\/(?<channelID>\d{3,4})\?(?<queryParams>.*)$/,a=e.match(t);if(!a||!a.groups)throw new Error("Invalid RTSP URL format");const{userName:i,passWord:s,nvrAddress:o,rtspPort:l="554",channelID:r,queryParams:n}=a.groups,c={};n.split("&").forEach((e=>{const[t,a]=e.split("=");t&&a&&(c[t]=a)}));const d="unicast"===c.transportmode,h=parseInt(r.slice(0,r.length-2),10),p=parseInt(r.slice(-2),10);return{analogMode:!1,rtspPort:l,nvrAddress:o,userName:i,passWord:s,port:"80",channelID:h,transStream:d,streamType:p}}catch(t){throw console.error(`Error parsing RTSP URL "${e}":`,t.message),t}}},mounted(){this.loading=!0,this.singedata={parameter:{roiList:[]},picture:"picture/20230613/20230613144252_722054_4_21_alarm.jpg",srcUrl:"http://192.168.0.106:8081/files/originPicture/20230613/20230613144252_722054_4_21 _src.jpg?serverUUID = 3 f16a3b113234807b81f6f8d0f268232 ",resultData:{classId:1,score:0,objectList:[{classId:0,score:.727403,scoreList:[.727403,.558674,1],rect:{x:1285,y:804,width:217,height:265}}]},extraInfo:{},result:"resultJson/20230613/20230613144252_722054_4_21_result.json?serverUUID = 3f16a3b113234807b81f6f8d0f268232 ",video:null,other:"",alarm:"picture/20230613/20230613144252_722054_4_21_alarm.jpg?serverUUID = 3 f16a3b113234807b81f6f8d0f268232 ",src:"originPicture/20230613/20230613144252_722054_4_21_src.jpg?serverUUID = 3 f16a3b113234807b81f6f8d0f268232 ",alarmPicData:"",alarmPicName:"20230613144252_722054_4_21_alarm.jpg",srcPicName:"20230613144252_722054_4_21_src.jpg",srcPicData:"",imageHeight:1080,alarmUrl:"https://5b0988e595225.cdn.sohucs.com/images/20180206/e0cda08a97574f098f06dccfc51e7821.jpeg",taskId:4,cameraId:21,cameraUrl:"rtsp://admin:ZG20241019@200.150.100.252/Streaming/Channels/101?transportmode=unicas",cameraName:"10666",timestamp:1686638572,imageWidth:1920,algorithmId:4,algorithmName:"行人闯入",algorithmNameEn:"CR_PERSON_INVASION",cameraDeviceForeignKey:null,cameraDeviceType:1,cameraDeviceStreamUrl:"rtsp://admin:ZG20241019@200.150.100.252/Streaming/Channels/101?transportmode=unicast",cameraDeviceStatus:1,cameraDeviceGroup:"未分组",cameraDeviceGps:"",cameraDeviceName:"10666",cameraDeviceId:21,dataID:"984f8f7809c611eeb9270242c0a8700d"},this.camera=this.parseRtspUrl(),setTimeout((()=>{this.loading=!1}),1e3)}},wr=fr,br=(0,w.A)(wr,gr,ur,!1,null,null,null),vr=br.exports,yr={components:{Navbar:r.A,videowarnmodal:vr},data(){return{timeRange:[],alertList:[],currentPage:1,pageSize:10,dialogshow:!1}},methods:{closeChart(){},showWarninginfo(e){console.log(e),this.dialogshow=!0},handleCurrentChange(e){this.currentPage=e},getTimeRange(){}},mounted(){this.alertList=[];for(let e=0;e<1800;e++)this.alertList.push({drawContent:[{type:"classId",value:1,text:"安全帽"+e}],alertId:"24",alertType:"报警类型名称",associateId:1,associateResult:"",associateType:"",cameraId:14,cameraName:"点位名称",createdAt:"2021-07-23 17:32:38",dataID:"",degree:5,id:304673,origin:"https://5b0988e595225.cdn.sohucs.com/images/20180206/e0cda08a97574f098f06dccfc51e7821.jpeg",other:null,result:"http://192.168.0.111:11111/path/to/jpg/1.json",streamUrl:"rtsp://admin:let@192.168.1.111:502/h264/ch33/main/av_stream",taskId:15,url:"https://5b0988e595225.cdn.sohucs.com/images/20180206/e0cda08a97574f098f06dccfc51e7821.jpeg",video:""})},computed:{totalItems(){return this.alertList.length},paginatedArray(){const e=(this.currentPage-1)*this.pageSize;return this.alertList.slice(e,e+this.pageSize)}}},_r=yr,Sr=(0,w.A)(_r,hr,pr,!1,null,null,null),Dr=Sr.exports;i["default"].use(s.Ay);const Rr=e=>{const t={};e.forEach((e=>{t[e.id]={...e,children:[]}}));const a=[];return e.forEach((e=>{null!==e.parentId&&t[e.parentId]?t[e.parentId].children.push(t[e.id]):a.push(t[e.id])})),a},kr=async e=>{console.log("router",e.history.current);let t=[];const a=await(0,Q.z9)();if(console.log(a),200==a.code){const e=JSON.parse(JSON.stringify(a.rows));let i=Rr(e);i.map(((e,a)=>{t[a]={name:e.plant,index:"/"+e.id,children:[]},t[a].children=e.children.map((e=>({name:e.name,path:`/videomonit/bottle/${e.id}`})))})),console.log(t)}const i=[];return t.forEach((e=>{let t={path:e.index,name:e.name,component:te["default"],children:[]};e.children?e.children.forEach((e=>{t.children.push({path:e.path,name:e.name,component:ee["default"],props:e=>({name:e.params.name})})})):t={path:e.path,name:e.name,component:te["default"]},i.push(t)})),i.unshift({path:"/warningvideo",name:"视频报警",component:Dr}),console.log(i),i},$r=[{path:"/",name:"login",component:oe},{path:"/index",name:"index",component:H},{path:"/menu",name:"menu",component:he,children:[{path:"/basicinfo",name:"基础信息",component:we,redirect:"/basicinfo/introduction",children:[{path:"introduction",name:"企业基础信息",component:je},{path:"autocompany",name:"企业自动化系统建设",component:jl},{path:"personalrecord",name:"企业专项信息",component:Ue},{path:"deviceinfo",name:"设施设备信息",component:we,children:[{path:"devicetallbottle",name:"高炉",component:Ta},{path:"devicerotatebottle",name:"转炉",component:Ba},{path:"gasbox",name:"煤气柜",component:pi},{path:"gasbox",name:"煤气柜",component:pi},{path:"devicecontinuous",name:"连铸机",component:Ri},{path:"deviceHangmachine",name:"吊运熔融金属起重机",component:Fi},{path:"devicemoltentanl",name:"熔融金属罐体",component:Hi},{path:"glassgasdevice",name:"煤气设施（管道）眼镜阀组合式隔断装置",component:ls},{path:"gasdrainerdevice",name:"正压煤气管道水封式煤气排水器",component:bs},{path:"deviceCowarnning",name:"固定式一氧化碳报警器",component:As},{path:"deviceEmergencyfac",name:"炼钢（连铸）生产过程熔融金属紧急排放和应急储存设施",component:Gs},{path:"deviceReliefset",name:"高炉生产过程炉顶放散阀联锁放散压力设定",component:ro}]},{path:"companydaily",name:"企业日常数据",component:we,children:[{path:"checkout",name:"点检记录",component:$o},{path:"regularcheck",name:"定期检验/校准记录",component:Uo},{path:"stopwork",name:"设备停用记录",component:nl},{path:"scrabwork",name:"设备报废记录",component:$l}]}]},{path:"/datashow",name:"感知数据",component:Ke,redirect:"/datashow/highbottleshow",children:[{path:"highbottleshow",name:"高炉",component:Dt},{path:"rotatebottleshow",name:"1#转炉",component:It},,{path:"rotatebottleshowtwo",name:"2#转炉",component:Pt},{path:"gasboxshow",name:"煤气柜",component:Ul},{path:"oxgenshow",name:"液氧储槽",component:Kl},{path:"cowarning",name:"固定式一氧化碳报警器",component:ei},{path:"warning",name:"报警信息",component:Qt}]},{path:"/videomonit",name:"视频监控",component:ee["default"],redirect:"/videomonit/bottle/1",children:[]},{path:"/warningvideo",name:"视频报警",component:Dr},{path:"/videoall",name:"视频监控",component:dr}]}],Cr=new s.Ay({routes:$r});function xr(e){console.log(e),e.forEach((e=>{Cr.addRoute("menu",e)}))}(async()=>{const e=await kr(Cr);console.log("dynamicRoutes",e),Cr.addRoutes([{path:"/menu",name:"menu",component:he,children:[...e]}])})();var Ir=Cr},61250:function(e,t,a){"use strict";a.d(t,{A:function(){return d}});var i=a(93518),s=a(66848),o=a(47149),l=a(43603);const r={state:{token:(0,l.gf)(),name:"",avatar:"",roles:[],permissions:[]},mutations:{SET_TOKEN:(e,t)=>{e.token=t},SET_NAME:(e,t)=>{e.name=t},SET_AVATAR:(e,t)=>{e.avatar=t},SET_ROLES:(e,t)=>{e.roles=t},SET_PERMISSIONS:(e,t)=>{e.permissions=t}},actions:{Login({commit:e},t){const a=t.username.trim(),i=t.password,s=t.code,r=t.uuid;return new Promise(((t,n)=>{(0,o.iD)(a,i,s,r).then((a=>{(0,l.WG)("Admin-Token",a.token),e("SET_TOKEN",a.token),t()})).catch((e=>{n(e)}))}))},GetInfo({commit:e,state:t}){return new Promise(((t,i)=>{(0,o.Vp)().then((i=>{const s=i.user,o=""==s.avatar||null==s.avatar?a(61120):{NODE_ENV:"production",BASE_URL:"/"}.VUE_APP_BASE_API+s.avatar;i.roles&&i.roles.length>0?(e("SET_ROLES",i.roles),e("SET_PERMISSIONS",i.permissions)):e("SET_ROLES",["ROLE_DEFAULT"]),e("SET_NAME",s.userName),e("SET_AVATAR",o),t(i)})).catch((e=>{i(e)}))}))},LogOut({commit:e,state:t}){return new Promise(((a,i)=>{(0,o.ri)(t.token).then((()=>{e("SET_TOKEN",""),e("SET_ROLES",[]),e("SET_PERMISSIONS",[]),(0,l.eF)(),a()})).catch((e=>{i(e)}))}))},FedLogOut({commit:e}){return new Promise((t=>{e("SET_TOKEN",""),(0,l.eF)(),t()}))}}};var n=r;s["default"].use(i.Ay);const c=new i.Ay.Store({modules:{user:n},state:{device_change:"",videoData:[],viedo_route:[],loginflag:!1,curr_videoinfo:""},getters:{device_change(e){return e.gameGenaral}},mutations:{changeDevice(e,t){e.device_change=(new Date).getTime(),console.log(e.device_change)},changevideoData(e,t){e.videoData=t},viedomenu(e,t){e.viedo_route=t},haslogin(e,t){e.loginflag=t},curr_video(e,t){e.curr_videoinfo=t}}});var d=c},43603:function(e,t,a){"use strict";a.d(t,{WG:function(){return o},eF:function(){return l},gf:function(){return s}});var i=a(78704);function s(e){return i.A.get(e)}function o(e,t){return i.A.set(e,t)}function l(e){return i.A.remove(e)}},25882:function(e,t,a){"use strict";a.d(t,{I:function(){return i},O:function(){return s}});function i(e){for(var t={analogMode:!1},a=0;a<e.length;a++){var i=e[a];"rtsp_port"==i.name?t.rtspPort=i.value:"nvr_address"==i.name?t.nvrAddress=i.value:"user_name"==i.name?t.userName=i.value:"pass_word"==i.name?t.passWord=i.value:"port"==i.name?t.port=i.value:"channel_id"==i.name?t.channelID=i.value:"trans_stream"==i.name?t.transStream=i.value:"stream_type"==i.name?t.streamType=i.value:"analog_mode"==i.name&&(t.analogMode=i.value)}return t}function s(e){for(var t={},a=0;a<e.length;a++){var i=e[a];"rtsp_port"==i.name?t.rtspPort=i.value:"rtsp_url"==i.name&&(t.rtspUrl=i.value)}return t}},44453:function(e,t,a){"use strict";a.d(t,{Ay:function(){return g}});var i=a(94373),s=a(43603),o={401:"认证失败，无法访问系统资源",403:"当前操作没有权限",404:"访问资源不存在",default:"系统未知错误，请反馈给管理员"},l=a(89143);a(61250),a(47149),a(44114);function r(e){let t="";for(const s of Object.keys(e)){const o=e[s];var a=encodeURIComponent(s)+"=";if(null!==o&&"undefined"!==typeof o)if("object"===typeof o){for(const e of Object.keys(o))if(null!==o[e]&&"undefined"!==typeof o[e]){let a=s+"["+e+"]";var i=encodeURIComponent(a)+"=";t+=i+encodeURIComponent(o[e])+"&"}}else t+=a+encodeURIComponent(o)+"&"}return t}const n={set(e,t){sessionStorage&&null!=e&&null!=t&&sessionStorage.setItem(e,t)},get(e){return sessionStorage?null==e?null:sessionStorage.getItem(e):null},setJSON(e,t){null!=t&&this.set(e,JSON.stringify(t))},getJSON(e){const t=this.get(e);if(null!=t)return JSON.parse(t)},remove(e){sessionStorage.removeItem(e)}},c={set(e,t){localStorage&&null!=e&&null!=t&&localStorage.setItem(e,t)},get(e){return localStorage?null==e?null:localStorage.getItem(e):null},setJSON(e,t){null!=t&&this.set(e,JSON.stringify(t))},getJSON(e){const t=this.get(e);if(null!=t)return JSON.parse(t)},remove(e){localStorage.removeItem(e)}};var d={session:n,local:c};a(46002),a(37303);const h="/requestapi",p=i.A.create({baseURL:h,timeout:12e4});p.interceptors.request.use((function(e){(e.headers||{}).isToken;const t=!1===(e.headers||{}).repeatSubmit;if(e.headers["Authorization"]="Bearer "+(0,s.gf)("Admin-Token"),"get"===e.method&&e.params){let t=e.url+"?"+r(e.params);t=t.slice(0,-1),e.params={},e.url=t}if(!t&&("post"===e.method||"put"===e.method)){const t={url:e.url,data:"object"===typeof e.data?JSON.stringify(e.data):e.data,time:(new Date).getTime()},a=d.session.getJSON("sessionObj");if(void 0===a||null===a||""===a)d.session.setJSON("sessionObj",t);else{a.url,a.data,a.time;d.session.setJSON("sessionObj",t)}}return e}),(function(e){return Promise.reject(e)})),p.interceptors.response.use((function(e){const t=e.data.code||200,a=o[t]||e.data.msg||o["default"];return"blob"===e.request.responseType||"arraybuffer"===e.request.responseType?e.data:401===t?((0,s.eF)("Admin-Token"),(0,s.eF)("Report-Token"),e.data):500===t?((0,l.Message)({message:a,type:"error",duration:5e3}),Promise.reject(new Error(a))):200!==t?(l.Notification.error({title:a}),Promise.reject("error")):e.data}),(e=>{console.log("err"+e);let{message:t}=e;return"Network Error"==t?t="后端接口连接异常":t.includes("timeout")?t="系统接口请求超时":t.includes("Request failed with status code")&&(t="系统接口"+t.substr(t.length-3)+"异常"),(0,l.Message)({message:t,type:"error",duration:5e3}),Promise.reject(e)}));var g=p},84300:function(e,t,a){var i={"./greenlight.png":18604,"./orangelight.png":18417,"./redlight.png":39472,"./yellowlight.png":60751};function s(e){var t=o(e);return a(t)}function o(e){if(!a.o(i,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return i[e]}s.keys=function(){return Object.keys(i)},s.resolve=o,e.exports=s,s.id=84300},40140:function(e,t,a){"use strict";e.exports=a.p+"img/O2.14dbd3f3.png"},81462:function(e,t,a){"use strict";e.exports=a.p+"img/bluebg.09bc108c.png"},31248:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFYAAAAQCAYAAACMV4iGAAAAAXNSR0IArs4c6QAAA3BJREFUWEflmDt2IkcUhr97qx+AmgFZ8ku5I63Aa3A8S5jJnTgmdubUXsLEXoNXoMAbkOfY0hGIFqIfda9PAZJHyIlCDZXUoaBPd33c/uv/r7A3Zu66W9JLkDMQQBfbmclu3r/uc/68AN/tPc12CX62XbO0PhPZzJ+ODazNcJe3oMegZxCAjDkZgaxVQiEEBHVB+wOCm4GLYzjWOrEwIpGeKT3QX0K8AfuQIIts/oA0tmB3UL+B7ARybinajFKVAcog6yijkCNkKgSBh6r+nAt1iwbMnIjTB6frcxqMtRnroqfhDe01dB+h/xTuBmx6/S8hvIGiuqXscoaiVBKpUKogDIkMEIoE17YVfRBD2ULFaS3QuLPCqD1Qu1HnHff1G5pbaM8gPsjCBuxb93AO+T2UYcVIA1UWmVjgWI2JCWMVjswoE1w9ILC2Bduq0phzp87SlIVGbvrAwiJ1HLEaQnMB3QeR+CgFM/cMKJolQ82pNDANkROcU5RTd6ZgY3GGLpRJf+UAdNa3B1QvTuPCPehShDnGFcJVDFxbZG4ddTlO39PORJL2bjV2B3bQ3nFUZEwwvrDA13pjP/hC3h3EO/+CTcrEf7Nj/d0jfwfluu1ZFEfcAesnYN+751MYZCsqzZiKcRo6vvOP/gtO9YJ7HsZPhVq+kh9jyZ+uXFnPvB9Rz2H9q0i3rVh3eQ/ZA9hUsW6cyl/+s3d8fxikXr5LyfnDv5WfRLlKFfsIFvpkux6loIYyrxmVOWMiUwucqPOlyWaeuNhYjGE6vJyN5frPA7/8uV7FFUljZXd4uXIvrksTFupcm/CPRq4JzJuOZVexqqB5prELyMsFg1AwysMWLsrUjIkKYxdGbpQi5IfmY93pRGnEWZmzVGWBMU9Qu8gytqyaCesJdE/AJruVwsEQilAz0IxRrhzFyDgkmyUMNVktKCwlsAMKCCm2agoI0JrSqHMfnbsQWHbGnfWsYsX6HtpNSNizW5uAcATZBPKmptTAQFLqSvaqp9gkrxRzBQ0HIAMPWhWT5UqRlm3yIqPtk/1K6SuyLiuaBXR30D8LCPt9ghpCgEyXZKJkh9oneIC73y9wo7cxfYS+gvh//YInTZgZyAXIOUjqbJWgJyCps3WIXa39EzZ1uSbg1+ANWOpwXYCfg89SZT9rwryKM/p1PeS/2wW3INBhQu4AAAAASUVORK5CYII="},4930:function(e,t,a){"use strict";e.exports=a.p+"img/codeco.f91e3223.jpg"},701:function(e,t,a){"use strict";e.exports=a.p+"img/gasbox.268caa5c.png"},4903:function(e,t,a){"use strict";e.exports=a.p+"img/greenbg.5c00140f.png"},18604:function(e,t,a){"use strict";e.exports=a.p+"img/greenlight.f1d0ebaf.png"},80383:function(e,t,a){"use strict";e.exports=a.p+"img/highbottle.086daa99.jpg"},69487:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAABRtJREFUeF7tm33IXnMYxz9f7/JOlCxleWthCGNL/hJCFP+ghqFhy8S8NNPE1iwvKxk1RoskUQhR/qG11aSNEmPe//GSlyTvfHXN717nOTv3c9/n3M99P8557uufu+7zu65zfb/nd67f2/eIHsz2FcBuwEpJv/UQqrSr7SnA2cD7kl4qHSA5qKqj7VXArOT/DjBd0i9V45Xxs30CsB5o5T9b0soyMVptKxFge3/gm9wNz5H0cpUkyvrYfhCYk/HbKOm4snGifVUCDgc25W54kaSnqyRR1sf2I8CVGb8Nko4vG6cXAiYDm3MEXijpuSpJlPWxvQK4NuO3XtK0snGGBPTwCkz4HnAI8PFEfgW2A/7KETBD0toq72FZH9tLgAUZvzclnVY2zjY1wHYUklOA/YC/ARcEjf/3AeYB22euPwNsAHaukkgJnz+Ac1OeLbdPgEeBndrEidEuHloM3WskbdxmHmD7IeCaEonUuekDkuIB/jcPsP0YcHmdEVXIfYmkhbJ9DBBT2Ylok4OAW4GlGfT/AD83kI0dgV1zuGYFAXcBCzMXPgOObVMA68xLFPb3ciTMCwLuABZlkG2WdFidkbbL3fYPwN6Z63ODgAAfJGSHlEMlFQ2BteXF9p7Al0D8tmzOkIBhDxi+AsMakC+CTR4FfgT26lQEmzoP2CN2kIH4HXUUaOpMMNY9u+eW8IXDYG3H+gqJDwkomghVILK2LoU94Nu0Noidnx1qC21k4n+m4hdbabt0KoKbJB3ZEOAjYBQshoZrgVouhmzHq7nlYLbbQ9HGrAZt7wu8ARyV+nfsRl8sKWpWW2sEAQnEW0AczmZtqqR3G02A7djPC01A68ln8R4o6avGEmA7DlvWAUUagJmSnug0atX2FUgFL8CHKiRv8yXd1wl8XK8zAWuAGQUgF0m6sxvwtSXA9qvAGQUgl0rKHo525KF2PcD2s8AFBcjulXRTR8S5Bn0hwHacJ14P/ApcJymqdM9mezUwsyDQckk3VLnBmBNQcKYYE5GjJcWuS2Wz/TBwdUGAFZLmVg3cDwIuAZ7MJfQ9MEXS11UStb089ai8ewgxZ1eJ2fLpBwEhkvg0t8kY9wv5XMzMfi+TsO1lwM0FPo9Lagkyy4Qc0XbMCUhDS6hJimQx6yRN7zZb24uB2wraPyUpelrP1hcCEglnAa8UZPiapDM7ZV5wMtVyeUHS+Z38u73eNwISCVGxo3LnbZWkrKIz3y1vAe4u8Htd0undguumXV8JSCTExCS2nPK2TFKIMPLgQ+sbmt+8hYjp1G5AlWnTdwISCTEvLxqnF0jaqkKx3a7HxDwiVOejru3LAG+1HQgBiYSQrV9VkORlklbbPg94vuB6SOxOlhQyuDG3gRGQSHgxafnyQEKIcXtOXxhtQrpyoqSYUfbFBkpAIuFtoBsJ+4cJ/E99QZ6CjgcBcQ4XJOS3r7I4Q288TdJ3/QSfHsjgJTK2Q5kVGsSDCgDGKfRJkuIgpu828B6Qqb4HJw1x7Oa27IsEvtKaoQpb40ZA6n7RA2INPwkI8IslxcJpYDauBAwM5Sg3GhIwik4wrxT9SNJolfv/8EAr5dBOKZpfisY7OhUIqUyT7AAgTo+yguktWuH5wD0ZpCGRDbV4o6Sy6WuSrDYgIF8aBBwBfNCkR10Cy6TWFyPt9uJKxKpd0xsl3b/101nbsTERGxRNt9irjHlI1L6R3w7bDmlMnMGFpr5JRTAedNS0+F5graTPW0/5X/tGB4L9sJeaAAAAAElFTkSuQmCC"},18788:function(e){"use strict";e.exports="data:image/gif;base64,R0lGODlhJQAlAJECAL3L2AYrTv///wAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFCgACACwAAAAAJQAlAAACi5SPqcvtDyGYIFpF690i8xUw3qJBwUlSadmcLqYmGQu6KDIeM13beGzYWWy3DlB4IYaMk+Dso2RWkFCfLPcRvFbZxFLUDTt21BW56TyjRep1e20+i+eYMR145W2eefj+6VFmgTQi+ECVY8iGxcg35phGo/iDFwlTyXWphwlm1imGRdcnuqhHeop6UAAAIfkEBQoAAgAsEAACAAQACwAAAgWMj6nLXAAh+QQFCgACACwVAAUACgALAAACFZQvgRi92dyJcVJlLobUdi8x4bIhBQAh+QQFCgACACwXABEADAADAAACBYyPqcsFACH5BAUKAAIALBUAFQAKAAsAAAITlGKZwWoMHYxqtmplxlNT7ixGAQAh+QQFCgACACwQABgABAALAAACBYyPqctcACH5BAUKAAIALAUAFQAKAAsAAAIVlC+BGL3Z3IlxUmUuhtR2LzHhsiEFACH5BAUKAAIALAEAEQAMAAMAAAIFjI+pywUAIfkEBQoAAgAsBQAFAAoACwAAAhOUYJnAagwdjGq2amXGU1PuLEYBACH5BAUKAAIALBAAAgAEAAsAAAIFhI+py1wAIfkEBQoAAgAsFQAFAAoACwAAAhWUL4AIvdnciXFSZS6G1HYvMeGyIQUAIfkEBQoAAgAsFwARAAwAAwAAAgWEj6nLBQAh+QQFCgACACwVABUACgALAAACE5RgmcBqDB2MarZqZcZTU+4sRgEAIfkEBQoAAgAsEAAYAAQACwAAAgWEj6nLXAAh+QQFCgACACwFABUACgALAAACFZQvgAi92dyJcVJlLobUdi8x4bIhBQAh+QQFCgACACwBABEADAADAAACBYSPqcsFADs="},42313:function(e,t,a){"use strict";e.exports=a.p+"img/map.1e1a2309.png"},64636:function(e,t,a){"use strict";e.exports=a.p+"img/mapbottom.670387c9.png"},18417:function(e,t,a){"use strict";e.exports=a.p+"img/orangelight.0943fc08.png"},61120:function(e,t,a){"use strict";e.exports=a.p+"img/profile.74856f8b.jpg"},43139:function(e,t,a){"use strict";e.exports=a.p+"img/redbg.7cf5788c.png"},39472:function(e,t,a){"use strict";e.exports=a.p+"img/redlight.e13a9833.png"},50094:function(e,t,a){"use strict";e.exports=a.p+"img/rotatebottle.167c0b9f.jpg"},42255:function(e,t,a){"use strict";e.exports=a.p+"img/school.79581550.jpg"},67233:function(e,t,a){"use strict";e.exports=a.p+"img/teacher.e627401a.png"},5314:function(e,t,a){"use strict";e.exports=a.p+"img/user.94da74fd.png"},60751:function(e,t,a){"use strict";e.exports=a.p+"img/yellowlight.77d8b39f.png"},50477:function(){},42634:function(){}},t={};function a(i){var s=t[i];if(void 0!==s)return s.exports;var o=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=e,function(){a.amdO={}}(),function(){var e=[];a.O=function(t,i,s,o){if(!i){var l=1/0;for(d=0;d<e.length;d++){i=e[d][0],s=e[d][1],o=e[d][2];for(var r=!0,n=0;n<i.length;n++)(!1&o||l>=o)&&Object.keys(a.O).every((function(e){return a.O[e](i[n])}))?i.splice(n--,1):(r=!1,o<l&&(l=o));if(r){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}o=o||0;for(var d=e.length;d>0&&e[d-1][2]>o;d--)e[d]=e[d-1];e[d]=[i,s,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="/"}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var s,o,l=i[0],r=i[1],n=i[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(s in r)a.o(r,s)&&(a.m[s]=r[s]);if(n)var d=n(a)}for(t&&t(i);c<l.length;c++)o=l[c],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(d)},i=self["webpackChunkv3"]=self["webpackChunkv3"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=a.O(void 0,[504],(function(){return a(9561)}));i=a.O(i)})();
//# sourceMappingURL=app.a7ef31ca.js.map